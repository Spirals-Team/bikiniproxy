(function(sa){if(!window.console){console={};console.log=function(){}}if(!Array.isArray(sa)){sa=[sa]}var processor=function(sa_instance){var id=new Date().getMilliseconds();var getNumber=function(t){if(typeof(t)==="number"){return t}return 0};var ajax=function(url,callbackFunction){var bindFunction=function(caller,object){return function(){return caller.apply(object,[object])}};var stateChange=function(object){if(request.readyState==4){callbackFunction(request.responseText)}};var getRequest=function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP")}}return false};var postBody=(arguments[2]||"");var callbackFunction=callbackFunction;var url=url;var request=getRequest();if(window.XDomainRequest){var xdr=new XDomainRequest();if(xdr){xdr.onprogress=function(){};xdr.ontimeout=function(){};xdr.onload=function(){callbackFunction(xdr.responseText)};xdr.open("GET",url+"?"+postBody,true);xdr.contentType="application/x-www-form-urlencoded";xdr.send()}return}if(request){var req=request;req.onreadystatechange=bindFunction(stateChange,this);req.open("GET",url+"?"+postBody,true);req.send()}};var serialize=function(obj,prefix){var str=[];for(var p in obj){if(obj.hasOwnProperty(p)){var k=prefix?prefix+"["+p+"]":p,v=obj[p];str.push(typeof v=="object"?serialize(v,k):encodeURIComponent(k)+"="+encodeURIComponent(v))}}return str.join("&")};var insertAndExecute=function(element,text){var newdiv=document.createElement("div");newdiv.innerHTML=text;element.innerHTML="";element.appendChild(newdiv);var scripts=element.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){if(scripts[i].src!=""){var tag=document.createElement("script");tag.src=scripts[i].src;document.getElementsByTagName("head")[0].appendChild(tag)}else{eval(scripts[i].innerHTML)}}};var isLoaded=false;var isVisible=false;var on_load=null,on_change=null,on_click=null,on_nowidget=null;var on_expand=null,on_collapse=null,on_visible=null,on_resize=null;if(typeof(sa_instance.events)==="object"){if(typeof(sa_instance.events.on_load)==="function"){on_load=sa_instance.events.on_load}if(typeof(sa_instance.events.on_change)==="function"){on_change=sa_instance.events.on_change}if(typeof(sa_instance.events.on_resize)==="function"){on_resize=sa_instance.events.on_resize}if(typeof(sa_instance.events.on_click)==="function"){on_click=sa_instance.events.on_click}if(typeof(sa_instance.events.on_nowidget)==="function"){on_nowidget=sa_instance.events.on_nowidget}if(typeof(sa_instance.events.on_expand)==="function"){on_expand=sa_instance.events.on_expand}if(typeof(sa_instance.events.on_collapse)==="function"){on_collapse=sa_instance.events.on_collapse}if(typeof(sa_instance.events.on_visible)==="function"){on_visible=sa_instance.events.on_visible}}var embedUrl=sa_instance.embedUrl;var version=getNumber(sa_instance.version);var postdata=sa_instance.data;var src=encodeURIComponent(window.location.href);var referrer=encodeURIComponent(window.document.referrer);var random=Math.random().toString(36).replace(/[^a-z]+/g,"");if(typeof(sa_instance.src)==="string"){src=encodeURIComponent(sa_instance.src)}var do_expand=function(){var classes=document.querySelector(sa_instance.container).className;if(classes.indexOf("expanded")==-1){classes+=" expanded";document.querySelector(sa_instance.container).className=classes}};var do_collapse=function(){var classes=document.querySelector(sa_instance.container).className;classes=classes.replace(/\bexpanded\b/,"");document.querySelector(sa_instance.container).className=classes};var listener=function(event){if(typeof(event.data)==="string"){var data=event.data;if(data.indexOf(random)==0){var event=data.substr(data.indexOf(":")+1);if(on_change!=null&&event=="on_change"){on_change();return}if(event=="on_expand"){do_expand()}if(on_resize!=null&&event=="on_resize"){on_resize()}if(event=="on_collapse"){do_collapse()}if(on_visible!=null&&event=="on_visible"){on_visible();return}if(on_expand!=null&&event=="on_expand"){on_expand();return}if(on_collapse!=null&&event=="on_collapse"){on_collapse();return}if(on_click!=null&&event=="on_click"){on_click();return}if(event=="on_load"){isLoaded=true;if(on_load!=null){on_load()}return}if(on_nowidget!=null&&event=="on_nowidget"){on_nowidget();return}}}};if(window.addEventListener){addEventListener("message",listener,false)}else{attachEvent("onmessage",listener)}var url="//smartasset.com";if(src.indexOf("smartasset.com")>-1&&src.indexOf("blog.office.smartasset.com")==-1){url=""}if(typeof(embedUrl)==="string"){url=embedUrl}var getu=url+"/embed/frame";postdata.src=src;postdata.ref=referrer;postdata.ver=version;postdata.rnd=random;ajax(getu,function(d){insertAndExecute(document.querySelector(sa_instance.container),d)},serialize(postdata))};var processors=[];while(sa.length>0){var item=sa.pop();processors.push(new processor(item))}})(SA);