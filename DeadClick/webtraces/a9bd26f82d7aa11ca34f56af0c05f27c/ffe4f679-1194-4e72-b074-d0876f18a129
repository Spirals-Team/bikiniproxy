function convertToGeoRiotLinks(a){var b=document.links.length,c=0;for(c=0;c<b;c++){var d=document.links[c];"amazon"==getLinkType(d.href)&&(d.href="http://target.georiot.com/Proxy.ashx?TSID="+a+"&GR_URL="+encodeURIComponent(d.href)+"&oldendpoint=true")}}function extractItunesLinkFromAffiliateUrl(a,b){if(a.href.indexOf("?")>0){var c=a.href.split("?"),d=c[1].split("&"),e=new Array(d.length),f=new Array(d.length),g=0;for(g=0;g<d.length;g++){var h=d[g].split("=");e[g]=h[0],""!=h[1]?f[g]=h[1]:f[g]=""}}return""}function getLinkType(a){var b=/\.amazon\./,c=/local\.amazon\./;return a.indexOf("target.georiot.com")>0||a.indexOf("geni.us")>0?"unknown":b.test(a)&&!c.test(a)?"amazon":"unknown"}if(void 0===Georiot){var Georiot=Georiot||{},Genius=Genius||{};Georiot.getLinkType=function(a){var b=/search.itunes.apple.com|itunes.apple.com\/\S+id[0-9]+/i,c=/clk[uk]*\.tradedoubler\.com\S*\?\S*url=[https%3A%2F%2F|http%3A%2F%2F]*\itunes\.apple\.com/i,d=/click\.linksynergy\.com\S*?\S*RD_PARM1=[https%3A%2F%2F|https%253A%252F%252F|http%253A%252F%252F|http%3A%2F%2F]*\itunes\.apple\.com/i,e=/t.dgm-au.c\S+\?+\S*u=[https%3A%2F%2F|http%3A%2F%2F|https%253A%252F%252F|http%253A%252F%252F]*\itunes\.apple\.com/i,f=/^amazon\.|^amzn\.com|^amzn\.co\.uk|^amzn\.to|^smile.amazon\./,g=/local\.amazon\./,h=/^google\.prf\.hn|^play\.google\.com/,i=/click\.linksynergy\.com\S*?\S*murl=\S*microsoft\.com.*/i,j=/clk.*\.tradedoubler\.com\S*\?\S*url=[https%3A%2F%2F|http%3A%2F%2F].*microsoftstore\.com/i,k=/microsoftstore.com/i,l=/clk.*\.tradedoubler\.com\S*\?\S*url=[https%3A%2F%2F|http%3A%2F%2F].*microsoft\.com.*/i,m=/microsoft.com\/.*\/store\/.*/i;if(a.indexOf("target.georiot.com")>0||a.indexOf("geni.us")>0)return"unknown";var n=a.toLowerCase().replace("https://","").replace("http://","").replace("www.","");return b.test(a)?"apple":c.test(a)?"tradedoubler":d.test(a)?"linkshareApple":e.test(a)?"dgmperf":f.test(n)&&!g.test(n)?"amazon":h.test(n)?"google":i.test(n)?"linkshareMSFT":j.test(n)?"microsoft":k.test(n)?"microsoft":l.test(n)?"microsoft":m.test(n)?"microsoft":"unknown"},Georiot.extractLinkFromAffiliateUrl=function(a,b){if(a.href.indexOf("?")>0)for(var c=a.href.split("?"),d=c[1].split("&"),e=new Array(d.length),f=new Array(d.length),g=0;g<d.length;g++){var h=d[g].split("=");if(e[g]=h[0],""!==h[1]){if(f[g]=h[1],"tradedoubler"===b&&"url"===e[g])return f[g];if("linkshareApple"===b&&"RD_PARM1"===e[g])return f[g];if("dgmperf"===b&&"u"===e[g])return f[g];if("linkshareMSFT"===b&&"murl"===e[g])return f[g]}else f[g]=""}return""},Georiot.baseDomain="//buy.geni.us",Georiot.createOnClickFunction=function(a,b){return a.setAttribute("data-geniuslink",b),function(){return"_blank"===a.target?window.open(b,"_blank"):window.location.assign(b),!1}},Georiot.baseConvertLinks=function(a,b,c,d,e,f){if(!Georiot.utility.isThrive()){void 0===d&&(d=Georiot.baseDomain),!1===c||!0===c||(c=!1),!1===e||!0===e||(e=!1);for(var g=document.links.length,h=0;h<g;h++){var i=document.links[h];if(i.hasAttribute("georiot-ignore")&&"true"===i.getAttribute("georiot-ignore"));else{var j=Georiot.getLinkType(i.href);if(!(b.indexOf(j)>-1))continue;var k=i.href;if(void 0!==f&&(k=f(i,j)),""!==k){var l=d+"/Proxy.ashx?TSID="+a+"&GR_URL="+encodeURIComponent(k);c&&(l+="&dtb=1"),e?i.onclick=Georiot.createOnClickFunction(i,l):i.href=l}}}}},Georiot.utility={scriptIncluded:function(a){for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++)if(b[c].getAttribute("src")===a)return!0;return!1},isThrive:function(){return window.location.search.indexOf("tve=true")>-1}},Georiot.amazon={convertLinks:function(a,b,c){Georiot.amazon.convertToGeoRiotLinks(a,b,c)},convertToGeoRiotLinks:function(a,b,c){Georiot.baseConvertLinks(a,["amazon"],b,c,!1)},addOnClickRedirect:function(a,b,c){Georiot.baseConvertLinks(a,["amazon"],b,c,!0)}},Georiot.snippet={convertLinks:function(a,b,c){Georiot.snippet.convertToGeoRiotLinks(a,b,c)},convertToGeoRiotLinks:function(a,b,c){Georiot.baseConvertLinks(a,["apple","amazon","linkshareApple","linkshareMSFT","tradedoubler","dgmperf"],b,c,!1,function(a,b){return"linkshareApple"===b||"tradedoubler"===b||"dgmperf"===b||"linkshareMSFT"===b?decodeURIComponent(Georiot.extractLinkFromAffiliateUrl(a,b)):a})},addOnClickRedirect:function(a,b,c){Georiot.baseConvertLinks(a,["apple","amazon","linkshareApple","tradedoubler","dgmperf"],b,c,!0,function(a,b){return"linkshareApple"===b||"tradedoubler"===b||"dgmperf"===b?decodeURIComponent(Georiot.extractLinkFromAffiliateUrl(a,b)):a})}},Georiot.itunes={convertLinks:function(a,b,c){Georiot.itunes.convertToGeoRiotLinks(a,b,c)},convertToGeoRiotLinks:function(a,b,c){Georiot.baseConvertLinks(a,["apple"],!1,c,!1)},addOnClickRedirect:function(a,b,c){Georiot.baseConvertLinks(a,["apple"],!1,c,!0)}},Georiot.google={convertLinks:function(a,b){Georiot.google.convertToGeoRiotLinks(a,b)},convertToGeoRiotLinks:function(a,b){Georiot.baseConvertLinks(a,["google"],!1,b,!1)},addOnClickRedirect:function(a,b){Georiot.baseConvertLinks(a,["google"],!1,b,!0)}},Georiot.microsoft={convertLinks:function(a,b,c){Georiot.microsoft.convertToGeoRiotLinks(a,b,c)},convertToGeoRiotLinks:function(a,b){Georiot.baseConvertLinks(a,["microsoft","linkshareMSFT"],!1,b,!1,function(a,b){return"linkshareMSFT"===b?decodeURIComponent(Georiot.extractLinkFromAffiliateUrl(a,b)):a})},addOnClickRedirect:function(a,b){Georiot.baseConvertLinks(a,["microsoft"],!1,b,!0,function(a,b){return"linkshareMSFT"===b?decodeURIComponent(Georiot.extractLinkFromAffiliateUrl(a,b)):a})}},Genius.amazon=Georiot.amazon,Genius.snippet=Georiot.snippet,Genius.itunes=Georiot.itunes,Genius.google=Georiot.google,Genius.microsoft=Georiot.microsoft}