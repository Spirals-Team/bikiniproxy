/* repo: newsletter/release-newsletter-hover-6.0@1.7.5-0-gc7c7f47 - Package Version: 1.7.5 - 2018-02-14 09:45 am - User:  */
/*! hover-newsletter-counter */
define([],function(){var e;return e={id:void 0,views:3,active:!0,cookieName:"nls2",viewsCap:9,totalPV:0,init:function(e,t){var i=this;if(!e||!e.id||!e.nl)return this.debug("missing settings"),void 0;if(this.debug("settings are as follows"),webmd.debug(e),$.extend(this,e),this.newsletterOndemand===!0)this.display(this.timerOverride);else{if(webmd.url.getParam("ecd")&&webmd.url.getParam("ecd").indexOf("wnl")>-1)return this.debug("suppressed the newsletter for pages with ecd-wnl url"),void 0;if(this.cookieGet(),!this.active&&!this.isTestMode())return this.debug("inactive"),void 0;if(t||(i.totalPV!==i.views&&i.increment(),$(document).on("after_pv",function(){i.totalPV!==i.views&&(i.increment(),i.init(e,!0))})),this.isPageExcluded())return this.debug("excluded on this page"),void 0;this.shouldDisplay()?(this.debug("should display"),webmd.p.pim.increment(),this.deactivate(),this.display()):(this.debug("should not display"),this.cookieSet())}},isTestMode:function(){return webmd.url.getParam("testnewsletterhover")},isPageExcluded:function(){var e;return this.isTestMode()?!1:-1!==this.excludedTopicIDs.indexOf(window.s_topic)?(this.debug("excluded because topic ID is suppressed"),!0):webmd.isDown("reg")?(this.debug("excluded because registration is down"),!0):$("html").hasClass("cookie-consent")?(this.debug("In UK"),!0):window.s_sponsor_program?(this.debug("excluded on sponsored pages"),!0):window.opener?(this.debug("excluded on pop-up window"),!0):window.top!==window.self?(this.debug("excluded within iframe"),!0):this.excludeHref&&(e=RegExp(this.excludeHref),e.test(location.href))?(this.debug("excluded due to url match"),!0):this.excludeHostname&&(e=RegExp(this.excludeHostname),e.test(location.hostname))?(this.debug("excluded due to hostname match"),!0):webmd.p.pim.isAllowed()?!1:(this.debug("excluded due to PIM"),!0)},cookieGet:function(){var e;return webmd.cookie.exists(this.cookieName)?(this.debug("cookie value = "+webmd.cookie.get(this.cookieName)),e=webmd.cookie.getJson(this.cookieName),this.active=Boolean(e.a===void 0),this.totalPV=e.i||0,void 0):(this.debug("cookie was not found."),void 0)},cookieSet:function(){var e,t;e={},this.active?e.i=this.totalPV:(e.a=0,t=7),webmd.cookie.setJson(this.cookieName,e,{domain:webmd.url.getSLD(),expires:t})},increment:function(){var e;e=this.cap(this.totalPV+1),this.totalPV=e,this.cookieSet(),this.debug("target views = "+this.views)},shouldDisplay:function(){return this.isTestMode()||this.totalPV===this.views},getOptions:function(e){var t={reqModule:"newsletter/1/moduleUI-daily",containerId:"newsletterHover",mode:"daily-hover",reqCss:"css!newsletter/1/newsletter-signup-daily.css",width:"650px",responsive:!1,overlayWrapper:"newsletter-hover"},i={reqModule:"newsletter/1/moduleUI-daily-mobile",containerId:"newsletterHover",mode:"daily-mobile",reqCss:"css!newsletter/1/newsletter-signup-daily.css",width:"650px",responsive:!1,overlayWrapper:"newsletter-hover"},n=webmd.useragent.ua.type&&"mobile"===webmd.useragent.ua.type;switch(t.divContainer='<div id="'+t.containerId+'" class="newsletter-daily hover"></div>',i.divContainer='<div id="newsletterHoverContainer"><div id="'+i.containerId+'" class="newsletter-daily"></div></div>',e){case 16656:case 1096:case 1091:return{reqModule:"newsletter/1/moduleUI-pregnancy",containerId:"pregnancyHover",divContainer:'<div id="pregnancyHover" class="nls-preg hover"></div>',mode:"pregnancy",reqCss:"css!newsletter/1/newsletter-pregnancy.css",width:n?void 0:1012,responsive:!0,overlayWrapper:"nls-preg-hover"};default:return n?i:t}},display:function(e){var t=this,i=webmd.useragent.ua.type&&"mobile"===webmd.useragent.ua.type,n=t.getOptions(t.id).containerId,s=t.getOptions(t.id).reqModule,a=t.getOptions(t.id).divContainer,o=t.getOptions(t.id).mode,r=t.getOptions(t.id).reqCss,d=t.getOptions(t.id).responsive,l=t.getOptions(t.id).overlayWrapper;e=e!==void 0?e:i?5e3:3e3,t.config=$.extend({},t.config,{nl:t.nl[0],selector:"#"+n,uiMode:o}),setTimeout(function(){require([s,r],function(e){var n=new e,s=navigator.userAgent.match(/(iPhone|iPod touch);/i);return $("#decision_select").length>0?(webmd.debug("NLHover module suppressed due to Decision Select"),webmd.cookie.deleteCookie("nls2",{domain:"webmd.com",path:"/"}),webmd.cookie.deleteCookie("ads_sess",{domain:"webmd.com",path:"/"}),webmd.debug("NLHover cookie reset | PIM counter reset"),void 0):(!d&&i?(1>$("#newsletterHoverContainer").length&&$("body").append(a),n.init(t.config),setTimeout(function(){n.show(),wmdPageLink("nl-hov_imp");var e=$(".nls-email");$("#newsletterHoverContainer"),s&&(e.on("mousedown focus",function(){$("body").css({overflow:"hidden",position:"fixed"})}),e.on("blur",function(){setTimeout(function(){$("body").css({overflow:"auto",position:"static"})},1e3)}))},0)):webmd.overlay.open({width:window.nlOverlayWidth?window.nlOverlayWidth:t.getOptions(t.id).width,html:a,scrolling:!1,transition:"none",overlayClose:!1,onComplete:function(){n.init(t.config),wmdPageLink("nl-hov_imp"),$("#webmdHoverWrapper").addClass(l),$("#webmdHoverOverlay").addClass(l),"570px"!==$("#webmdHoverLoadedContent").css("width")&&$("#webmdHoverLoadedContent").css({width:"570px"}),webmd.overlay.resize()}}),void 0)})},e)},deactivate:function(){this.active=!1,this.cookieSet()},cap:function(e){return e>this.viewsCap&&(e=this.viewsCap),e},debug:function(e){webmd.debug("Newsletter hover: "+e)}}});