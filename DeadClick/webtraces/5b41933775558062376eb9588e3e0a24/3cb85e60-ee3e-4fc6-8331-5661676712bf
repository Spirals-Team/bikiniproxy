!function(){function e(e){for(var n=0;5>n;n++){if(!e||void 0===e)return"";var t=e.getAttribute("id");if(t)return t;e=e.parentElement}return""}function n(e,t,i){if(!(this instanceof n))return new n(e,t,i);for(var o={},r=e.cookie.split(";"),a=0;a<r.length;a++){var s=r[a].split("=");2===s.length&&(o[s[0].trim()]=s[1].trim())}var c=function(e,n,o){o||(o=i),this.toString=function(){var i=e+"="+encodeURIComponent(n)+";",r=new Date(o);return i+="expires="+r.toGMTString()+";",i+="path=/;",i+="domain=."+t+";"}};this.removeCookie=function(e){var n=new c(e,"",(new Date).getTime()-1e4);args.document.cookie=n.toString()},this.setCookie=function(n,t){var i=new c(n,t);e.cookie=i.toString()},this.getCookieValue=function(e){return o[e]},this.hasCookie=function(e){return e in o}}function t(e,n,i){var o=window._viantTML;return 0===o.length?(o.push(1),void e(n,i)):void window.setTimeout(function(){t(function(){e(n,i)})},100)}function i(){var e=window._viantTML;e.shift()}function o(e){var n=window._viantTMQ;if(n&&n.length)for(var t=n.length,i=0;t>i;i++){var o=n.shift();o&&o(e)}}function r(e){function n(n){var t=e.createElement("script");t.async=!0,t.type="text/javascript",t.src=n;var i=e.querySelector("script");return i.parentNode.insertBefore(t,i),t}function a(e){if(s(e)===!0)e.parentNode.replaceChild(d(e),e);else for(var n=0;n<e.childNodes.length;n++)a(e.childNodes[n]);return e}function s(e){return"SCRIPT"===e.tagName.toUpperCase()}function d(n){var t=e.createElement("script");n.innerHTML&&(t.text=n.innerHTML);for(var i=n.attributes.length-1;i>=0;i--)t.setAttribute(n.attributes[i].name,n.attributes[i].value);return t}if(!(this instanceof r))return new r(e);var u="_viantTMC";if(u in window)return o(window[u]),window[u];var f=this,l=[],v=[];return this.runPending=function(){o(f)},this.handleDocumentWrite=function(n){var t;if(n.parentId){var i=e.querySelector("#"+n.parentId);i&&(t=e.write,"write"in window||(window.write=t),e.write=function(n){"&nbsp;"==i.innerHTML&&(i.innerHTML="");var t=e.createElement("div");if(t.innerHTML=n,t.firstChild){var o=i.appendChild(t.firstChild);a(o)}})}return t},this.exec=function(e){for(var n=l.length,o=0;n>o;o++){var r=(v.shift(),l.shift());r&&"function"==typeof r.callback&&t(function(n,t){try{f.handleDocumentWrite(n.context);n.context.onReady=function(e){i(),t&&t.parentNode&&t.parentNode.removeChild(t)},n.callback(e,n.context)}catch(o){console.log("Failed to run callback"+o)}},r)}},this.asyncExec=function(t,i,o,a){o||(o="//ucid.vindicosuite.com/p.js"),l.push({callback:t,context:i});var s=n(o);v.push(s),a&&window.setTimeout(function(){var n=new r(e);n.exec({})},a)},this.expandVariables=function(e,n){if(!e)return e;if("string"!=typeof e)return e;for(var t in n)for(var i="["+t+"]",o=0;o<e.length;o++){var r=e.indexOf(i);if(-1===r)break;var a=e.substring(0,r),s=e.substring(r+i.length,e.length);e=a+n[t]+s}return e},this.inView=function(e){for(var n=e.offsetTop,t=e.offsetLeft,i=e.offsetWidth,o=e.offsetHeight;e.offsetParent;)e=e.offsetParent,n+=e.offsetTop,t+=e.offsetLeft;return n<window.pageYOffset+window.innerHeight&&t<window.pageXOffset+window.innerWidth&&n+o>window.pageYOffset&&t+i>window.pageXOffset?1:0},this.getEnv=function(n){var t={r:encodeURIComponent(e.referrer),u:encodeURIComponent(e.URL||e.location.href||window.location.href),ts:(new Date).getTime(),iv:""},i=e.location.ancestorOrigins;return window!==top&&i&&i.length>0&&(t.u=encodeURIComponent(i[i.length-1])),t.dsd=c(t.u),n&&(t.iv=f.inView(n)),t},this.loadElement=function(n,t,i){var o;t.parentId&&(o=e.querySelector("#"+t.parentId));var r=f.getEnv(o);f.asyncExec(function(i,a){for(var s in r)i[s]=r[s];for(var c in t)t[c]=f.expandVariables(t[c],i);var d=e.createElement(n);a.onReady&&(d.onreadystatechange=d.onload=a.onReady);for(var u in t)d.setAttribute(u,t[u]);if(!o){var l=e.querySelectorAll("script");o=l[l.length-1]}o.parentNode.insertBefore(d,o)},t,args.tokenServer+"/p.js",i)},this.getParentId=function(){var n=e.createElement("span");n.setAttribute("style","padding:0;margin:0"),n.id="vtm"+(new Date).getTime()+"_"+parseInt(1e4*Math.random());try{e.write(n.outerHTML);var n=e.querySelector("#"+n.id);if(n&&n.id)return n.innerHTML="&nbsp;",n.id}catch(t){}return null},this.loadScript=function(e,n){e.parentId||(e.parentId=f.getParentId()),e.type="text/javascript",e.sync=!0,f.loadElement("script",e,n)},this.loadIFrame=function(e,n){e.parentId||(e.parentId=f.getParentId());var t={border:"0",frameborder:"0",marginwidth:"0",marginheight:"0",hspace:"0",vspace:"0",scrolling:"NO",style:"margin:0;padding:0"};for(var i in t)i in e||(e[i]=t[i]);f.loadElement("iframe",e,n)},this.dropJsPixel=function(e,t){t||(t=2e3);var i=f.getEnv();e=f.expandVariables(e,i);var o=n(e);window.setTimeout(function(){o&&o.parentNode&&o.parentNode.removeChild(o)},t)},window[u]=this,o(f),this}function a(t){try{var i=this;i.referer=t.document.referrer,i.currentPageUrl=t.document.URL||t.document.location.href||window.location.href;var o=t.document.location.ancestorOrigins;window!==top&&o&&o.length>0&&(i.currentPageUrl=o[o.length-1]),i.tokenValue="";var a=0,d=3e4;t.sessionEventInterval&&(a=1e3*Number(t.sessionEventInterval));var u=t.activityEvents||["keypress","mousemove","touchstart"],f=(new Date).getTime(),l=c(t.document.location.hostname||i.currentPageUrl),v=1e3*Number(t.syncIntervalInSec),h=60*Number(t.expiryInDays)*60*24*1e3,g=new n(t.document,l,(new Date).getTime()+h),p=r(t.document),w=f,m=0;this.setTokenValueFromCookie=function(){g.hasCookie(t.tokenName)&&(i.tokenValue=g.getCookieValue(t.tokenName))},this.setToken=function(e){return e.length>0?(i.tokenValue=e,g.setCookie(t.tokenSyncName,(new Date).toGMTString()),g.setCookie(t.tokenName,e),!0):!1},this.isTokenSynchronizationNeeded=function(){if(!g.hasCookie(t.tokenName)||!g.hasCookie(t.tokenSyncName))return!0;var e=decodeURIComponent(g.getCookieValue(t.tokenSyncName)),n=Date.parse(e),i=(new Date).getTime()-n;return i>v},this.injectClickEvents=function(){for(var e=document.querySelectorAll("a"),n=0;n<e.length;n++)e[n].getAttribute("href")&&e[n].addEventListener("click",function(e){var n=e.target||e.srcElement,t=n.getAttribute("href");return t&&i.dropClickEvent(n),!0},!0)},this.dropEvent=function(e,n){n.r=encodeURIComponent(i.referer),n.u=encodeURIComponent(i.currentPageUrl),n.t=i.tokenValue,n.s=m,n.p=(new Date).getTime()-f;for(var o=Object.keys(n).sort(),r=t.tokenServer+"/e/?i="+e,a=0;a<o.length;a++)"i"!==o[a]&&(r+="&"+o[a]+"="+n[o[a]]);p.dropJsPixel(r)},this.dropLoadedEvent=function(){i.dropEvent(s.managerLoaded,{})},this.dropTokenEvent=function(){i.dropEvent(s.tokenRequest,{})},this.dropAliveEvent=function(){i.dropEvent(s.alive,{})},this.dropUnloadEvent=function(){i.dropEvent(s.unLoad,{})},this.dropClickEvent=function(n){try{var t=n.getAttribute("href"),o=e(n);i.dropEvent(s.click,{d:o,l:encodeURIComponent(t)})}catch(r){console.log("Failed to drop event "+s.click)}},this.setActivityTime=function(){return w=(new Date).getTime(),!0},this.initSession=function(){if(d){for(var e=0;e<u.length;e++)document.addEventListener(u[e],i.setActivityTime);window.setInterval(i.manageSession,d)}},this.initUnload=function(){var e=window.onbeforeunload;e||(e=window.unload),window.unload=window.onbeforeunload=function(){i.dropUnloadEvent(),e&&e()}},this.onLoad=function(){i.dropLoadedEvent(),window.setTimeout(i.injectClickEvents,1e3),i.initSession(),i.initUnload()},this.manageSession=function(){var e=(new Date).getTime()-w;1.1*d>e&&(m+=d,a&&m>=a&&(i.dropAliveEvent(),a*=2))},this.syncTokenIfNeeded=function(){i.isTokenSynchronizationNeeded()?p.asyncExec(function(e){var n=e.t;n?(i.setToken(n),i.dropTokenEvent()):(i.removeCookie(t.tokenSyncName),i.removeCookie(t.tokenName)),i.onLoad()},{},t.tokenServer+"/p.js"):i.onLoad()},i.setTokenValueFromCookie(),i.syncTokenIfNeeded()}catch(k){console.log("Failed to instantiate TokenManager due to "+k)}}var s={tokenRequest:2,click:4,managerLoaded:5,alive:6,unLoad:7},c=function(e){-1!==e.indexOf("http://")?e=e.substring(7,e.length):-1!==e.indexOf("https://")?e=e.substring(8,e.length):"//"===e.substring(0,2)&&(e=e.substring(2,e.length));var n=e.indexOf("/");n>-1&&(e=e.substring(0,n));var t,i=e.split(".");return t=e.indexOf(".co.uk")>-1?i.length>2?i[i.length-3]+"."+i[i.length-2]+"."+i[i.length-1]:i[0]:i.length>1?i[i.length-2]+"."+i[i.length-1]:i[0]};window._viantTML||(window._viantTML=[]),window._viantTMQ||(window._viantTMQ=[]),new a(_viantTMInit)}();