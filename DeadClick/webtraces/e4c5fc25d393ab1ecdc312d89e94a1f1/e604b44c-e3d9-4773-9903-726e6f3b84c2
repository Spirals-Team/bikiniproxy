/*! updated; 02-13-2018 04:14 PM **/


Modulr.define("core.video:models/is.authenticated",["require","jquery","lodash","helper","config","core.base:utils/localStorage","models/get.video"],function(require,$,_,Helper,config){function getStore(){var res=null,val=LocalStorage.get(storeId);if(val){var curr=JSON.parse(val);hasExpired(curr.expires)||curr.list.length<50&&(res=curr)}return res}function setStore(val,isAuth){void 0!==val&&LocalStorage.set(storeId,function(){val=""+val;var curr=getStore();return curr?(-1===curr.list.indexOf(val)&&curr.list.push(val),isAuth&&curr.auth.push(val)):curr={list:[val],auth:isAuth?[val]:[],expires:function(){return Helper.getCurrentTime().getTime()+60*expiry*60*1e3}()},JSON.stringify(curr)}())}function hasExpired(time){return Helper.getCurrentTime().getTime()>parseInt(time,10)}var LocalStorage=require("core.base:utils/localStorage"),GetVideoFeed=require("models/get.video"),storeId="videoIsAuth",expiry=24;return new function(){this.check=function(videoId,domain,callback){function cont(bool){setStore(videoId,bool),callback(bool,!1)}if(Helper.isTVEVideoId(videoId))callback(!0,!0);else{var curr=getStore()||{};if(curr.list&&curr.list.indexOf(""+videoId)>-1)return callback(!!(curr.auth&&curr.auth.indexOf(""+videoId)>-1));GetVideoFeed(videoId,{domain:domain},function(data){cont(data.requires_auth)})}}}});