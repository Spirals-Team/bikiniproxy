/*! updated; 02-13-2018 04:14 PM **/


Modulr.define("core.base:modules/header",["require","akamai.time","utils/environment","core.plugins:OnWindowResize","core.base:utils/detector","core.plugins:DateTime"],function(require,time){function Header(){this.body=$("html, body"),this.menu=$(".js-menu-toggle"),this.searchIcon=$(".site-header .js-focus-search"),this.siteHeader=$(".site-header"),this.menuMore=$(".menu-more"),this.searchField=$(".expandable-nav .search-wrap"),this.searchInput=$(".site-header .resp_site_search"),this.maginifyEl=$(".search-toggle")}var OnWindowResize=require("core.plugins:OnWindowResize"),Detector=require("core.base:utils/detector"),view=Detector.current();return Header.prototype.init=function(){var self=this;for(var key in self)"init"!==key&&"function"==typeof self[key]&&self[key]()},Header.prototype.setClickEvents=function(){var self=this;this.menu.click(function(e){e.preventDefault(),self.menuMore.hasClass("is-active")?self.menuMore.removeClass("is-active"):self.menuMore.addClass("is-active"),self.siteHeader.hasClass("nav-open")?self.siteHeader.removeClass("nav-open"):self.siteHeader.addClass("nav-open"),self.menu.hasClass("menu-open")?self.menu.removeClass("menu-open"):self.menu.addClass("menu-open")}),this.searchIcon.click(function(e){e.preventDefault(),self.siteHeader.hasClass("nav-open")?self.siteHeader.removeClass("nav-open"):self.siteHeader.addClass("nav-open"),self.menuMore.hasClass("is-active")?self.menuMore.removeClass("is-active"):($(".site-header .resp_site_search").focus(),self.menuMore.addClass("is-active"))}),this.searchField.find("input[type='submit']").click(function(e){if(0===self.searchField.find("input[type='text']").val().length)return void e.preventDefault()}),this.body.unbind("click").on("click",function(e){var domEl=$(e.target),isToggleBtn=domEl.hasClass("menu-open");domEl.hasClass("resp_site_search")||domEl.closest(".inner").length>0||self.siteHeader.hasClass("nav-open")&&!isToggleBtn&&(self.siteHeader.removeClass("nav-open"),self.menuMore.removeClass("is-active"),self.menu.removeClass("menu-open"))}),this.searchInput.on("focus",function(e){self.maginifyEl.addClass("is-active")}).on("blur",function(e){self.maginifyEl.removeClass("is-active")})},Header.prototype.cycleHotTopics=function(){function cycleHTUs(){hotTopics.each(function(index){var el=$(this),time=5*index;el.css("animation","rotate-items "+totalTime+"s infinite "+time+"s ease-in-out")})}function removeHTUStyles(){hotTopics.each(function(index){$(this).attr("style","")})}var hotTopics=$(".hot-topics .rotate-items li"),hotTopicsLength=hotTopics.length,totalTime=5*hotTopicsLength,win=$(window);"tablet"===Detector.current()&&win.width()<1024||win.width()<1024?cycleHTUs():removeHTUStyles(),OnWindowResize(function(){win.width()<1024?cycleHTUs():removeHTUStyles()},250)},Header.prototype.setLocalTime=function(){var now,timeElm,zoneElm,DateTime=(require("helper"),require("core.plugins:DateTime")),CONFIG={container_selector:".branding .current-time",time_element_selector:".time",zone_element_selector:".zone",update:!0,rotate:!0,update_interval_in_min:1,rotate_interval_in_sec:6},update_timer=!1,rotate_timer=!1,isUSA=!1,Proto=this,timeZones=[{suffix:"ET",difference:0},{suffix:"CT",difference:1},{suffix:"MT",difference:2},{suffix:"PT",difference:3}],rotateItems=[{time:"channel",tz:""},{time:"$time",tz:"$tz"},{time:".com",tz:""},{time:"$time",tz:"$tz"},{time:"channel",tz:""},{time:"$time",tz:"$tz"},{time:"LIVE",tz:""},{time:"$time",tz:"$tz"}],currentTimeZone=!1,currentItem=0,localTimeZone=!1;Proto.collector=function(){var container=$(CONFIG.container_selector);timeElm=container.find(CONFIG.time_element_selector),zoneElm=container.find(CONFIG.zone_element_selector),now=time.getCurrent();var timeZoneFull=now.toString().match(/\(([E|C|M|P][S|D]T)\)$/);if(timeZoneFull){var timeZoneShort=timeZoneFull[1].charAt(0)+timeZoneFull[1].charAt(2);localTimeZone=_.findIndex(timeZones,{suffix:timeZoneShort}),localTimeZone>-1&&(currentTimeZone=localTimeZone,isUSA=!0)}},Proto.updater=function(increment){now=new Date(now.valueOf()+increment)},Proto.displayer=function(time,tz,animation_duration){animation_duration=void 0!==animation_duration?animation_duration:500,$(CONFIG.container_selector).fadeIn(animation_duration),timeElm.length>0&&zoneElm.length>0&&(timeElm.fadeOut(animation_duration),zoneElm.fadeOut(animation_duration,function(){time=tz.length>0?time+" ":time,timeElm.text(time),zoneElm.text(tz),timeElm.fadeIn(animation_duration),zoneElm.fadeIn(animation_duration)}))},Proto.rotator=function(){var formattedText,index=currentItem%rotateItems.length;if("$time"===rotateItems[index].time)if(isUSA){var currentTZ=currentTimeZone%timeZones.length;currentTimeDelta=timeZones[currentTZ].difference;var time=new Date(now.valueOf());time=time.setHours(time.getHours()-currentTimeDelta),formattedTime=DateTime(new Date(time.valueOf()),"${hr:reg}:${min}"),Proto.displayer(formattedTime,timeZones[currentTZ].suffix),currentTimeZone++}else{formattedText=DateTime(now,"${hr:reg}:${min} ${AMPM}");var splitText=formattedText.split(" ");2===splitText.length&&Proto.displayer(splitText[0],splitText[1])}else"channel"===rotateItems[index].time?$(CONFIG.container_selector).fadeOut(500):Proto.displayer(rotateItems[index].time,rotateItems[index].tz);currentItem++},Proto.set=function(){"desktop"===Detector.current()||"tablet"===Detector.current()?(Proto.trigger({auto_update:"true"}),$(".site-header .current-time").removeClass("hide")):(clearInterval(rotate_timer),clearInterval(update_timer),$(".site-header .current-time").addClass("hide").css("style",""))},Proto.trigger=function(configuration){if(configuration&&(CONFIG=_.merge(CONFIG,configuration)),Proto.collector(),timeElm.length>0&&zoneElm.length>0){if(Proto.updater(0),Proto.rotator(),CONFIG.update){var updateInterval=6e4*CONFIG.update_interval_in_min;update_timer=setInterval(function(){Proto.updater(updateInterval)},updateInterval)}if(CONFIG.rotate){var rotateInterval=1e3*CONFIG.rotate_interval_in_sec;rotate_timer=setInterval(function(){Proto.rotator()},rotateInterval)}}},Proto.set(),OnWindowResize(function(){var currentView=Detector.current();("mobile"===view||"mobile"===currentView&&view!==currentView)&&(Proto.set(),view=currentView)},250)}(),new Header});