/* AppMeasurement for JavaScript version: 2.1.0
Copyright 1996-2016 Adobe, Inc. All Rights Reserved
More info available at http://www.adobe.com/marketing-cloud.html */

/* ******************************************************************	*/
/* Report Suite															*/
/* ******************************************************************	*/

var s_account = "cbncomdev";
var s_widget_account = "cbncomwidget";
var om_reg_domains = /(cbn\.com|orphanspromise\.org|thenextlevelcbn\.com|superlibro\.tv|superbook\.tv|superkitap\.tv|superbookindo\.tv|superkniga\.tv|carteacartilor\.tv|superbuch\.tv|praise\.com|thehope1948\.com|superbookacademy\.com|pledgeyourprofile\.com|inourhands1967\.com|pocahontasmovie\.com|cbnisrael\.org|features\.cbn\.com|impact\.cbn\.com|(www\.)*tolifethemovie\.com)/;
var om_reg_domains_nonaspx = /(superbook\.cbn|orphanspromise\.org|thenextlevelcbn\.com|superbookacademy\.com|inourhands1967\.com|cbnisrael\.org|hope\.cbn\.com|hopedev|stories\.cbn\.com|features\.cbn\.com|700clubinteractive\.cbn\.com|www1\.cbn\.com|dmgdev\.cbn\.local|bible\.cbn\.com|pledgeyourprofile\.com|feature\.cbn\.com|impact\.cbn\.com|(www\.)*tolifethemovie\.com)/;
var om_reg_subdomains = /(m\.cbn\.com|superbook|bible|my|blogs|features|shop|stories|parable|search\.cbn\.com|700clubinteractive\.cbn\.com|thehope1948\.com|orphanspromise\.org|superbookacademy\.com|pledgeyourprofile\.com|cbnisrael\.org|inourhands1967\.com|thenextlevelcbn\.com|pocahontasmovie\.com|impact\.cbn\.com|(www\.)*tolifethemovie\.com)/;


try {
    // current page
	var sOm_strHref_Orig = window.location.href;
    var sOm_strHref = sOm_strHref_Orig.toLowerCase();
    var sOm_strPageTitle = document.title;
    var sOm_sReferrer = document.referrer;
    var sOm_strHost = document.location.host;
    var sOm_strProtocol = document.location.protocol;
    // domain standardization
	sOm_strHref_Orig = sOm_strHref_Orig.replace("www.tolifethemovie.com","tolifethemovie.com");
    sOm_strHref = sOm_strHref.replace("www.tolifethemovie.com","tolifethemovie.com");
	sOm_strHref_Orig = sOm_strHref_Orig.replace("thechristianbroadcastingnetwork.lpages.co","impact.cbn.com");
    sOm_strHref = sOm_strHref.replace("thechristianbroadcastingnetwork.lpages.co","impact.cbn.com");
    // amp pages
    var bAmpPage = false;
    if (sOm_strHref.indexOf("s_code_amp.aspx")>=0) {
        bAmpPage = true;
        sOm_strPageTitle = getURLParam("pageTitle");
        sOm_sReferrer = getURLParam("ref");
        sOm_strHref_Orig = getURLParam("pageURL");
        sOm_strHref = sOm_strHref_Orig.toLowerCase();
        //if (sOm_sReferrer != "") { s.referrer = sOm_sReferrer }
        sOm_strHref = sOm_strHref.replace(/.*ampproject.*www1\.cbn\.com/,"www1.cbn.com");
        sOm_strHref_Orig = sOm_strHref_Orig.replace(/.*ampproject.*www1\.cbn\.com/,"www1.cbn.com");
        if (sOm_strHref_Orig.indexOf("https") >=0) { 
            sOm_strProtocol = "https:"; 
        } else { 
            sOm_strProtocol = "http:"; 
        }
        sOm_strHost = "www1.cbn.com";
        
    }

    

} catch (Error) { }

try {
    // determine reporting suite
	if (sOm_strHref.indexOf("tipritv.com") > -1) {
		s_account = "cbntipritv";
	} else {
		sOm_indexOfQuery =  sOm_strHref.indexOf("?");
		if (sOm_indexOfQuery < 0) {
			sOm_indexOfQuery = sOm_strHref.length;
            sOm_HostURL = sOm_strHref.substring(0,sOm_indexOfQuery);
		}
        if (om_reg_domains.test(sOm_HostURL) == true) {        
			// default
        } else {
            s_account = "cbncbncomexcludedips";
		}
	}
} catch (Error) { }

var s = s_gi(s_account)

/* ******************************************************************	*/
/* INLINE - Custom Code													*/
/* ******************************************************************	*/

try {

	// global variables for configuration / library inclusion
	var om_fb_included = false;
	var om_tw_included = false;


	/* ****************************** */
	// temporary redirects
	/* ****************************** */
	if (sOm_strHref.indexOf("www1.cbn.com/giving") >=0) {
		location.href = "http://www.cbn.com/giving";
	} else if (sOm_strHref.indexOf("www1.cbn.com/vod/prayer") >=0) {
		location.href = "http://www1.cbn.com/prayer";
	}

	/* ****************************** */
	// temporary hide telethon crawl
	/* ****************************** */
	//document.write('<style>.telethon-ticker-wrapper {display: none;} .cc_banner-wrapper {bottom: 0px;}</style>');

    /* ********************************************** */
	// iframe tracking for selected external websites
	/* ********************************************** */
	if (sOm_strHref.indexOf("inourhands1967.com") >=0) {
        document.write('<iframe src="//www.cbn.com/inourhands/tracking.aspx?pagename=' + escape(window.location.pathname) + '&t=' + escape(sOm_strPageTitle) + '" allowtransparency="true" scrolling="no" style="border: none; margin: 0; padding:0;visibility: hidden; position: fixed; top: -10000px;" height="1" width="1" border="0"></iframe>');
    }
    /* ********************************************** */
	// iframe tracking for selected internal pages
	/* ********************************************** */
	/*
	if ((sOm_strHref.indexOf("israel") >=0) || (sOm_strPageTitle.toLowerCase().indexOf("in our hands") >=0)) {
        document.write('<iframe src="//www.cbn.com/inourhands/tracking-ext.aspx?pagename=' + escape(window.location.pathname) + '&t=' + escape(sOm_strPageTitle) + '" allowtransparency="true" scrolling="no" style="border: none; margin: 0; padding:0;visibility: hidden; position: fixed; top: -10000px;" height="1" width="1" border="0"></iframe>');
    }
	*/

   
} catch (e) { }

try {
	/* ******************************************************** */
	// auto generated intcmp tracking for selected kpi links
	/* ******************************************************** */
		if (typeof jQuery != 'undefined') {
			jQuery( document ).ready(function() {
				var iLinkCounterGvsl = 0;
				var iLinkCounterEvsl = 0;
				jQuery('a').each(function(){ // loop through all matched elements
					var thisHref = this.href;
					// determine if inctmp is needed
					if ( (thisHref.toLowerCase().indexOf("/giving") >=0) && (thisHref.toLowerCase().indexOf("intcmp") <0) && (sOm_strHref.toLowerCase().indexOf("/giving/") <0) ) {
						// adjust href if missing traling /
						if (thisHref.toLowerCase().indexOf("/giving") == (thisHref.length - ("/giving").length)) {
							thisHref = thisHref + "/";
						}
						sUniqueCode = "_" + window.location.hostname + window.location.pathname.replace(/\//g,"-") + "_" + iLinkCounterGvsl.toString() + "_" + jQuery(this).text().replace(/[^a-zA-Z0-9-_]/g,"");
						iLinkCounterGvsl++;
						if (thisHref.match(/\?/)) {
				            jQuery(this).attr('href',thisHref + '&intcmp=gvsl' + sUniqueCode);
						} else {
				            jQuery(this).attr('href',thisHref + '?intcmp=gvsl' + sUniqueCode);
			      		}
						//console.log(this.href);
					} else if ( (thisHref.toLowerCase().indexOf("/stepstopeace") >=0) && (thisHref.toLowerCase().indexOf("intcmp") <0) && (sOm_strHref.toLowerCase().indexOf("/stepstopeace") <0) ) {
						sUniqueCode = "_" + window.location.hostname + window.location.pathname.replace(/\//g,"-") + "_" + iLinkCounterEvsl.toString() + "_" + jQuery(this).text().replace(/[^a-zA-Z0-9-_]/g,"") ;
						iLinkCounterEvsl++;
						if (thisHref.match(/\?/)) {
				            jQuery(this).attr('href',thisHref + '&intcmp=evsl' + sUniqueCode);
						} else {
				            jQuery(this).attr('href',thisHref + '?intcmp=evsl' + sUniqueCode);
			      		}
						//console.log(this.href);
					}
				});
			});
		}
} catch (e) { }

try {
    /* ************************************************* */
	// pass through parameters for selected external pages
	/* ************************************************* */
	if (sOm_strHref.indexOf("thenextlevelcbn") >=0) {
		if (typeof jQuery != 'undefined') {
			jQuery( document ).ready(function() {
				sOm_GvSel = getURLParam('sel');
				if ((typeof (sOm_GvSel) == "undefined") || (sOm_GvSel == "")) {
					sOm_GvSel = "84";
				}
				jQuery('a').each(function(){ // loop through all matched elements
					var thisHref = this.href;
					if ( (thisHref.toLowerCase().indexOf("/giving") >=0) && (sOm_strHref.toLowerCase().indexOf("/giving/") <0) ) {
						// adjust href if missing traling /
						if (thisHref.toLowerCase().indexOf("/giving") == (thisHref.length - ("/giving").length)) {
							thisHref = thisHref + "/";
						}
						if (thisHref.match(/\?/)) {
			        	    jQuery(this).attr('href',thisHref + '&m=042425&sel=' + sOm_GvSel);
						} else {
			        	    jQuery(this).attr('href',thisHref + '?m=042425&sel=' + sOm_GvSel);
		      			}
						//console.log(this.href);
					}
				});
			});
		}
	}
	if (sOm_strHref.indexOf("impact.cbn.com/amhf") >=0) {
		if (typeof jQuery != 'undefined') {
			jQuery( document ).ready(function() {
				var iLinkClickCounter = 0;
				jQuery('a').each(function(){ // loop through all matched elements
					var thisHref = this.href;
					sOm_sClickAction = "AMHF_" + window.location.hostname + window.location.pathname.replace(/\//g,"-") + "_link-" + iLinkClickCounter.toString() + "_" + jQuery(this).text().replace(/[^a-zA-Z0-9-_]/g,"");
					jQuery(this).data('linkName', sOm_sClickAction)
					jQuery(this).click( function () {
						om_gaTrackEvent("Click", jQuery(this).data('linkName'));
						omTrackContentClick("Click - " + jQuery(this).data('linkName'));
						//console.log(jQuery(this).data('linkName'));
					});
					iLinkClickCounter++;
				});
			});
		}
	}


} catch (e) { }

/* *************************************************************************************************************	*/
// INLINE - non donation uses of donation forms - toggle
/* *************************************************************************************************************	*/

if (typeof(omNonDonation) == "undefined") {
	omNonDonation = "";
	// set to omNonDonation to true in calling script to ensure a donation is not tracked below e.g. ProtectYourHealth
}

/* *************************************************************************************************************	*/
// INLINE - cloud visitor service
/* *************************************************************************************************************	*/

try {
	s.visitor = Visitor.getInstance("CA3122CE528B92C10A490D4D@AdobeOrg");
} catch (e) { }

/* *************************************************************************************************************	*/
// INLINE - ad display count - legacy
/* *************************************************************************************************************	*/

// ad display count (dependency: iAdsShown incremented with each ad displayed on page, iAdsShown set by OAS script)
try {
	if ((typeof (iAdsShown) != "undefined") && (typeof (iAdsToShow) != "undefined")) {
		if (iAdsToShow != iAdsShown) {
			sOm_AdError = "Ad Mismatch: " + iAdsShown + "/" + iAdsToShow;
			//var d = new Date();
			//document.write('<img src="http://dl2.cbn.com/ads/ad_err.aspx?ts=' + d.getTime() + '" height=1 width=1 alt="" border=0></div>');
			//document.write("Ad Error: Mismatched Call. To Display:" + iAdsToShow + " Num Displayed: " + iAdsShown);
		}
	}
}
catch (e) { }

// end ad count


/* *************************************************************************************************************	*/
// INLINE - disable units
/* *************************************************************************************************************	*/

try {
	if (sOm_strHref.indexOf("national-day-prayer-texas") >=0) {
        var createAdCode = function() { 
                $("#div-gpt-ad-1402671804369-0").css("display","none");
                $("#div-gpt-ad-1402671804369-1").css("display","none");
                $("#div-gpt-ad-1402671804369-2").css("display","none");
                $("#div-gpt-ad-1403822693041-0").css("display","none");
                $("#div-gpt-ad-1402671804369-4").css("display","none");
                $("#div-gpt-ad-1402671804369-3").css("display","none");
            }
    }
}
catch (e) { }


/* *************************************************************************************************************	*/
// INLINE - ga tracking
/* *************************************************************************************************************	*/

try {

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');


  // exclude non standard pages e.g. ad units and track all other pages
  if ((sOm_strHref.indexOf("/templates/common/ads") < 0) && (sOm_strHref.indexOf("superbookacademy.com") < 0) && (sOm_strHref.indexOf("inourhands1967.com") < 0) && (sOm_strHref.indexOf("channel=app") < 0)) {

	  // 'UA-821500-4', 'auto', {'allowLinker': true}
	  // 'require', 'linker'
	  // 'linker:autoLink', ['cbn.com', 'orphanspromise.org', 'superlibro.tv', 'superbookindo.tv', 'superkniga.tv', 'superbuch.tv', 'praise.com']
	  ga('create', 'UA-821500-4', 'auto');
	  ga('require', 'linkid', 'linkid.js'); // analysis link attribution
	  ga('require', 'displayfeatures'); // ad features
	
	  // remove pii from URL
	  om_gaPathName = sOm_strHref_Orig.replace(sOm_strProtocol + "//","");
      om_gaPathName = om_gaPathName.replace(sOm_strHost,"");
	  om_gaPathName = om_gaPathName.replace(/[[A-Z0-9._%+-]+[ ]?[\(]?(@|at|%40)[\)]?[ ]?[A-Z0-9.-]+[ ]?[\(]?(\.|dot)[)]?[ ]?[A-Z]{2,4}/gi,"[removed]");
	  // exception overwrites for non revenue giving pages
	  if (omNonDonation == "true") {
		  om_gaPathName = om_gaPathName.replace(/giving/gi, "special-offer");
	  }
	  ga('set', 'page', om_gaPathName);
      ga('set', 'hostname', sOm_strHost);
	
	  // modify Superbook page titles for easier identification
	  if (checkSuperbookDomain(sOm_strHref)) {
		  if ((sOm_strHref.indexOf("/a/game") >=0) && sOm_strPageTitle == "") {
			 sOm_strPageTitle = "Games";
		  } 
		  ga('set', 'title', "Superbook - " + sOm_strPageTitle);
	  }
      // modify page titles for amp pages
      if (bAmpPage && (sOm_strPageTitle != "")) {
          ga('set', 'title', "AMP - " + sOm_strPageTitle);
      }

	  ga('send', 'pageview');
  }
} catch (e) { }


// ga conversion(dependency: values set below submitted in calling page/include file after s_code include)
try {

	// exclude urls with pii  
	if ((sOm_strHref.indexOf("@") < 0) && (sOm_strHref.indexOf("%40") < 0)) {

	var google_conversion_id = 1046962897;
	var google_conversion_language = "en";
	var google_conversion_format = "3";
	var google_conversion_color = "666666";
	var google_conversion_label = "rVo6CPHd9AEQ0cWd8wM"; // non giving and non partner section
	var google_conversion_value = 0;
	if (sOm_strHref.indexOf("/source/giving/special/web/aspx/receipt.aspx") > 0) {
		if ((typeof (om_sDonationDetail) != "undefined") && (om_sDonationDetail != "")) {
			if (om_sDonationDetail.indexOf("SBCC") >= 0) {
				google_conversion_label = "PHVvCNHetgIQ0cWd8wM"; // superbook donation - club membership
			} else {
				google_conversion_label = "SpBDCKmYtgIQ0cWd8wM"; // superbook donation - alacart
			}
		}
	} else if (sOm_strHref.indexOf("/giving/special/") > 0) {
		google_conversion_label = "bBkDCLGXtgIQ0cWd8wM"; // superbook donation pages
	} else if ( (sOm_strHref.indexOf("/giving/") > 0) || (sOm_strHref.indexOf("/partners/") > 0)) {
		google_conversion_label = "FmplCOne9AEQ0cWd8wM"; // giving or partner section
	} else if (sOm_strHref.indexOf("/inourhands/tracking") > 0) {
		google_conversion_label = "lD2DCJju4XAQ0cWd8wM"; // in our hands tracking page
        var google_remarketing_only = false;
	}

	}
    
} catch (e) { }
// end conversion

/* *************************************************************************************************************	*/
// FUNCTIONS - ga kpi tracking functions
/* *************************************************************************************************************	*/

function om_gaTrackKPI_SetTitle(sKPI,sPageTitle) {
	try {
	if (typeof (sPageTitle) != "undefined") {
			if (sKPI != "") {

				ga('send', {
				  'hitType': 'pageview',
				  'page': '/kpi/' + sKPI.replace(/ /gi, "-"),
				  'title': sPageTitle
				});

				// set missing dom page title for association with on page events
				document.title = sPageTitle;

				ga('send', {
				  'hitType': 'event',           // Required.
				  'eventCategory': 'KPIs',      // Required.
				  'eventAction': sKPI,      	// Required.
				  'eventLabel': sKPI
				});

			}
		}
	} catch (e) { }

}

function om_gaTrackKPI(sKPI) {
	try {
		if (typeof (sKPI) != "undefined") {
			if (sKPI != "") {

				ga('send', {
				  'hitType': 'pageview',
				  'page': '/kpi/' + sKPI.replace(/ /gi, "-")
				});

				if ( (sKPI.toLowerCase().indexOf("donation") >= 0) && ((typeof (ga_donationAmount) != "undefined") && (ga_donationAmount != ""))) {
					sEventValue = ga_donationAmount;
				} else {
					sEventValue = 0;
				}

				ga('send', {
				  'hitType': 'event',           // Required.
				  'eventCategory': 'KPIs',      // Required.
				  'eventAction': sKPI,      	// Required.
				  'eventLabel': sKPI,
				  'eventValue': sEventValue
				});

				
			}
		}
	} catch (e) { }
}

function om_gaTrackEvent(sCategory, sAction) {
	try {
		if ((typeof (sCategory) != "undefined") && (typeof (sAction) != "undefined")) {
			if ((sCategory != "") && (sAction != "")) {
				ga('send', {
				  'hitType': 'event',           // Required.
				  'eventCategory': sCategory,   // Required.
				  'eventAction': sAction,      	// Required.
				  'eventLabel': sCategory + "-" + sAction
				});
			}
		}
	} catch (e) { }
}
/* *************************************************************************************************************	*/
// FUNCTIONS - general
/* *************************************************************************************************************	*/


function om_isArray(obj) { if (obj.constructor.toString().indexOf("Array") == -1) { return false; } else { return true; } }

function om_timestamp() {
	return parseInt((new Date).getTime() / 1e3);
}

function om_getCookie(name) {
	var start = document.cookie.indexOf(name + "=");
	var len = start + name.length + 1;
	if ((!start) && (name != document.cookie.substring(0, name.length))) {
		return null;
	}
	if (start == -1) return null;
	var end = document.cookie.indexOf(';', len);
	if (end == -1) end = document.cookie.length;

	return unescape(document.cookie.substring(len, end));
}

function om_setCookie(name, value, expires, path, domain, secure) {
	var today = new Date();
	today.setTime(today.getTime());
	if (expires) {
		expires = expires * 1000 * 60 * 60 * 24;
	}

	var expires_date = new Date(today.getTime() + (expires));

	document.cookie = name + '=' + escape(value) +
		((expires) ? ';expires=' + expires_date.toGMTString() : '') + //expires.toGMTString()
		((path) ? ';path=' + path : '') +
		((domain) ? ';domain=' + domain : '') +
		((secure) ? ';secure' : '');
}

function om_deleteCookie(name, path, domain) {
	if (getCookie(name)) document.cookie = name + '=' +
			((path) ? ';path=' + path : '') +
			((domain) ? ';domain=' + domain : '') +
			';expires=Thu, 01-Jan-1970 00:00:01 GMT';
}

function parseUrl(data) {

	if (!data.match) return;
	var e = /((http|ftp):\/)?\/?([^:\/\s]+)((\/[\w\-\%]+)*\/)(([\w\-\.\%]+(\.[^#?\s]+))(#[\w\-]+)?)*/;
	//var e = /((http|ftp):\/)?\/?([^:\/\s]+)((\/\w+)*\/)([\w\-\.]+(\.[^#?\s]+)(#[\w\-]+)?)*/;

	if (data.match(e)) {
		//alert( "data: " + data + " | url:" +  RegExp['$&'] + " | protocol: " + RegExp.$2 + " | host: " + RegExp.$3 + " | path: " + RegExp.$4 + " | file: " + RegExp.$7 + " | hash: " + RegExp.$10);
		return { url: RegExp['$&'],
			protocol: RegExp.$2,
			host: RegExp.$3,
			path: RegExp.$4,
			file: RegExp.$7,
			hash: RegExp.$10
		};
	}
	else {
		return { url: "", protocol: "", host: "", path: "", file: "", hash: "" };
	}
}

function isArray(obj) {
	if (obj.constructor.toString().indexOf("Array") == -1)
		return false;
	else
		return true;
}


function getURLParam(strParamName) {
	var strReturn = "";
	var strHref = sOm_strHref_Orig;
	if (strHref.indexOf("?") > -1) {
		var strQueryString = "";
		if (strHref.indexOf("#") > strHref.indexOf("?")) {
			strQueryString = strHref.substr(strHref.indexOf("?")+1, strHref.indexOf("#")-strHref.indexOf("?")-1);			
		} else {	
			strQueryString = strHref.substr(strHref.indexOf("?")+1);
		}
		var aQueryString = strQueryString.split("&");
		for (var iParam = 0; iParam < aQueryString.length; iParam++) {
			if (aQueryString[iParam].toLowerCase().indexOf(strParamName.toLowerCase() + "=") == 0) {
				var aParam = aQueryString[iParam].split("=");
				strReturn = aParam[1];
				break;
			}
		}
	}
	return decodeURIComponent(strReturn);
}

function getURLParam_v2(strParamName, strURL) {
	var strReturn = "";
	var strHref = strURL;
	if (strHref.indexOf("?") > -1) {
		var strQueryString = strHref.substr(strHref.indexOf("?")+1).toLowerCase();
		var aQueryString = strQueryString.split("&");
		for (var iParam = 0; iParam < aQueryString.length; iParam++) {
			if (aQueryString[iParam].indexOf(strParamName.toLowerCase() + "=") == 0) {
				var aParam = aQueryString[iParam].split("=");
				strReturn = aParam[1];
				break;
			}
		}
	}
	return decodeURIComponent(strReturn);
}
function appendParameter(sString, sParameterName, sParameterValue) {
	// we need to add this parameter in correct URL format

		if (sString.indexOf("?") >= 0) {
			sString = sString + "&" + sParameterName + "=" + sParamValue;
		} else {
			sString = sString + "?" + sParameterName + "=" + sParamValue;
		}
	return sString;
}

var omConsole = function(msg) {
	try {
		console.log(msg);
	} catch (error) {}
}

/* *************************************************************************************************************	*/
// FUNCTIONS - tracking matching gift searches (event tracking instead of page view tracking)
/* *************************************************************************************************************	*/

function omTrackMatchingGiftSearch(sSearchTerm) {
	try {
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar7,eVar29,eVar30,prop39,prop30,events';
		s.linkTrackEvents = 'event15';
		s.eVar7  = 'Matching Gift Search: ' + sSearchTerm; 				// internal search term
		s.eVar29 = 'Fundraising - Matching Gifts Employer Search Form'; // form name
		s.eVar30 = 'Fundraising - Matching Gifts Employer Search'; 		// kpi
		s.prop39 = 'Fundraising - Matching Gifts Employer Search Form - Submit'; // kpi success pathing
		s.prop30 = s.eVar30;
		s.events = 'event15'; // form submit
		s.tl(this, 'o', 'Matching Gifts Employer Search - ' + sSearchTerm);
		om_testandtargetTrackKPI(s.eVar30);
		om_gaTrackKPI(s.eVar30);

	} catch (Error) {};
}

/* *************************************************************************************************************	*/
// FUNCTIONS - for tracking subscribes and unsubscribes using Click Event Tracking (instead of page view tracking)
/* *************************************************************************************************************	*/

function omTrackEmailGetCodeDescription(sEmailCode) {
	try {
		switch (sEmailCode.toUpperCase()) {
			case "STP40": return ("Share the Prayer"); break;
			case "COURSE_FOUNDATIONS": return ("Foundations of the Faith"); break;
			case "21DH": return ("21 Day Habit"); break;
			case "30DAYS08": return ("Call To Prayer"); break;
			case "BIAY": return ("Bible in a Year"); break;
			case "BIAYNT": return ("Bible in a Year - New Testament"); break;
			case "BIAYSP": return ("Superbook - Daily Bible Challenge"); break;
			case "BIAYDEVO": return ("Daily Devotional"); break;
			case "40REVIVAL": return ("40 Days of Personal Revival"); break;
			case "SPL": return ("Spiritual Life Update"); break;
			case "SGS": return ("Spiritual Gifts Update"); break;
			case "CBNNEWS": return ("CBN News Update"); break;
			case "CBNNEWSPM": return ("CBN News Afternoon Update"); break;
			case "ELECTION": return ("CBN News Election Updates"); break;
			case "CBNRADIO": return ("CBN Radio Update"); break;
			case "CHURCH": return ("CBN Church Partnerships Update"); break;
			case "WEEKLYNEWS": return ("CBN News This Week"); break;
			case "HLTH": return ("Health Update"); break;
			case "DD": return ("Daily Update"); break;
			case "LTL": return ("Orphans Promise Update"); break;
			case "ENT": return ("Entertainment Update"); break;
			case "SPL": return ("Spiritual Life Update"); break;
			case "WR": return ("WorldReach Update"); break;
			case "CWN": return ("Christian World News Update"); break;
			case "WW": return ("Weekly Update"); break;
			case "FAM": return ("Family Update"); break;
			case "CBN": return ("CBN Promotions"); break;
			case "SHOPCBN": return ("Shop CBN Promotions"); break;
			case "SHOPSALE": return ("Shop CBN Sale"); break;
			case "ADPARTNERS": return ("CBN Select Offers"); break;
			case "7PW": return ("700 Club Prayer Warrior"); break;
			case "SUPERBOOK": return ("Superbook Promotions"); break;
			case "BRODY": return ("The Brody File"); break;
			case "STAKELBECK": return ("Stakelbeck on Terror"); break;
			case "JERUSALEM": return ("Jerusalem Dateline"); break;
			case "FRONTLINES": return ("Frontlines"); break;
			case "CBNSTORIES": return ("CBN Stories"); break;
			case "PRAYFORAMERICA": return ("Pray for America Devotional"); break;
			case "THEHOPE1948MOVIE": return ("The Hope 1948 Movie"); break;
			case "SHAPEUPFORSUMMER": return ("Shape Up For Summer"); break;
            case "SHAPEUP": return ("Shape Up For Summer"); break;
			case "WELCOME": return ("Welcome Series"); break;
			case "7CIPRAY": return ("Prayer Warrior Devotional"); break;
			case "ADVENT": return ("Advent Series"); break;
			case "AMHF": return ("AMHF Updates"); break;
			default: return ("Unknown Email Code - " + sEmailCode);
		}
	} catch (Error) {
		return ("Unknown - Email Code Not Available");
	}
}

function omTrackEmailSubscribe_v2 (sEmailCode, sIntCmp) {

	var sEmailDescription = omTrackEmailGetCodeDescription(sEmailCode);
	var s = s_gi(s_account);
	s.linkTrackVars = 'eVar28,eVar30,prop39,prop30,events';
	if (sIntCmp != "") {
			s.linkTrackVars = 'eVar28,eVar30,eVar13,prop39,prop30,events';
			s.eVar13 = sIntCmp;
	}
	s.linkTrackEvents = 'event17';
	s.eVar28 = 'Email - Subscribe - ' + sEmailDescription;
	s.prop39 = s.eVar28;
	s.eVar30 = s.eVar28;
	s.prop30 = s.eVar28;
	s.events = 'event17';
	s.tl(this, 'o', 'Email Subscription - ' + sEmailDescription);
	om_testandtargetTrackKPI(s.eVar30);
	om_gaTrackKPI(s.eVar30);
	om_fbtrack(s.eVar30);
}

function omTrackEmailUnsubscribe_v2(sEmailCode, sIntCmp) {

	var sEmailDescription = omTrackEmailGetCodeDescription(sEmailCode);
	var s = s_gi(s_account);
	s.linkTrackVars = 'eVar28,eVar30,prop39,events';
	if (sIntCmp != "") {
			s.linkTrackVars = 'eVar28,eVar30,eVar13,prop39,prop30,events';
			s.eVar13 = sIntCmp;
	}
	s.linkTrackEvents = 'event18';
	s.eVar28 = 'Email - Unsubscribe - ' + sEmailDescription;
	s.prop39 = s.eVar28;
	s.eVar30 = s.eVar28;
	s.prop30 = s.eVar28;
	s.events = 'event18';
	s.tl(this, 'o', 'Email Unsubscribe - ' + sEmailDescription);
	om_testandtargetTrackKPI(s.eVar30);
	om_gaTrackKPI(s.eVar30);
}

// maintain for backward compatibility

function omTrackEmailSubscribe(sEmailCode) {
	omTrackEmailSubscribe_v2(sEmailCode, "");
}
function omTrackEmailUnsubscribe(sEmailCode) {
	omTrackEmailUnsubscribe_v2(sEmailCode, "");
}

/* *************************************************************************************************************	*/
// INLINE - for tracking subscribes and unsubscribes
/* *************************************************************************************************************	*/

// Do we need to log an email course subscribe event? Check if global variable set prior to script include
try {
	if ((typeof (omTrackEmailSubscribeCode) != "undefined") && (omTrackEmailSubscribeCode!="")) {
		// Do we have more than one subscription code
		if (omTrackEmailSubscribeCode.indexOf(",") >= 0) {
			// multiple values - log each subscription
			om_arr_subscriptions = omTrackEmailSubscribeCode.split(",");
			if (isArray(om_arr_subscriptions)) {
				for (om_subi = 0; om_subi < om_arr_subscriptions.length; om_subi = om_subi + 1) {
					if (om_arr_subscriptions[om_subi] != "") {
						omTrackEmailSubscribe(om_arr_subscriptions[om_subi]);
					}
				}
			}
		} else {
			// single value
			omTrackEmailSubscribe(omTrackEmailSubscribeCode)
		}
	}
} catch (Error) { }

// Do we need to log an email course unsubscribe event?  Check if global variable set prior to script include
try {
	if ((typeof (omTrackEmailUnsubscribeCode) != "undefined") && (omTrackEmailUnsubscribeCode != "")) {
		// Do we have more than one subscription code
		if (omTrackEmailUnsubscribeCode.indexOf(",") >= 0) {
			// multiple values - log each subscription
			om_arr_unsubscriptions = omTrackEmailUnsubscribeCode.split(",");
			if (isArray(om_arr_unsubscriptions)) {
				for (om_subi = 0; om_subi < om_arr_unsubscriptions.length; om_subi = om_subi + 1) {
					if (om_arr_unsubscriptions[om_subi] != "") {
						omTrackEmailUnsubscribe(om_arr_unsubscriptions[om_subi]);
					}
				}
			}
		} else {
			// single value
			omTrackEmailUnsubscribe(omTrackEmailUnsubscribeCode)
		}
	}
} catch (Error) { }


/* *************************************************************************************************************	*/
/* FUNCTIONS - Radio Player Tracking																				*/
/* *************************************************************************************************************	*/

function omTrackRadio(sRadioStationID, sAction, iSecondsListened, sStreamSource ) {

	try {

	var om_sAddEvents 	= "";
	var om_sAddProducts = "";
	var sRadioCode 		= "unknown";
	iSecondsListened = typeof iSecondsListened !== 'undefined' ? iSecondsListened : 0;
	sStreamSource = typeof sStreamSource !== 'undefined' ? sStreamSource : "Stream";

	// station
	switch (sRadioStationID.toLowerCase()) {
			case "cbnradio":
			case "cbn.com/radio/contemporary":
			case "cbn.com/radio/contemporary/":
				 	sRadioCode = "CBNRadio1";
					sRadioStationID = "Contemporary";
					break;
			case "praise":
			case "cbn.com/radio/praise":
			case "cbn.com/radio/praise/":
			 		sRadioCode = "CBNRadio2";
					sRadioStationID = "Praise";
					break;
			case "gospel":
			case "cbn.com/radio/gospel":
			case "cbn.com/radio/gospel/":
			 		sRadioCode = "CBNRadio3";
					sRadioStationID = "Gospel";
					break;
			case "superbook":
			case "cbn.com/radio/superbook":
			case "cbn.com/radio/superbook/":
				 	sRadioCode = "CBNRadio4";
					sRadioStationID = "Superbook";
					break;
			case "country":
			case "cbn.com/radio/crosscountry":
			case "cbn.com/radio/crosscountry/":
					sRadioCode = "CBNRadio5";
					sRadioStationID = "Country";
					break;
			case "christmas":
			case "cbn.com/radio/christmas":
			case "cbn.com/radio/christmas/":
					sRadioCode = "CBNRadio6";
					sRadioStationID = "Christmas";
					break;
			case "fiesta hoy":
			case "cbn.com/radio/fiestahoy":
			case "cbn.com/radio/fiestahoy/":
					sRadioCode = "CBNRadio7";
					sRadioStationID = "FiestaHoy";
					break;
			case "news":
			case "cbn.com/radio/cbnnews":
			case "cbn.com/radio/cbnnews/":
					sRadioCode = "News_A";
					sRadioStationID = "News";
					break;
			case "praise.com":
					sRadioCode = "PraiseRadio1";
					sRadioStationID = "Praise.com";
					break;
			case "country christmas":
			case "cbn.com/radio/crosscountrychristmas":
			case "cbn.com/radio/crosscountrychristmas/":
					sRadioCode = "CBNRadio8";
					sRadioStationID = "Country Christmas";
					break;
			case "selah":
			case "instrumental":
			case "cbn.com/radio/selah":
			case "cbn.com/radio/instrumental":
			case "cbn.com/radio/selah/":
			case "cbn.com/radio/instrumental/":
					sRadioCode = "CBNRadio9";
					sRadioStationID = "Selah";
					break;
			case "cbn.com/radio/southern-gospel":
					sRadioCode = "CBNRadio10";
					sRadioStationID = "Southern Gospel";
					break;
			default:
					sRadioCode="unknown";
					break;
	}


	// events
	switch (sAction.toLowerCase()) {
			case "load":
							s.linkTrackEvents  = "event10"; // visit start
							s.events = "event10";
							om_sAddEvents = "events,";
							break;
			case "play":
							s.linkTrackEvents  = "event7"; // start
							s.events = "event7";
							om_sAddEvents = "events,";
							break;
			case "pause":
							s.linkTrackEvents  = "event8,event9"; // complete, seconds consumed
							s.events = "event8,event9";
							s.products=";;;;event9=" + iSecondsListened;
							om_sAddEvents = "events,";
							om_sAddProducts = "products,";
							break;
			case "buffer empty":
							s.linkTrackEvents  = "event8,event9,event37"; // complete, seconds consumed, buffer empty
							s.events = "event8,event9,event37";
							s.products=";;;;event9=" + iSecondsListened;
							om_sAddEvents = "events,";
							om_sAddProducts = "products,";
							break;
			case "listening":
							s.linkTrackEvents  = "event9"; // seconds consumed
							s.events = "event9";
							s.products=";;;;event9=" + iSecondsListened;
							om_sAddEvents = "events,";
							om_sAddProducts = "products,";
							sAction = "Listening";
							break;
			default:
							break;
	}


	s.linkTrackVars = om_sAddEvents + om_sAddProducts + "prop16,prop17,prop18,prop19,prop20,prop31,eVar16,eVar17,eVar18,eVar19,eVar20,eVar31";

	// Variables to Track
	s.prop16 =	"Radio";
	s.eVar16 = 	"Radio";
	s.prop17 =	"Radio|" + sRadioCode;
	s.eVar17 = 	"Radio|" + sRadioCode;
	s.eVar18 =	"Value_Not_Set";
	s.prop18 =	"Value_Not_Set";
	s.eVar19 =	"Value_Not_Set";
	s.prop19 =	"Value_Not_Set";
	s.eVar20 =	"Value_Not_Set";
	s.prop20 =	"Value_Not_Set";
	s.eVar31 =	"Value_Not_Set";
	s.prop31 =	"Value_Not_Set";

	// exclude Adobe tracking if logfile tracking is used
	if (sStreamSource.toLowerCase().indexOf("akamai") == -1) {
		s.tl(this, 'o', 'radio_' + sRadioStationID  + '_' + sAction);
	}

	// ga tracking
	om_gaTrackKPI_SetTitle("Radio - " + sRadioStationID + " - " + sAction ,"CBN Radio Player - " + sRadioStationID);

	} catch (Error) { }
}

function omTrackRadioGA(sRadioStationID, sAction ) {

	try {

	// station
	switch (sRadioStationID.toLowerCase()) {
			case "contemporary":
					sRadioStationID = "Contemporary";
					break;
			case "praise":
					sRadioStationID = "Praise";
					break;
			case "gospel":
					sRadioStationID = "Gospel";
					break;
			case "superbook":
					sRadioStationID = "Superbook";
					break;
			case "crosscountry":
					sRadioStationID = "Country";
					break;
			case "christmas":
					sRadioStationID = "Christmas";
					break;
			case "fiestahoy":
					sRadioStationID = "FiestaHoy";
					break;
			case "cbnnews":
					sRadioStationID = "News";
					break;
			case "praise.com":
					sRadioStationID = "Praise.com";
					break;
			case "crosscountrychristmas":
					sRadioStationID = "Country Christmas";
					break;
			case "selah":
					sRadioStationID = "Selah";
					break;
			case "southerngospel":
					sRadioStationID = "Southern Gospel";
					break;
			default:
					sRadioCode="unknown";
					break;
	}

	// events
	switch (sAction.toLowerCase()) {
			case "listening":
					sAction = "Listening";
					break;
			default:
					break;
	}


	// ga tracking
	om_gaTrackKPI_SetTitle("Radio - " + sRadioStationID + " - " + sAction ,"CBN Radio Player - " + sRadioStationID);

	} catch (Error) { }
}

/* *************************************************************************************************************	*/
/* FUNCTIONS - VideoTracking																						*/
/* *************************************************************************************************************	*/

function omTrackMobileVideo(sVideoTitle,sVideoPrefix) {
	try {

	// sVideoTitle:		Title of the mobile video being played
	// note this function is used by all non flash video players, regardless of desktop or device

	//var sVideoEncodedTitle = encodeURIComponent(sVideoTitle);
	var s = s_gi(s_account);
	s.eVar65 = sVideoPrefix + "_NONFLASH|" + sVideoTitle;
	s.prop65 = 	s.eVar65
	s.eVar16 = sVideoPrefix + "_NONFLASH";
	s.prop16 = s.eVar16;
	s.linkTrackVars = 'eVar16,prop16,eVar65,prop65';
	s.tl(this, 'o', 'mobilevideo-play_' + sVideoPrefix  + '_NONFLASH|' + sVideoTitle);

	} catch (Error) { }
}

function omTrackVideo(sVideoEvent, sVideoTitle, iTimeViewed, sVideoPlayerPrefix, bDefaultPlayer, bFlashPlayer) {

	// sVideoEvent:			[string]  Either "start", "stop", "watching"
	// sVideoTitle:			[string]  Title of the mobile video being played
	// iTimeViewed:			[integer] Amount of seconds the video has been watched since the last call. Note set to 0 for start events.
	// sVideoPlayerPrefix:	[string]  Prefix of the current player being used e.g. "VOD", "NEWS_VOD", "WIDGET_VOD", "IPTV", etc.
	// bDefaultPlayer:		[boolean] Is this our default Brightcove Player(s)
	// bFlashPlayer:		[boolean] Is this a flash player. Set to false if it is an HTML player

	try {
		//var sVideoEncodedTitle = encodeURIComponent(sVideoTitle);
		var sAddPrefix = "";
		if (!bFlashPlayer) sAddPrefix = "_NONFLASH";
		switch (sVideoEvent.toLowerCase()) {
			case "start":
				// do not track flash brightcove players in Omniture (handled by flash player plugins)
				if (!bDefaultPlayer || !bFlashPlayer) {
					var s = s_gi(s_account);
					if (sVideoPlayerPrefix.toLowerCase().indexOf("widget") >= 0) {
						// track within widget report suite
						s.sa(s_widget_account);
					} else {
						// track within default report suite
						s.sa(s_account);
					}
					s.eVar65 = sVideoPlayerPrefix + sAddPrefix + "|" + sVideoTitle;
					s.prop65 = s.eVar65
					s.eVar16 = sVideoPlayerPrefix + sAddPrefix;
					s.prop16 = s.eVar16;
					s.events = 'event33';
					s.linkTrackEvents = 'event33'; // video view
					s.linkTrackVars = 'eVar16,prop16,eVar65,prop65,events';
					s.tl(this, 'o', 'mobilevideo-play_' + sVideoPlayerPrefix  + sAddPrefix + '|' + sVideoTitle);
					//omConsole("[OM] omVideo - start - " + s.eVar65);
				}
				// ga tracking
				if (sVideoPlayerPrefix.toLowerCase().indexOf("widget_news") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - start - " + sVideoTitle, "CBN TV News Widget - " + sVideoTitle);
				} else if (sVideoPlayerPrefix.toLowerCase().indexOf("widget") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - start - " + sVideoTitle, "CBN TV Widget - " + sVideoTitle);
				} else {
					om_gaTrackKPI(sVideoPlayerPrefix + " - start - " + sVideoTitle);
				}
				//omConsole("[OM] gaVideo - start - " + sVideoTitle);

				// test and target KPI tracking
				om_testandtargetTrackKPI("Video - Start - " + sVideoPlayerPrefix);

				// superbook KPI tracking
				if (typeof(sLanguage) == "undefined") {
					try { sLanguage = document.getElementsByTagName("html")[0].getAttribute("lang"); } catch (Error) { sLanguage = "unknown"}
				}
				if (sVideoPlayerPrefix.toLowerCase().indexOf("superbook_ep_vod") >= 0) {
					omTrackSuperbook("Video Page","Viewed Video - episode - " + sVideoTitle,sLanguage);
				} else if (sVideoPlayerPrefix.toLowerCase().indexOf("superbook_vod") >= 0) {
					omTrackSuperbook("Video Page","Viewed Video - clip - " + sVideoTitle,sLanguage);
				}

				
				break;
			case "stop":
			case "watching":
				// add time interval tracking
				// ...
				// do not track flash brightcove players in Omniture (handled by flash player plugins)
				if (!bDefaultPlayer || !bFlashPlayer) {
					var s = s_gi(s_account);
					if (sVideoPlayerPrefix.toLowerCase().indexOf("widget") >= 0) {
						// track within widget report suite
						s.sa(s_widget_account);
					} else {
						// track within default report suite
						s.sa(s_account);
					}
					s.eVar65 = sVideoPlayerPrefix + sAddPrefix + "|" + sVideoTitle;
					s.prop65 = s.eVar65
					s.eVar16 = sVideoPlayerPrefix + sAddPrefix;
					s.prop16 = s.eVar16;
					if (!iTimeViewed) { iTimeViewed = 0 };
					s.events = 'event35=' + iTimeViewed;
					s.linkTrackEvents = 'event35';
					s.linkTrackVars = 'eVar16,prop16,eVar65,prop65,events';
					s.tl(this, 'o', 'mobilevideo-watching_' + sVideoPlayerPrefix  + sAddPrefix + '|' + sVideoTitle);
					//omConsole("[OM] omVideo - watching - " + s.eVar65);

				}
				// ga tracking
				if (sVideoPlayerPrefix.toLowerCase().indexOf("widget_news") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - watching - " + sVideoTitle, "CBN TV News Widget - " + sVideoTitle);
				} else if (sVideoPlayerPrefix.toLowerCase().indexOf("widget") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - watching - " + sVideoTitle, "CBN TV Widget - " + sVideoTitle);
				} else {
					om_gaTrackKPI(sVideoPlayerPrefix + " - watching - " + sVideoTitle);
				}
				//omConsole("[OM] gaVideo - watching - " + sVideoTitle);
				break;
			default:
    	}
	} catch (Error) { }
}

function omTrackVideoGA(sVideoEvent, sVideoTitle, iTimeViewed, sVideoPlayerPrefix, bDefaultPlayer, bFlashPlayer) {

	// sVideoEvent:			[string]  Either "start", "stop", "watching"
	// sVideoTitle:			[string]  Title of the mobile video being played
	// iTimeViewed:			[integer] Amount of seconds the video has been watched since the last call. Note set to 0 for start events.
	// sVideoPlayerPrefix:	[string]  Prefix of the current player being used e.g. "VOD", "NEWS_VOD", "WIDGET_VOD", "IPTV", etc.
	// bDefaultPlayer:		[boolean] Is this our default Brightcove Player(s)
	// bFlashPlayer:		[boolean] Is this a flash player. Set to false if it is an HTML player

	try {
		var sAddPrefix = "";
		if (!bFlashPlayer) sAddPrefix = "_NONFLASH";
		switch (sVideoEvent.toLowerCase()) {
			case "start":
				// ga tracking
				if (sVideoPlayerPrefix.toLowerCase().indexOf("widget_news") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - start - " + sVideoTitle, "CBN News Video Widget - " + sVideoTitle);
				} else if (sVideoPlayerPrefix.toLowerCase().indexOf("widget") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - start - " + sVideoTitle, "CBN Video Widget - " + sVideoTitle);
				} else {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - start - " + sVideoTitle, "CBN Video - " + sVideoTitle);
				}
				//omConsole("[OM] gaVideo - start - " + sVideoTitle);

				// test and target KPI tracking
				om_testandtargetTrackKPI("Video - Start - " + sVideoPlayerPrefix);

				// superbook KPI tracking
				if (typeof(sLanguage) == "undefined") {
					try { sLanguage = document.getElementsByTagName("html")[0].getAttribute("lang"); } catch (Error) { sLanguage = "unknown"}
				}
				if (sVideoPlayerPrefix.toLowerCase().indexOf("superbook_ep_vod") >= 0) {
					omTrackSuperbook("Video Page","Viewed Video - episode - " + sVideoTitle,sLanguage);
				} else if (sVideoPlayerPrefix.toLowerCase().indexOf("superbook_vod") >= 0) {
					omTrackSuperbook("Video Page","Viewed Video - clip - " + sVideoTitle,sLanguage);
				}

				
				break;
			case "stop":
			case "watching":
				// add time interval tracking
				// ...
				// ga tracking
				if (sVideoPlayerPrefix.toLowerCase().indexOf("widget_news") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - watching - " + sVideoTitle, "CBN News Video Widget - " + sVideoTitle);
				} else if (sVideoPlayerPrefix.toLowerCase().indexOf("widget") >= 0) {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - watching - " + sVideoTitle, "CBN Video Widget - " + sVideoTitle);
				} else {
					om_gaTrackKPI_SetTitle(sVideoPlayerPrefix + " - watching - " + sVideoTitle, "CBN Video - " + sVideoTitle);
				}
				//omConsole("[OM] gaVideo - watching - " + sVideoTitle);
				break;
			default:
    	}
	} catch (Error) { }
}

/* *************************************************************************************************************	*/
/* FUNCTIONS - Dynamic Page Tracking																																							*/
/* *************************************************************************************************************	*/

function omTrackDynamicCBNPage(sPageURL, sPageTitle) {
	try {
		// track full url
		s.eVar39 = sPageURL;
		s.prop14 = sPageURL;
		// clean up pagename
		sPageURL = sPageURL.toLowerCase().replace(" ", "_").replace("'", "").replace("\"", "");
		sPageURL = sPageURL.replace("http://",""); 	// remove any http prefix
		sPageURL = sPageURL.replace("https://",""); // remove any https prefix
		// reset KPIs
		s.eVar30 = ""; s.prop30 = ""; s.prop39 = "";
		// remove any parameters or anchor tags
		if (sPageURL.indexOf("?") >=0) { sPageURL=sPageURL.substring(0,sPageURL.indexOf("?")) }
		if (sPageURL.indexOf("#") >=0) { sPageURL=sPageURL.substring(0,sPageURL.indexOf("#")) }
		// set page name
		s.pageName = sPageURL;
		// determine correct subsections
	  s.channel = "Value_Not_Set"; // main section
		s.hier1   = "Value_Not_Set"; // main hierachy
		s.prop1   = "Value_Not_Set"; // sub-section
		s.prop2   = "Value_Not_Set"; // sub-section 2
		s.prop3   = "Value_Not_Set"; // sub-section 3
		s.prop60  = "Value_Not_Set"; // domain
		s.eVar1	  = s.prop1;
		s.eVar2	  = s.prop2;
		s.eVar3	  = s.prop3;
		s.eVar60  = s.prop60;
		om_arr_sections = sPageURL.split("\/");
			if (isArray(om_arr_sections)) {
				// if (om_arr_sections.length > 0) {  s.eVar60 = om_arr_sections[0]; s.prop60 = s.eVar60; }
				if (om_arr_sections.length > 0) {  s.prop60   = om_arr_sections[0];	s.eVar60 = s.prop60 };
				if (om_arr_sections.length > 1) {  s.channel  = s.prop60  + "/" + om_arr_sections[1];	s.hier1 = s.channel; };
				if (om_arr_sections.length > 2) {  s.prop1 	  = s.channel + "/" + om_arr_sections[2];	s.eVar1 = s.prop1; };
				if (om_arr_sections.length > 3) {  s.prop2 	  = s.prop1   + "/" + om_arr_sections[3];	s.eVar2 = s.prop2; };
				if (om_arr_sections.length > 4) {  s.prop3 	  = s.prop2   + "/" + om_arr_sections[4];	s.eVar3 = s.prop3; };

				//alert("Domain = " + s.eVar60 + "\nSection = " + s.channel + " \nSub-Section = " + s.prop1 + " \nSub-Section 2 = " + s.prop2 + " \nSub-Section 3 = " + s.prop3 + " \n " + s.pageName);
			}
		s_doPlugins(s);
		s.t();
		if (typeof(sPageTitle) != "undefined") {
			ga('send', {
				  'hitType': 'pageview',
				  'page': sPageURL.replace(location.host,""),
				  'title': sPageTitle
			});
		} else {
			ga('send', {
				  'hitType': 'pageview',
				  'page': sPageURL.replace(location.host,"")
			});
		}
	} catch (Error) { }
}

function omTrackScrollPage(sPageURL, sPageTitle) {
	try {
		// track full url
		s.eVar39 = sPageURL;
		s.prop14 = sPageURL;
		s.prop27 = sPageTitle + " _ " + sPageURL;
		// clean up page url
		sPageURL = sPageURL.toLowerCase().replace(" ", "_").replace("'", "").replace("\"", "");
		sPageURL = sPageURL.replace("http://",""); 	// remove any http prefix
		sPageURL = sPageURL.replace("https://",""); // remove any https prefix
		// reset KPIs
		s.eVar30 = ""; s.prop30 = ""; s.prop39 = "";
		// remove any parameters or anchor tags
		if (sPageURL.indexOf("?") >=0) { sPageURL=sPageURL.substring(0,sPageURL.indexOf("?")) }
		if (sPageURL.indexOf("#") >=0) { sPageURL=sPageURL.substring(0,sPageURL.indexOf("#")) }
		// set page name
		s.pageName = sPageURL;
		s.eVar11 = sPageURL;
		// set page title
		s.eVar61 = sPageTitle; 
		s.eVar62 = sPageTitle;
		s.prop61 = sPageTitle;
		// set keywords
		s.eVar52 = ""; s.prop52 = "";
        // determine current events being tracked
        var sCurrentEventsValue = s.events;
        s.events=s.apl(s.events,'event38',',',2);
		// update variables and determine correct section and subsections
		s_doPlugins(s);
        // track page
		s.t();
		if (typeof(sPageTitle) != "undefined") {
			ga('send', {
				  'hitType': 'pageview',
				  'page': sPageURL.replace(location.host,""),
				  'title': sPageTitle
			});
		} else {
			ga('send', {
				  'hitType': 'pageview',
				  'page': sPageURL.replace(location.host,"")
			});
		}
        // reset events being tracked
        s.events=sCurrentEventsValue;
        
	} catch (Error) { }
}

/* *************************************************************************************************************	*/
/* FUNCTIONS - Download / Content / Share Event Tracking															*/
/* *************************************************************************************************************	*/

function omTrackIntcmp (sIntcmp) {
	try {
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar13';
		s.eVar13 = sIntcmp;
		s.tl(this, 'o', 'Intcmp Tracking - ' + sIntcmp);
	} catch (e) { }
}

function omTrackShare (sProvider, sSharedURL) {
	try {
		if ((typeof (sProvider) == "undefined") || (sProvider == "")) {
			sProvider = "Unknown";
		}
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar66,prop66';
		s.eVar66 = sProvider + "_" + sSharedURL;
		s.prop66 = s.eVar66;
		s.tl(this, 'o', s.eVar66);
	} catch (Error) { }
}

function omTrackContentClick(sINTCMP) {
	try {

	// sTrackingValue:
	//					Varies based on intcmp of the event being tracked e.g. "EVAN0001"

	// standardize parameters
	var sTrackingParameter = sINTCMP.toLowerCase();
	sTrackingValue = sTrackingParameter.replace(/%20/gi, " ");
	//alert("Tracking: value=" + sTrackingValue);
	//console.log("Tracking: value=" + sTrackingValue);

	var s = s_gi(s_account);

	s.eVar13 = sTrackingValue;
	s.linkTrackVars = 'eVar13';
	s.tl(this, 'o', 'Content Click - ' + sTrackingValue);

	} catch (Error) { }
}

// functions for tracking download click events

function omTrackDownload(sResourceID, sResourceType) {
	try {
		// called using the onClick event to track downloads of resources
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar40,prop40';
		s.eVar40 = sResourceType + "_" + sResourceID;
		s.prop40 = s.eVar40;
		s.tl(this, 'o', 'Download_' + sResourceType);
		om_testandtargetTrackKPI("Download " + sResourceType);
		om_gaTrackKPI("Download " + sResourceType);
	} catch (Error) { }
}

function omTrackSuperbookDevoDownload(sResourceID, sResourceType) {

	try {
		// called using the onClick event to track downloads of Superbook Devotional Resources
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar40,eVar30,prop40,prop30';
		s.eVar40 = sResourceType + "_" + sResourceID;
		s.prop40 = s.eVar40;
		s.eVar30 = "Discipleship - Superbook Devo Download - New Journey With God";
		s.prop30 = s.eVar30;
		s.tl(this, 'o', 'Download_' + sResourceType);
		om_gaTrackKPI(s.eVar30);
	} catch (Error) { }
}

// functions for tracking superbook download events

function omTrackSuperbookDownload(sResourceName,sLanguage) {
	try {

		// sResourceName:
		//					Gizmo's Bible Adventures - Your New Journey with God
		// sLanguage:
		//					en			  - english
		//					es			  - spanish

		sLanguage = omStandardizeLanguage(sLanguage);

		// called using the onClick event to track resource downloads
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar40,eVar30,prop40,prop30';
		s.eVar40 = "Superbook_Download_" + sResourceName;
		s.prop40 = s.eVar40;
		s.eVar30 = "Discipleship - Superbook Download - " + sLanguage + " - " + sResourceName;
		s.prop30 = s.eVar30;
		s.tl(this, 'o', 'Superbook_Download');
		om_gaTrackKPI(s.eVar30);
	} catch (Error) { }
}

function omTrackSuperbookGame(sGameTitle, sLanguage) {
	try {

		if (sOm_strHref.indexOf("channel=app") >=0) {
			sTrackURL = "http://aws.superbook.cbn.com/custom/api/omni_postback.php?category=html-game&type=load-game&detail=" + encodeURI(sGameTitle) + "&value=&" + sOm_strHref.substring(sOm_strHref.indexOf('?') + 1)
			jQuery.ajax({
                        type: "GET",
                        url: sTrackURL,
                        dataType:"text",
                        success: function(data) {
							// success
						},
                        error: function(e){                
							// error     
                        }
            });


		} else {
			sLanguage = omStandardizeLanguage(sLanguage);
	
			// called using the onClick event to track interaction KPIs
			var s = s_gi(s_account);
			s.linkTrackVars = 'eVar30,prop30';
			s.eVar30 = "Superbook - Play Game - " + sLanguage + " - " + sGameTitle;
			s.prop30 = s.eVar30;
			// s.tl(this, 'o', s.eVar30);
			s.t();
			om_gaTrackKPI(s.eVar30);
		}
	} catch (Error) { }

}

/* *************************************************************************************************************	*/
/* FUNCTIONS - Interaction Event Tracking																			*/
/* *************************************************************************************************************	*/

// functions for tracking interaction click events

function omTrackInteraction(sInteractionActivity) {
	try {
		// called using the onClick event to track interaction KPIs
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar30,prop30';
		s.eVar30 = "Interaction - " + sInteractionActivity;
		s.prop30 = s.eVar30;
		s.tl(this, 'o', s.eVar30);
		om_gaTrackKPI(s.eVar30);
	} catch (Error) { }
}

/* *************************************************************************************************************	*/
/* FUNCTIONS - KPI Event Tracking																					*/
/* *************************************************************************************************************	*/

// functions for tracking KPI click events

function omTrackKpiActivity(sKpiActivity) {
	try {
		// called using the onClick event to track KPIs
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar30,prop30';
		s.eVar30 = sKpiActivity;
		s.prop30 = s.eVar30;
		s.tl(this, 'o', s.eVar30);
		om_gaTrackKPI(s.eVar30);
		om_fbtrack(sKpiActivity);
		//om_quanttrack(sKpiActivity);
		om_testandtargetTrackKPI(s.eVar30);
	} catch (Error) { }

}

/* *************************************************************************************************************	*/
/* FUNCTIONS - Community Event Tracking																				*/
/* *************************************************************************************************************	*/

// functions for tracking community KPI click events

function omTrackCommunityActivity(sCommunityActivity) {
	try {
		// called using the onClick event to track community KPIs
		var s = s_gi(s_account);
		s.linkTrackVars = 'eVar30,prop30';
		s.eVar30 = "Community - " + sCommunityActivity;
		s.prop30 = s.eVar30;
		s.tl(this, 'o', s.eVar30);
		om_gaTrackKPI(s.eVar30);
		om_fbtrack(sCommunityActivity);
		om_quanttrack(sCommunityActivity);
		om_testandtargetTrackKPI(sCommunityActivity);
	} catch (Error) { }

}

/* *************************************************************************************************************	*/
/* INLINE - Community Event Tracking																				*/
/* *************************************************************************************************************	*/

// Do we need to log a community KPI event? Check global variable set before script include
try {
	if ((typeof (omTrackCommunityActivityName) != "undefined") && (omTrackCommunityActivityName != "")) {
		omTrackCommunityActivity(omTrackCommunityActivityName);
	}
} catch (Error) { }


function omTrackResponse(sContentType,sTrackingValue,sPresentationType) {
try {

		// sContentType:
		//					Gospel
		// sTrackingValue:
		//					View		  - view the gospel presentation (first slide)
		//					Question	  - view the question submission page (filled in and submitted question form)
		//					Prayed		  - view the page after they click on Yes, I just prayed the prayer
		//					New			  - filled in and submitted response form and indicated new salvation
		//					Recommitment  - filled in and submitted response form and indicated recommitment
		//					Unknown		  - filled in and submitted response form and did not indicate a new salvation or recommitment

	// standardize parameters
	var sTrackingParameter = sTrackingValue.toLowerCase();
	sTrackingParameter = sTrackingParameter.replace(/%20/gi, " ");

	var s = s_gi(s_account);

	if (sContentType.toLowerCase() == "gospel") {


			if (sTrackingParameter == "view") {
				// Viewed Gospel Presentation
				s.eVar30 = "Evangelism - Viewed Gospel Presentation - Hope - " + sPresentationType;	// KPI
				s.events = "event14"; 																// gospel view event
				s.prop39 = "Evangelism - Viewed Gospel Presentation - Hope - " + sPresentationType;	// site success pathing
				s.linkTrackVars = 'eVar30,prop39,events';
				s.linkTrackEvents = 'event14';


			} else if (sTrackingParameter == "prayed") {
				// Prayed Salvation Prayer and Presented with Commitment Form
				s.eVar29 = "Evangelism - Gospel Commitment Form - " + sPresentationType; 				// form type
				s.events = "event16,event41"; 														// form view + prayed
				s.eVar30 = "Evangelism - Prayed Salvation Prayer - Hope - " + sPresentationType;
				s.prop39 = "Evangelism - Prayed Salvation Prayer - Hope - " + sPresentationType;		// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event16,event41';

			} else if (sTrackingParameter == "contacted") {
				// Prayed Salvation Prayer and Submit Contact Form
				s.eVar29 = "Evangelism - Gospel Contact Form - " + sPresentationType; 				// form type
				s.events = "event16,event41"; 														// form view + prayed
				s.eVar30 = "Evangelism - Prayed & Contacted Us - Hope - " + sPresentationType;
				s.prop39 = "Evangelism - Prayed & Contacted Us - Hope - " + sPresentationType;		// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event16,event41';

			} else if ((sTrackingParameter == "new") || (sTrackingParameter == "new_commitment") || (sTrackingParameter.indexOf("new|") == 0)) {
				// Submitted form and indicated a new commitment
				s.eVar29 = "Evangelism - Gospel Commitment Form - " + sPresentationType; 				// form type
				s.events = "event15,event12,event42"; 													// form success & new commitment events
				s.eVar30 = "Evangelism - Contacted Us - New Commitment - Hope - " + sPresentationType;
				s.prop39 = "Evangelism - Contacted Us - Commitment - Hope - " + sPresentationType;		// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event15,event12,event42';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("new|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="HOPEN_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}

			} else if ((sTrackingParameter == "recommitment") || (sTrackingParameter.indexOf("recommitment|") == 0)) {
				// Submitted form and indicated a recommitment
				s.eVar29 = "Evangelism - Gospel Commitment Form - " + sPresentationType; 				// form type
				s.events = "event15,event13,event42"; 													// form success and recommitment events
				s.eVar30 = "Evangelism - Contacted Us - Recommitment - Hope - " + sPresentationType;	// KPI
				s.prop39 = "Evangelism - Contacted Us - Commitment - Hope - " + sPresentationType;		// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event15,event13,event42';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("recommitment|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="HOPER_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}

			} else if ((sTrackingParameter == "unknown") || (sTrackingParameter == "unknown_commitment") || (sTrackingParameter.indexOf("unknown|") == 0) || (sTrackingParameter == "evangelism - contacted us - unknown commitment")) {

				// Submitted form and didn't indicate the type of commitment
				s.eVar29 = "Evangelism - Gospel Commitment Form - " + sPresentationType; 					// form type
				s.events = "event15,event13,event42"; 														// form success and recommitment events
				s.eVar30 = "Evangelism - Contacted Us - Unknown Commitment - Hope - " + sPresentationType;  // KPI
				s.prop39 = "Evangelism - Contacted Us - Commitment - Hope - " + sPresentationType;			// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event15,event13,event42';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("unknown|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="HOPEU_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}

			} else if (sTrackingParameter == "not ready") {
				// Not Ready and Presented with Question Form
				s.eVar29 = "Evangelism - Gospel Questions Form - " + sPresentationType;				// form type
				s.events = "event16"; 																// form view
				s.eVar30 = "Evangelism - Not Ready to Make Commitment - Hope - " + sPresentationType;	// KPI
				s.prop39 = "Evangelism - Not Ready to Make Commitment - Hope - " + sPresentationType;	// site success pathing
				s.linkTrackVars = 'eVar30,eVar29, prop39,events';
				s.linkTrackEvents = 'event16';

			} else if ((sTrackingParameter == "question") || (sTrackingParameter.indexOf("question|") == 0)) {
				// Not Ready and Submitted Question
				s.eVar29 = "Evangelism - Gospel Questions Form - " + sPresentationType;					// form type
				s.events = "event15"; 																	// form success
				s.eVar30 = "Evangelism - Contacted Us - Asked Question - Hope - " + sPresentationType;
				s.prop39 = "Evangelism - Contacted Us - Asked Question - Hope - " + sPresentationType;	// site success pathing
				s.linkTrackVars = 'eVar30,eVar29,prop39,events';
				s.linkTrackEvents = 'event15';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("question|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="HOPEQ_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}
			} else {
				// Evangelism
				s.eVar30 = "Evangelism - Hope - Unknown - " + sTrackingValue + " - " + sPresentationType; 	// KPI
				s.prop39 = s.eVar30;								  			    						// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			}

		} else {
				// Unknown
				s.eVar30 = "Response - Unknown - " + sContentType + " - " + sTrackingValue + " - " + sPresentationType; // KPI
				s.prop39 = s.eVar30;								  							    					// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
	  }
	  s.tl(this, 'o', s.eVar30);
	  om_gaTrackKPI(s.eVar30);
	  om_fbtrack(s.eVar30);
	  om_testandtargetTrackKPI(s.eVar30);

	} catch (Error) { }
}


/* *************************************************************************************************************	*/
/* FUNCTIONS - Quiz Tracking																				*/
/* *************************************************************************************************************	*/

// functions for tracking online quiz events 

function omTrackQuizStart(sQuizName) {

	// sQuizName 	- the name of the current quiz e.g. "Protect Your Heart"
	try {
		var s = s_gi(s_account);
		s.eVar38 = sQuizName;
		s.prop11 = sQuizName;
		s.eVar42 = sQuizName + " - Start";
		s.prop12 = sQuizName + " - Start";;
		s.events = 'event45' // quiz start
		s.linkTrackEvents = 'event45'; 
		s.linkTrackVars = 'eVar38,eVar42,prop11,prop12,events';
		s.tl(this, 'o', "Quiz - " + s.eVar42);
	} catch (Error) { }
}

function omTrackQuizCompleted (sQuizName, iQuizScore) {

	// sQuizName 	- the name of the current quiz e.g. "Protect Your Heart"
	// iQuizResult 	- the quiz score achieved e.g. "67"
	try {
		var s = s_gi(s_account);
		s.eVar38 = sQuizName;
		s.prop11 = sQuizName;
		s.eVar42 = sQuizName + " - Completed";
		s.prop12 = sQuizName + " - Completed";
		s.eVar59 = sQuizName + " - Score: " + iQuizScore;
		s.prop13 = sQuizName + " - Score: " + iQuizScore;
		s.events = 'event46, event47=' + iQuizScore;	// quiz completed, quiz score
		s.linkTrackEvents = 'event46, event47'; 
		s.linkTrackVars = 'eVar38,eVar42,eVar59,prop11,prop12,events';
		s.tl(this, 'o', "Quiz - " + s.eVar42);
	} catch (Error) { }

}

function omTrackQuizQuestion (sQuizName, sQuizQuestion, sQuizQuestionState) {

	// sQuizName 			- the name of the current quiz e.g. "Protect Your Heart"
	// sQuizQuestion 		- the quiz question number and title e.g. "2 - What is the primary function of your heart?"
	// sQuizQuestionState	- "View" when viewing the question
	//						- "Correct" if the question was answered correctly
	//						- "Incorrect" if the question was answered incorrectly
	try {
		var s = s_gi(s_account);
		s.eVar38 = sQuizName;
		s.prop11 = sQuizName;
		s.eVar42 = sQuizQuestion + " - " + sQuizQuestionState;
		s.prop12 = sQuizQuestion + " - " + sQuizQuestionState;
		s.linkTrackVars = 'eVar38,eVar42,prop11,prop12,events';
		if (sQuizQuestionState.toLowerCase().indexOf("incorrect") >= 0) {
			s.events = 'event49';			
			s.linkTrackEvents = 'event49'; 
		} else if (sQuizQuestionState.toLowerCase().indexOf("correct") >= 0) {
			s.events = 'event48';			
			s.linkTrackEvents = 'event48'; 
		} else if (sQuizQuestionState.toLowerCase().indexOf("view") >= 0) {
			s.events = 'event50';			
			s.linkTrackEvents = 'event50'; 
		} else {
			s.events = '';
			s.linkTrackEvents = ''; 
			s.linkTrackVars = 'eVar38,eVar42,prop11,prop12';
		}
		s.tl(this, 'o', "Quiz - " + sQuizName + " - " + s.eVar42);
	} catch (Error) { }

}

/* *************************************************************************************************************	*/
/* FUNCTIONS - CBN Debug Tracking																				*/
/* *************************************************************************************************************	*/

function omTrackDebug(sContentType,sTrackingValue) {
	try {

	// used to log debugging information in Omniture

	// sContentType:
	//					Varies based on debugging implemented

	// standardize parameters
	var sTrackingParameter = sTrackingValue.toLowerCase();
	sTrackingValue = sTrackingValue.replace(/%20/gi, " ");
	var s = s_gi(s_account);
	s.eVar63 = "CBN - DEBUG - " + sContentType + " - " + sTrackingValue; 		// Debug Message
	s.linkTrackVars = 'eVar63';
	s.tl(this, 'o', s.eVar63);
	om_gaTrackKPI(s.eVar63);

	} catch (Error) { }
}

/* *************************************************************************************************************	*/
/* FUNCTIONS - Superbook Event Tracking																				*/
/* *************************************************************************************************************	*/

// functions for tracking superbook KPI click events


function getComment(sValue) {
	try {
		// extract comment from pipe separated value: "Value|CommentValue"
		aComment = sValue.split("|");
		if ( (isArray(aComment)) && (aComment.length==2) && (aComment[1] != "") ) {
			return unescape(aComment[1]);
		} else {
			return "";
		}
	} catch (Error) { }
}

function omStandardizeLanguage(sLanguage) {
	try {

		// standardize language string
		if ((sLanguage.toLowerCase() == "en") || (sLanguage.toLowerCase() == "english") || (sLanguage.toLowerCase() == "us-en") || (sLanguage.toLowerCase() == "superbook") || (sLanguage.toLowerCase() == "pre")) {
			sLanguage = "English";
		} else if ((sLanguage.toLowerCase() == "es") || (sLanguage.toLowerCase() == "espanol") || (sLanguage.toLowerCase() == "spanish") || (sLanguage.toLowerCase() == "superlibro")) {
			sLanguage = "Spanish";
		} else if ((sLanguage.toLowerCase() == "en-ph") || (sLanguage.toLowerCase() == "ph-en") || (sLanguage.toLowerCase() == "batangsuperbook")) {
			sLanguage = "Philippines";
		} else if ((sLanguage.toLowerCase() == "id") || (sLanguage.toLowerCase() == "superbookindo")) {
			sLanguage = "Indonesian";
		} else if ((sLanguage.toLowerCase() == "ar") || (sLanguage.toLowerCase() == "arabic")) {
			sLanguage = "Arabic";
		} else if ((sLanguage.toLowerCase() == "uk-en") || (sLanguage.toLowerCase() == "en-gb") || (sLanguage.toLowerCase() == "english - uk")) {
			sLanguage = "UK";
		} else if ((sLanguage.toLowerCase() == "zh-hans") || (sLanguage.toLowerCase() == "chinese, simplified")) {
			sLanguage = "Chinese Simplified";
		} else if ((sLanguage.toLowerCase() == "zh-hant") || (sLanguage.toLowerCase() == "chinese, traditional")) {
			sLanguage = "Chinese Traditional";
		} else if (sLanguage.toLowerCase() == "hk-en") {
			sLanguage = "Hong Kong";
		} else if ((sLanguage.toLowerCase() == "ru") || (sLanguage.toLowerCase() == "russian") || (sLanguage.toLowerCase() == "superkniga")) {
			sLanguage = "Russian";
		} else if ((sLanguage.toLowerCase() == "sq") || (sLanguage.toLowerCase() == "albanian")) {
			sLanguage = "Albanian";
		} else if ((sLanguage.toLowerCase() == "en-za") || (sLanguage.toLowerCase() == "za-en")) {
			sLanguage = "South Africa";
		} else if ((sLanguage.toLowerCase() == "th") || (sLanguage.toLowerCase() == "thai")) {
			sLanguage = "Thai";
		} else if ((sLanguage.toLowerCase() == "in-en") || (sLanguage.toLowerCase() == "en-in")) {
			sLanguage = "India";
		} else if ((sLanguage.toLowerCase() == "ta") || (sLanguage.toLowerCase() == "in-ta")) {
			sLanguage = "India";
		} else if ((sLanguage.toLowerCase() == "hi") || (sLanguage.toLowerCase() == "in-hi")) {
			sLanguage = "Hindi";
		} else if ((sLanguage.toLowerCase() == "te") || (sLanguage.toLowerCase() == "in-te")) {
			sLanguage = "India";
		} else if ((sLanguage.toLowerCase() == "fa") || (sLanguage.toLowerCase() == "farsi")) {
			sLanguage = "Farsi";
		} else if ((sLanguage.toLowerCase() == "fr") || (sLanguage.toLowerCase() == "french")) {
			sLanguage = "French";
		} else if ((sLanguage.toLowerCase() == "de") || (sLanguage.toLowerCase() == "superbuch") || (sLanguage.toLowerCase() == "german")) {
			sLanguage = "German";
		} else if ((sLanguage.toLowerCase() == "km") || (sLanguage.toLowerCase() == "kh") || (sLanguage.toLowerCase() == "khmer")) {
			sLanguage = "Khmer";
		} else if ((sLanguage.toLowerCase() == "pt-br") || (sLanguage.toLowerCase() == "br-pt") || (sLanguage.toLowerCase() == "br")) {
			sLanguage = "Portuguese";
		} else if ((sLanguage.toLowerCase() == "ua") || (sLanguage.toLowerCase() == "ukraine")) {
			sLanguage = "Ukranian";
		} else if ((sLanguage.toLowerCase() == "ng") || (sLanguage.toLowerCase() == "ng-en") || (sLanguage.toLowerCase() == "en-ng")) {
			sLanguage = "Nigeria";
		} else if ((sLanguage.toLowerCase() == "tr") || (sLanguage.toLowerCase() == "turkish") || (sLanguage.toLowerCase() == "superkitap")) {
			sLanguage = "Turkish";
		} else if ((sLanguage.toLowerCase() == "mn") || (sLanguage.toLowerCase() == "mongolian")) {
			sLanguage = "Mongolian";
		} else if ((sLanguage.toLowerCase() == "et") || (sLanguage.toLowerCase() == "estonian")) {
			sLanguage = "Estonian";
		} else if ((sLanguage.toLowerCase() == "he") || (sLanguage.toLowerCase() == "hebrew")) {
			sLanguage = "Hebrew";
		} else if ((sLanguage.toLowerCase() == "ne") || (sLanguage.toLowerCase() == "np") || (sLanguage.toLowerCase() == "nepali")) {
			sLanguage = "Nepali";
		} else if ((sLanguage.toLowerCase() == "ur") || (sLanguage.toLowerCase() == "urdu")) {
			sLanguage = "Urdu";
		} else if ((sLanguage.toLowerCase() == "hu") || (sLanguage.toLowerCase() == "hungarian")) {
			sLanguage = "Hungarian";
		} else if ((sLanguage.toLowerCase() == "bg") || (sLanguage.toLowerCase() == "bulgarian")) {
			sLanguage = "Bulgarian";
		} else if ((sLanguage.toLowerCase() == "hy") || (sLanguage.toLowerCase() == "armenian")) {
			sLanguage = "Armenian";
		} else if ((sLanguage.toLowerCase() == "bn") || (sLanguage.toLowerCase() == "bengali")) {
			sLanguage = "Bengali";
		} else if ((sLanguage.toLowerCase() == "it") || (sLanguage.toLowerCase() == "italian")) {
			sLanguage = "Italian";
		} else if ((sLanguage.toLowerCase() == "ko") || (sLanguage.toLowerCase() == "korean")) {
			sLanguage = "Korean";
		} else if ((sLanguage.toLowerCase() == "pl") || (sLanguage.toLowerCase() == "polish")) {
			sLanguage = "Polish";
		} else if ((sLanguage.toLowerCase() == "tl") || (sLanguage.toLowerCase() == "tagalog")) {
			sLanguage = "Tagalog";
		} else if ((sLanguage.toLowerCase() == "vi") || (sLanguage.toLowerCase() == "vietnamese")) {
			sLanguage = "Vietnamese";
		} else if ((sLanguage.toLowerCase() == "my") || (sLanguage.toLowerCase() == "burmese")) {
			sLanguage = "Burmese";
		} else if ((sLanguage.toLowerCase() == "sw") || (sLanguage.toLowerCase() == "kiswahili")) {
			sLanguage = "Kiswahili";
		} else if ((sLanguage.toLowerCase() == "ja") || (sLanguage.toLowerCase() == "japanese")) {
			sLanguage = "Japanese";
		} else if ((sLanguage.toLowerCase() == "ro") || (sLanguage.toLowerCase() == "romanian") || (sLanguage.toLowerCase() == "carteacartilor")  ) {
			sLanguage = "Romanian";
		}
		return sLanguage;
	} catch (Error) { }
}

function omTrackSuperbookPage(sTrackingValue,sLanguage) {
	try {
		// clean up pagename
		sTrackingValue = sTrackingValue.toLowerCase().replace(" ", "_").replace("'", "").replace("\"", "");
		sTrackingValue = sTrackingValue.replace("http://",""); 	// remove any http prefix
		sTrackingValue = sTrackingValue.replace("https://",""); // remove any https prefix
		sTrackingValue = sTrackingValue.replace(/(us-en|ph-en|id|id-en|ie|ar|ua-ru|zh-hans|zh-hant|hk-en|ru|za-en|uk-en|sq|th|in-en|in-hi|ta|hi|te|fa|fr|de|km|kh|pt-br|br|ua|ng|tr|mn|et|he|ne|np|ur|hu|hy|bn|it|ko|pl|vi|my|sw|ja|ro)\.superbook/,"superbook"); 		// remove language prefix
		sTrackingValue = sTrackingValue.replace(/(superlibro|superbookindo|superkniga|superkitap|carteacartilor|superbuch)\.tv/,"superbook.cbn.com"); 	// correctly handle variations
		// reset KPIs
		s.eVar30 = ""; s.prop30 = ""; s.prop39 = "";
		// set page name
		s.pageName = sTrackingValue;
		// remove any parameters or anchor tags
		if (sTrackingValue.indexOf("?") >=0) { sTrackingValue=sTrackingValue.substring(0,sTrackingValue.indexOf("?")) }
		if (sTrackingValue.indexOf("#") >=0) { sTrackingValue=sTrackingValue.substring(0,sTrackingValue.indexOf("#")) }
		// determine correct subsections
		s.channel = "superbook.cbn.com"; // main section
		s.hier1   = "superbook.cbn.com"; // main hierachy
		s.prop1   = "Value_Not_Set"; // sub-section
		s.prop2   = "Value_Not_Set"; // sub-section 2
		s.prop3   = "Value_Not_Set"; // sub-section 3
		s.eVar1	  = s.prop1;
		s.eVar2	  = s.prop2;
		s.eVar3	  = s.prop3;
		om_arr_sections = sTrackingValue.split("\/");
			if (isArray(om_arr_sections)) {
				// if (om_arr_sections.length > 0) {  s.eVar60 = om_arr_sections[0]; s.prop60 = s.eVar60; }
				if (om_arr_sections.length > 2) {  s.prop1 	= s.channel + "/" + om_arr_sections[1];	s.eVar1 = s.prop1; };
				if (om_arr_sections.length > 3) {  s.prop2 	= s.prop1 	+ "/" + om_arr_sections[2];	s.eVar2 = s.prop2; };
				if (om_arr_sections.length > 4) {  s.prop3 	= s.prop2 	+ "/" + om_arr_sections[3];	s.eVar3 = s.prop3; };
				s.hier1 = s.channel;
				//alert("Domain = " + s.eVar60 + "\nSection = " + s.channel + " \nSub-Section = " + s.prop1 + " \nSub-Section 2 = " + s.prop2 + " \nSub-Section 3 = " + s.prop3 + " \n " + s.pageName);
			}
		s.t();
	} catch (Error) { }

}

function omTrackBiblePage (sTrackingValue, sLanguage) {
	// wrapper - same as Superbook function
	try {
		omTrackSuperbookPage(sTrackingValue,sLanguage)
	} catch (Error) { }
}


function omTrackSuperbookDebug(sContentType,sTrackingValue,sLanguage) {
	try {

	// used to log debugging information in Omniture

	// sContentType:
	//					Varies based on debugging implemented

	// standardize language string
	sLanguage = omStandardizeLanguage(sLanguage);

	// standardize parameters
	var sTrackingParameter = sTrackingValue.toLowerCase();
	sTrackingValue = sTrackingValue.replace(/%20/gi, " ");
	var s = s_gi(s_account);
	s.eVar63 = "Superbook - DEBUG - " + sContentType + " - " + sTrackingValue + " - " + sLanguage; 		// KPI
	s.linkTrackVars = 'eVar63';
	s.tl(this, 'o', s.eVar63);
	om_gaTrackKPI(s.eVar63);

	} catch (Error) { }
}

function omTrackSuperbook(sContentType,sTrackingValue,sLanguage) {
try {

		// sContentType:
		//					Gospel PPT
		//					Superbook Video
		// sTrackingValue:
		//					View		  - view the gospel presentation (first slide)
		//					Ready		  - view the page after they clicked Yes, I am ready to pray
		//					Not Ready	  - view the submit a question page (form)
		//					Question	  - view the question submission page (filled in and submitted question form)
		//					Prayed		  - view the page after they click on Yes, I just prayed the prayer
		//					New			  - filled in and submitted response form and indicated new salvation
		//					Recommitment  - filled in and submitted response form and indicated recommitment
		//					Unknown		  - filled in and submitted response form and did not indicate a new salvation or recommitment
		//
		//
		// sContentType:
		//					Bible
		// sTrackingValue:
		//					Daily Devotional - Started
		//					Daily Devotional - Completed
		//					Daily Devotional  Completed Step N
		//					Viewed the Bible
		//					Viewed Character Profile - Chracter Name
		//					WordSearch Completed
		//					Viewed Question and Answer
		//
		// sContentType:
		//					Community
		// sTrackingValue:
		//					Registration			- registered on Superbook.TV
		//					Registration - Adult	- an adult registered on Superbook.TV
		//					Registration - Child	- an adult registered on Superbook.TV
		//					Login - [Language]		- logged in to Superbook.TV
		//					Awarded Badge			- awarded a badge (followed by badge name)
		//
		// sContentType:
		//					Episode Guide
		// sTrackingValue
		//					Viewed Character Profile - Profile_Title
		//					Viewed Video - Video_Title
		//					Viewed QnA - Question_Title
		//					Viewed Wallpaper - Wallpaper_Size - Wallpaper_Title
		// sContentType:
		//					Video Page
		// sTrackingValue
		//					Viewed Video - Video_Type Video_Title
		//					Changed Video - Video_Title

	// standardize language string
	sLanguage = omStandardizeLanguage(sLanguage);
	// standardize parameters
	var sTrackingParameter = sTrackingValue.toLowerCase();
	sTrackingValue = sTrackingValue.replace(/%20/gi, " ");
	//alert("Tracking: type=" + sContentType + ", value=" + sTrackingValue + ", language=" + sLanguage);
	//console.log("Tracking: type=" + sContentType + ", value=" + sTrackingValue + ", language=" + sLanguage);

	var s = s_gi(s_account);

	if (sContentType.toLowerCase() == "bible") {

			if (sTrackingParameter.indexOf("daily devotional") >= 0) {
				// Bible Discipleship - Daily Devotional Event
				s.eVar30 = "Discipleship - Superbook - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  			    				// site success pathing
				s.linkTrackVars = 'eVar30,prop39';

			} else if (sTrackingParameter.indexOf("viewed character profile") >= 0) {
				// Bible Discipleship - Viewed a Character Profile
				s.eVar30 = "Discipleship - Superbook - Bible - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30; 							  			    							// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else if (sTrackingParameter == "viewed the bible") {
				// Bible Discipleship - Viewed the Bible Event
				s.eVar30 = "Discipleship - Superbook - Bible - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  			    						// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else if (sTrackingParameter == "wordsearch completed") {
				// Bible Discipleship - Completed Word Search
				s.eVar30 = "Discipleship - Superbook - Bible - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30; 							  			    							// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else if (sTrackingParameter == "viewed question and answer") {
				// Bible Discipleship - Viewed Question and Answer
				s.eVar30 = "Discipleship - Superbook - Bible - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30; 							  			    							// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else {
				// Bible
				s.eVar30 = "Discipleship - Superbook - Bible - Unknown - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  			    									// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			}


	} else if (sContentType.toLowerCase() == "community") {

			if (sTrackingParameter == "registration") {
				// we have a successful superbook registration
				s.events = "event3"; 											// registration confirmation
				s.eVar30 = "Community - Superbook Registration - " + sLanguage;	// KPI
				s.prop39 = s.eVar30; 											// site success pathing
				s.linkTrackVars = 'eVar30,prop39,events';
				s.linkTrackEvents = 'event3';
			} else if (sTrackingParameter == "registration - adult") {
				// we have a successful superbook adult registration
				s.events = "event3"; 													// registration confirmation
				s.eVar30 = "Community - Superbook Registration - Adult - " + sLanguage;	// KPI
				s.prop39 = s.eVar30; 													// site success pathing
				s.linkTrackVars = 'eVar30,prop39,events';
				s.linkTrackEvents = 'event3';
			} else if (sTrackingParameter == "registration - child") {
				// we have a successful superbook child registration
				s.events = "event3"; 													// registration confirmation
				s.eVar30 = "Community - Superbook Registration - Child - " + sLanguage;	// KPI
				s.prop39 = s.eVar30; 													// site success pathing
				s.linkTrackVars = 'eVar30,prop39,events';
				s.linkTrackEvents = 'event3';
			} else if (sTrackingParameter.indexOf("awarded badge") >= 0) {
				// Community - Awarded Badge
				s.eVar30 = "Community - Superbook - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30; 					  			    							// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else if (sTrackingParameter.indexOf("login") >= 0) {
				// Community - Logged In
				s.eVar30 = "Community - Superbook - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30; 					  			    							// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else if (sTrackingParameter.indexOf("registration-step") >=0) {
				// we have a step in the registration sign up process
				s.eVar30 = "Community - Superbook - " + sTrackingValue.replace("Registration","Register") + " - " + sLanguage;	// KPI
				s.prop39 = s.eVar30; 													// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else {
				// Community
				s.eVar30 = "Community - Superbook - Unknown - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  			    						// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			}

	} else if ((sContentType.toLowerCase() == "gospel ppt") || (sContentType.toLowerCase() == "superbook video")) {

			if (sContentType.toLowerCase() == "superbook video") {
				sPresentationType = "Video - ";
			} else {
				sPresentationType = "";
		 	}		

			if ((sTrackingParameter == "view") || (sTrackingParameter == "evangelism - viewed gospel presentation")) {
				// Viewed Gospel Presentation
				s.eVar30 = "Evangelism - Viewed Gospel Presentation - Superbook - " + sPresentationType + sLanguage; 	// KPI
				s.events = "event14"; 																// gospel view event
				s.prop39 = "Evangelism - Viewed Gospel Presentation - Superbook - " + sPresentationType + sLanguage;	// site success pathing
				s.linkTrackVars = 'eVar30,prop39,events';
				s.linkTrackEvents = 'event14';

			} else if (sTrackingParameter == "ready") {
				// Presented with Salvation Prayer
				s.eVar30 = "Evangelism - Ready to Make Commitment - Superbook - " + sPresentationType + sLanguage; 		// KPI
				s.prop39 = "Evangelism - Ready to Make Commitment - Superbook - " + sPresentationType + sLanguage;	  	// site success pathing
				s.linkTrackVars = 'eVar30,prop39';

			} else if ((sTrackingParameter == "prayed") || (sTrackingParameter == "evangelism - prayed salvation prayer")) {
				// Prayed Salvation Prayer and Presented with Commitment Form
				s.eVar29 = "Evangelism - Superbook Commitment Form - " + sLanguage; 				// form type
				s.events = "event16,event41"; 														// form view + prayed
				s.eVar30 = "Evangelism - Prayed Salvation Prayer - Superbook - " + sPresentationType + sLanguage;
				s.prop39 = "Evangelism - Prayed Salvation Prayer - Superbook - " + sPresentationType + sLanguage;		// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event16,event41';

			} else if ((sTrackingParameter == "new") || (sTrackingParameter.indexOf("new|") == 0) || (sTrackingParameter == "evangelism - contacted us - new commitment")) {
				// Submitted form and indicated a new commitment
				s.eVar29 = "Evangelism - Superbook Commitment Form - " + sPresentationType + sLanguage; 				// form type
				s.events = "event15,event12,event42"; 																			// form success & new commitment events
				s.eVar30 = "Evangelism - Contacted Us - New Commitment - Superbook - " + sPresentationType + sLanguage;
				s.prop39 = "Evangelism - Contacted Us - Commitment - Superbook - " + sPresentationType + sLanguage;		// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event15,event12,event42';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("new|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="SBN_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}

			} else if ((sTrackingParameter == "recommitment") || (sTrackingParameter.indexOf("recommitment|") == 0) || (sTrackingParameter == "evangelism - contacted us - recommitment")) {
				// Submitted form and indicated a recommitment
				s.eVar29 = "Evangelism - Superbook Commitment Form - " + sPresentationType + sLanguage; 				// form type
				s.events = "event15,event13,event42"; 																			// form success and recommitment events
				s.eVar30 = "Evangelism - Contacted Us - Recommitment - Superbook - " + sPresentationType + sLanguage;	// KPI
				s.prop39 = "Evangelism - Contacted Us - Commitment - Superbook - " + sPresentationType + sLanguage;		// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event15,event13,event42';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("recommitment|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="SBR_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}

			} else if ((sTrackingParameter == "unknown") || (sTrackingParameter.indexOf("unknown|") == 0) || (sTrackingParameter == "evangelism - contacted us - unknown commitment")) {

				// Submitted form and didn't indicate the type of commitment
				s.eVar29 = "Evangelism - Superbook Commitment Form - " + sPresentationType + sLanguage; 					// form type
				s.events = "event15,event13,event42"; 															// form success and recommitment events
				s.eVar30 = "Evangelism - Contacted Us - Unknown Commitment - Superbook - " + sPresentationType + sLanguage; // KPI
				s.prop39 = "Evangelism - Contacted Us - Commitment - Superbook - " + sPresentationType + sLanguage;			// site success pathing
				s.linkTrackVars = 'eVar29,eVar30,prop39,events';
				s.linkTrackEvents = 'event15,event13,event42';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("unknown|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="SBU_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}

			} else if ((sTrackingParameter == "not ready") || (sTrackingParameter = "evangelism - not ready to make commitment")) {
				// Not Ready and Presented with Question Form
				s.eVar29 = "Evangelism - Superbook Questions Form - " + sPresentationType + sLanguage;					// form type
				s.events = "event16"; 																// form view
				s.eVar30 = "Evangelism - Not Ready to Make Commitment - Superbook - " + sPresentationType + sLanguage;	// KPI
				s.prop39 = "Evangelism - Not Ready to Make Commitment - Superbook - " + sPresentationType + sLanguage;	// site success pathing
				s.linkTrackVars = 'eVar30,eVar29, prop39,events';
				s.linkTrackEvents = 'event16';

			} else if ((sTrackingParameter == "question") || (sTrackingParameter.indexOf("question|") == 0) || (sTrackingParameter == "evangelism - contacted us - asked question")) {
				// Not Ready and Submitted Question
				s.eVar29 = "Evangelism - Superbook Questions Form - " + sPresentationType + sLanguage;					// form type
				s.events = "event15"; 																// form success
				s.eVar30 = "Evangelism - Contacted Us - Asked Question - Superbook - " + sPresentationType + sLanguage;
				s.prop39 = "Evangelism - Contacted Us - Asked Question - Superbook - " + sPresentationType + sLanguage;	// site success pathing
				s.linkTrackVars = 'eVar30,eVar29,prop39,events';
				s.linkTrackEvents = 'event15';
				// do we need to log a comment?
				if (sTrackingParameter.indexOf("question|") == 0) {
					// extract comment
					sCommentValue = getComment(sTrackingParameter);
					if (sCommentValue != "") {
						s.eVar41="SBQ_" + sCommentValue;
						s.linkTrackVars = s.linkTrackVars + ",eVar41";
					}
				}
			} else {
				// Evangelism
				s.eVar30 = "Evangelism - Superbook - Unknown - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  			    						// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			}

	   } else if (sContentType.toLowerCase() == "video page") {

			if (sTrackingParameter.indexOf("viewed video") >= 0) {
				s.eVar30 = "Community - Superbook - Video Page - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30; 							   												// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else if (sTrackingParameter.indexOf("changed video") >= 0) {
				// do not track
			} else {
				s.eVar30 = "Community - Superbook - Video Page - Unknown - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  					    							// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			}

		 } else if (sContentType.toLowerCase() == "episode guide") {

			if ( (sTrackingParameter.indexOf("viewed character profile") >= 0) ||  (sTrackingParameter.indexOf("viewed video") >= 0) ||  (sTrackingParameter.indexOf("viewed qna") >= 0) ||  (sTrackingParameter.indexOf("viewed wallpaper") >= 0)){
				s.eVar30 = "Discipleship - Superbook - Episode Guide - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30; 							  			    									// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			} else {
				s.eVar30 = "Discipleship - Superbook - Episode Guide - Unknown - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  					    									// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
			}

		} else {
				// Unknown
				s.eVar30 = "Superbook - Unknown - " + sContentType + " - " + sTrackingValue + " - " + sLanguage; 		// KPI
				s.prop39 = s.eVar30;								  							    					// site success pathing
				s.linkTrackVars = 'eVar30,prop39';
	  }
	  s.tl(this, 'o', s.eVar30);
	  om_gaTrackKPI(s.eVar30);

	} catch (Error) { }
}

/* ******************************************************************	*/
/* INLINE - Superbook Logged In Status									*/
/* ******************************************************************	*/
try {
	// do we have a value for loggedin
	if ((typeof (loggedIn) != "undefined") && (typeof(loggedIn) == "boolean")) {
		s.eVar64 = loggedIn.toString();
		s.prop64 = s.eVar64;
	}
} catch (Error) { }

/* ******************************************************************	*/
/* FUNCTIONS - Superbook Hostname Check									*/
/* ******************************************************************	*/

function checkSuperbookDomain(sDomainName) {

	if (
		(sDomainName.indexOf(".superbook.cbn.com") >= 0) 	||
		(sDomainName.indexOf("superbookkids.com") >= 0) 	||
		(sDomainName.indexOf(".superbook.tv") >= 0) 		||
		(sDomainName.indexOf("sb.cbn.com") >= 0) 			||
		(sDomainName.indexOf("superlibro.tv") >= 0) 		||
		(sDomainName.indexOf("superbuch.tv") >= 0) 			||
		(sDomainName.indexOf("superkniga.tv") >= 0) 		||
		(sDomainName.indexOf("superkitap.tv") >= 0) 		||
		(sDomainName.indexOf("superbookindo.tv") >= 0) 		||
		(sDomainName.indexOf("carteacartilor.tv") >= 0) 	||
		(sDomainName.indexOf("superbook.dev.cbn.local") >= 0) ||
		(sDomainName.indexOf("superbookdev") >= 0)
	) {
		return true;
	} else {
		return false;
	}
}

/* ******************************************************************	*/
/* INLINE - Returning Status											*/
/* ******************************************************************	*/
try {
	bOm_ReturningDnr = false;
	sOm_ReturningDnr = om_getCookie("cbnod");
	if ( (typeof (sOm_ReturningDnr) != "undefined") && (sOm_ReturningDnr == "1")) {
		bOm_ReturningDnr = true;
	}
} catch (Error) { }


/* ******************************************************************	*/
/* INLINE - Referring Page												*/
/* ******************************************************************	*/
try {

	// set the full referring page
	if (document.referrer) { 
        s.prop69 = document.referrer.toLowerCase();
    }

} catch (Error) { }


/* ******************************************************************	*/
/* INLINE: Page Related Variables										*/
/* ******************************************************************	*/

try {

	/* ******************************************************************	*/
	/* INLINE: Page Name													*/
	/* ******************************************************************	*/

	// ensure all page names are not case sensitive
	var om_CurrentURL = sOm_strHref;

	// set the full path
	s.prop14 = om_CurrentURL;  // Full Path

	// get the elements of the URL
	om_URL = parseUrl(om_CurrentURL);
	// do we need to modify the url and reparse it? Needed for sub-domains that do not use pagenames or indicate directories using /
	if (om_URL.host.indexOf("m.cbn.com") >= 0)  {
		if ((!om_URL.file || om_URL.file == "") && (om_CurrentURL.charAt(om_CurrentURL.length - 1) != "/")) {
			om_URL = parseUrl(om_CurrentURL + "/"); // enables the m.cbn.com pages to be parsed correctly
		}
	} else if (om_URL.host.indexOf("bible.cbn.com") >= 0) {
		om_URL = parseUrl(om_CurrentURL.replace("/#!","") + "/"); // enables the bible.cbn.com ajax referenced pages to be parsed correctly
	} else if ( checkSuperbookDomain(om_URL.host) || (om_reg_domains_nonaspx.test(om_URL.host) == true)) {        

		// create well formed URLs for Superbook, stories.cbn.com and other non aspx domains
		if (om_CurrentURL.indexOf(".php")<=0) {
			om_CurrentURL_param = om_CurrentURL.indexOf("?");
			om_CurrentURL_hash = om_CurrentURL.indexOf("#");
			if ((om_CurrentURL_param == -1) && (om_CurrentURL_hash == -1)) {
				om_URL = parseUrl(om_CurrentURL + "/");
			} else if (om_CurrentURL_param == -1) {
				om_URL = parseUrl(om_CurrentURL.replace("#","/#"));
			} else {
				om_URL = parseUrl(om_CurrentURL.replace("#","").replace("?","/?"));
			}
		}
	}


	// host domain name and determine if we need to modify the host url
	if (checkSuperbookDomain(om_URL.host) || (om_CurrentURL.indexOf("/superbook/pages/") >= 0) ) {
		// store sub-domain or original host
		if (om_URL.host == "ru.superbook.cbn.com") {
            // switch from superkniga.tv to ru.superbook.cbn.com
			s.eVar60 = "superkniga.tv";
			s.prop60 = "superkniga.tv";
		} else if (om_URL.host == "carteacartilor.tv") {
            // switch from ro.superbook.cbn.com to carteacartilor.tv
			s.eVar60 = "ro.superbook.cbn.com";
			s.prop60 = "ro.superbook.cbn.com";
		} else {
			s.eVar60 = om_URL.host;
			s.prop60 = om_URL.host;
		}
		// map to new host name
		om_URL.host = "superbook.cbn.com";
	} else {
		s.eVar60 = om_URL.host;
		s.prop60 = om_URL.host;
	}

	// determine the default filename if none was specified
	if (!om_URL.file || om_URL.file == "") {
		if ((om_URL.host.indexOf("biblestudy.cbn") >= 0) || (om_URL.host.indexOf("event.cbn") >= 0)) {
			om_URL.file = "default.aspx";
		} else if (om_reg_domains_nonaspx.test(om_URL.host) == true) {
			om_URL.file = ".";
		} else if (om_URL.host.indexOf("search.cbn") >= 0) {
			om_URL.file = "search";
		} else 	{
			om_URL.file = "index.aspx";
		}
	}

	// do we need to append any of the parameters to make the pagename unique i.e. CBN TV, CBN Radio, Contact Forms, Superbook Q&A
	// or set the filename if a video was viewed
	var om_Parameters = "";
	var sParamValue = "";
	if (om_CurrentURL.indexOf("/tv/") >= 0) {
		// new video section
		sParamValue = getURLParam("search");
		if (sParamValue != "") {
			om_Parameters = appendParameter(om_Parameters, "search", sParamValue);
			// also add the keyword identifier parameter as this is used to differentiate between general searches and keyword searches
			sParamValue = getURLParam("t");
			if (sParamValue != "") {
				om_Parameters = appendParameter(om_Parameters, "t", sParamValue);
			}
		} else {
			// did they request a video
			var video_re = new RegExp(/\/\d+/);
		  	var video_m = video_re.exec(om_CurrentURL);
	  		if (video_m != null) {
				// have a unique video ID - set the filename to the video ID
				var sVideoID = video_m.toString().replace("/","");
				om_URL.file = sVideoID;
		    }
		}
	} else if (om_CurrentURL.indexOf("media") >= 0) {
        if (om_CurrentURL.indexOf("radio") < 0) {
            // legacy video player
            sParamValue = getURLParam("s");
            if (sParamValue != "") {
                // they have requested a specific video
                om_Parameters = appendParameter(om_Parameters, "s", sParamValue);
            } else {
                // have they requested a specific search
                sParamValue = getURLParam("search");
                if (sParamValue != "") {
                    om_Parameters = appendParameter(om_Parameters, "search", sParamValue);
                }
                // also add the keyword identifier parameter as this is used to differentiate between general searches and keyword searches
                sParamValue = getURLParam("t");
                if (sParamValue != "") {
                    om_Parameters = appendParameter(om_Parameters, "t", sParamValue);
                }
            }
        } else {
            // radio
            sParamValue = getURLParam("station");
            if (sParamValue != "") {
                om_Parameters = appendParameter(om_Parameters, "station", sParamValue);
            }
            sParamValue = getURLParam("popup");
            if (sParamValue != "") {
                om_Parameters = appendParameter(om_Parameters, "popup", sParamValue);
            }
        }
	} else if ((om_CurrentURL.indexOf("radio.aspx") >= 0) && (om_CurrentURL.indexOf("superbook_radio.aspx") < 0)) {
		// determine what station they are listening to
		if (om_CurrentURL.indexOf("?cbnradio") >= 0) {
			om_Parameters = "?cbnradio";
		} else if (om_CurrentURL.indexOf("?seasonal") >= 0) {
			om_Parameters = "?seasonal";
		} else if (om_CurrentURL.indexOf("?news") >= 0) {
			om_Parameters = "?news";
		} else if (om_CurrentURL.indexOf("gospel") >= 0) {
			om_Parameters = "?gospel";
		} else if (om_CurrentURL.indexOf("praise") >= 0) {
			om_Parameters = "?praise";
		} else if (om_CurrentURL.indexOf("superbook") >= 0) {
			om_Parameters = "?superbook";
		} else {
			om_Parameters = "?cbnradio";  // default station is CBN Radio
		}
	} else if (om_CurrentURL.indexOf("contact") >= 0) {
		sParamValue = getURLParam("topic");
		if (sParamValue != "") {
			// they have requested a specific prayer topic
			om_Parameters = appendParameter(om_Parameters, "topic", sParamValue);
		}
	} else if (om_CurrentURL.indexOf("event") >= 0) {
		sParamValue = getURLParam("eventid");
		if (sParamValue != "") {
			// they have requested a specific event video
			om_Parameters = appendParameter(om_Parameters, "eventid", sParamValue);
		}
	} else if (om_CurrentURL.indexOf("/stepstopeace/topics.aspx") >= 0) {
		sParamValue = getURLParam("t");
		if (sParamValue != "") {
			// they are viewing a topic presentation
			om_Parameters = appendParameter(om_Parameters, "t", sParamValue);
		}
	} else if ((om_CurrentURL.indexOf("option.aspx") >= 0) || (om_CurrentURL.indexOf("contribute.aspx") >= 0)) {
		sParamValue = getURLParam("o");
		if (sParamValue != "") {
			// add the o parameter
			om_Parameters = appendParameter(om_Parameters, "o", sParamValue);
		} else if ((om_CurrentURL.indexOf("/700club/option.aspx") >= 0) || (om_CurrentURL.indexOf("/700club/contribute.aspx") >= 0)) {
			// add an o=1 parameter to the 700 Club option form a no o value is specified to keep page names consistent
			sParamValue = "1";
			om_Parameters = appendParameter(om_Parameters, "o", sParamValue);
		}
	} else if (om_CurrentURL.indexOf("superbook_print_questions_answers.aspx") >= 0) {
		sParamValue = getURLParam("q");
		if (sParamValue != "") {
			// they have requested a specific question to be printed
			om_Parameters = appendParameter(om_Parameters, "q", sParamValue);
		}
	} else if (om_CurrentURL.indexOf("livingbythebook_remotepage.aspx") >= 0) {
		sParamValue = getURLParam("remotepage");
		if (sParamValue != "") {
			// they have requested a specific living by the book course
			// tidy up the value
			sParamValue = sParamValue.toLowerCase().replace("/livingbythebook/display.php?", "");
			// shorten page url
			om_URL.file = om_URL.file.replace("livingbythebook_remotepage.aspx", "");
			om_Parameters = appendParameter(om_Parameters, "r", sParamValue);
		}
	} else if (om_URL.host == "superbook.cbn.com") {
			sParamValue = getURLParam("q");
			if (sParamValue != "") {
				// they have requested a specific question
				om_Parameters = appendParameter(om_Parameters, "q", sParamValue);
			}
			if (om_CurrentURL.indexOf("/a/game") >= 0) {
				sParamValue = getURLParam("id");
				if (sParamValue != "") {
					// they are playing a specific game
					om_Parameters = appendParameter(om_Parameters, "id", sParamValue);
				}
			}
		}
	s.pageName = om_URL.host + om_URL.path + om_URL.file + om_Parameters;

	/* ******************************************************************	*/
	/* INLINE: Set Page Title													*/
	/* ******************************************************************	*/
	s.prop27 = sOm_strPageTitle + " _ " + sOm_strHref_Orig;
	s.prop61 = sOm_strPageTitle; // pageview
	s.eVar61 = sOm_strPageTitle; // pageview
	s.eVar62 = sOm_strPageTitle; // visit

	/* ******************************************************************	*/
	/* INLINE: 404	Pages														*/
	/* ******************************************************************	*/

	if ((s.pageName.indexOf("four0four") >= 0) || (s.pageName.indexOf("pagenotfound") >= 0)) {
		// 404 Pages
		s.pageName = "404:" + s.prop14; // add the full path as we need to keep all parameters
		s.pageType = "errorPage";
	}

	/* ******************************************************************	*/
	/* INLINE: Search Queries													*/
	/* ******************************************************************	*/

	if ((s.pageName.indexOf("search.cbn.com") >=0) || (s.pageName.indexOf("/sitesearch/") >= 0)) {
		// Internal searches - extract the search term
		s.prop7 = getURLParam('q');
		//var e = /search\?q=([^&]*)&/;
		//if (s.pageName.match(e)) {
		//s.prop7 = RegExp.$1;
	} else if ((s.pageName.indexOf("/cbn-search") >= 0) || (s.pageName.indexOf("/cbn-video-search") >= 0)) {
		// Internal searches on new CBN.com site - extract the search term and the type of search
		s.prop7 = getURLParam('search_term');
		s.prop71 = getURLParam('site');

	} else if (s.pageName.indexOf("shop.cbn.com") >= 0) {
		// Internal searches on Shop CBN - extract the search term
		s.prop7 = getURLParam('Criteria');
	}

	/* ******************************************************************	*/
	/* INLINE: Determine Channel and Sections									*/
	/* ******************************************************************	*/
	// set default values
	s.channel = "Value_Not_Set"; // main section
	s.prop1   = "Value_Not_Set"; // sub-section
	s.prop2   = "Value_Not_Set"; // sub-section 2
	s.prop3   = "Value_Not_Set"; // sub-section 3
	s.hier1   = "Value_Not_Set"; // main hierachy


	// split the path to determine the sections
	if (om_URL.path) {

		// handle sub domains
		om_bSubdomain = false;
		if (om_reg_subdomains.test(om_URL.host)) {
			om_bSubdomain = true;
			// shop cbn and parable should be the same top level channel
			if (om_URL.host.indexOf("parable") >= 0) {
				s.channel = "shop.cbn.com";
			} else {
				s.channel = om_URL.host; // the top level channel is to be the subdomain (not first level directories or root pages like with cbn.com)
			}
		}
		if (om_URL.path == "/") {
			// this is a top level page in the root
			if (!om_bSubdomain) {
				s.channel = om_URL.host + "/" + om_URL.file;
			} else {
				s.prop1 = om_URL.host + "/" + om_URL.file;
			}
		} else {
			// retrieve all directories/sections
			om_arr_sections = om_URL.path.split("\/");
			if (isArray(om_arr_sections)) {
				// assign the channel variable for cbn.com and the prop1 variable for all sub-domains
				if (om_arr_sections.length > 1) {
					if (om_arr_sections[1] != "") {
						if (!om_bSubdomain) {
							s.channel = om_URL.host + "/" + om_arr_sections[1];
						} else {
							s.prop1 = om_URL.host + "/" + om_arr_sections[1];
							// if this is the blogs sub domain we also need to reclassify the blogs channel according to news blogs or cbn blogs
							if (om_URL.host.indexOf("blogs") >= 0) {
								switch (om_arr_sections[1]) {
									case "jerusalemdateline":
									case "thebrodyfile":
									case "africamatters":
									case "beltwaybuzz":
									case "stakelbeckonterror":
									case "hurdontheweb":
									case "bootsontheground":
									case "healthenews":
										s.channel = om_URL.host + "/cbnnews";
										break;
									default:
										s.channel = om_URL.host + "/cbn";
								}
							}
						}
					}
				}
				// assign the prop1 variable for cbn.com and the prop2 variable for all sub-domains
				if (om_arr_sections.length > 2) {
					if (om_arr_sections[2] != "") {
						if (!om_bSubdomain) {
							s.prop1 = om_URL.host + "/" + om_arr_sections[1] + "/" + om_arr_sections[2];
						} else {
							s.prop2 = om_URL.host + "/" + om_arr_sections[1] + "/" + om_arr_sections[2];
						}
					}
				}
				// assign the prop2 variable for cbn.com and the prop3 variable for all sub-domains
				if (om_arr_sections.length > 3) {
					if (om_arr_sections[3] != "") {
						if (!om_bSubdomain) {
							s.prop2 = om_URL.host + "/" + om_arr_sections[1] + "/" + om_arr_sections[2] + "/" + om_arr_sections[3];
						} else {
							s.prop3 = om_URL.host + "/" + om_arr_sections[1] + "/" + om_arr_sections[2] + "/" + om_arr_sections[3];
						}
					}
				}
				// assign the prop3 variable for cbn.com
				if (om_arr_sections.length > 4) {
					if (om_arr_sections[4] != "") {
						if (!om_bSubdomain) {
							s.prop3 = om_URL.host + "/" + om_arr_sections[1] + "/" + om_arr_sections[2] + "/" + om_arr_sections[3] + "/" + om_arr_sections[4];
						}
					}
				}
			}
		}
		s.hier1 = s.channel;
	}

	/* ******************************************************************	*/
	/* INLINE: Determine Content Types and key KPI pages					*/
	/* ******************************************************************	*/

	if ((s.pageName.indexOf("/christiancourses/goodshepherd/gs_foundations") >= 0) || (s.pageName.indexOf("/course/foundations-of-our-faith/") >= 0)) {
		s.prop4 = "Discipleship Course";
		s.prop5 = "Discipleship Course - OGS - Foundations of the Faith";
		s.eVar30 = "Discipleship - Viewed Course Page - OGS - Foundations";
	}
	else if ((s.pageName.indexOf("/christiancourses/goodshepherd/gs_holyspirit") >= 0) || (s.pageName.indexOf("/course/the-holy-spirit/") >= 0)) {
		s.prop4 = "Discipleship Course";
		s.prop5 = "Discipleship Course - OGS - The Holy Spirit";
		s.eVar30 = "Discipleship - Viewed Course Page - OGS - The Holy Spirit";
	}
	else if ((s.pageName.indexOf("/christiancourses/goodshepherd/gs_jesus") >= 0) || (s.pageName.indexOf("/course/who-jesus-is/") >= 0)) {
		s.prop4 = "Discipleship Course";
		s.prop5 = "Discipleship Course - OGS - Who Jesus Is";
		s.eVar30 = "Discipleship - Viewed Course Page - OGS - Who Jesus Is";
	}
	else if ((s.pageName.indexOf("/christiancourses/goodshepherd/gs_how_to_study_the_bible") >= 0) || (s.pageName.indexOf("/course/how-to-study-the-bible/") >= 0)) {
		s.prop4 = "Discipleship Course";
		s.prop5 = "Discipleship Course - OGS - How to Study the Bible";
		s.eVar30 = "Discipleship - Viewed Course Page - OGS - How to Study the Bible";
	}
	else if ((s.pageName.indexOf("/christiancourses/goodshepherd/gs_johnsgospel") >= 0) || (s.pageName.indexOf("/course/exploring-johns-gospel/") >= 0)) {
		s.prop4 = "Discipleship Course";
		s.prop5 = "Discipleship Course - OGS - Johns Gospel";
		s.eVar30 = "Discipleship - Viewed Course Page - OGS - Johns Gospel";
	}
	else if ((s.pageName.indexOf("/grow/index.aspx") >= 0) || (s.pageName.indexOf("/grow/.") >= 0)) {
		s.prop4 = "Discipleship Page";
		s.prop5 = "Discipleship Page - Grow";
		s.eVar30 = "Discipleship - Viewed Page - Grow";
	}
	else if ((s.pageName.indexOf("/spirituallife/biblestudyandtheology/discipleship/steps_for_new_believers") >= 0) || (s.pageName.indexOf("/teachingsheets/steps-for-new-believers-in-jesus-christ") >= 0)) {
		s.prop4 = "Discipleship Page";
		s.prop5 = "Discipleship Page - Steps for New Believers";
		s.eVar30 = "Discipleship - Viewed Page - Steps for New Believers";
	}
	else if ((s.pageName.indexOf("/grow/a_new_day") >= 0) || (s.pageName.indexOf("/a-new-day") >= 0)) {
		s.prop4 = "Discipleship Page";
		s.prop5 = "Discipleship Page - A New Day";
		s.eVar30 = "Discipleship - Viewed Page - A New Day";
	}
	else if (s.pageName.indexOf("/community/livingbythebook/finances/") >= 0) {
		s.prop4 = "Discipleship Course";
		s.prop5 = "Discipleship Course - LBTB - Finances";
	}
	else if (s.pageName.indexOf("/spirituallife/christiancourses/livingbythebook/livingbythebook_remotepage") >= 0) {
		s.prop4 = "Discipleship Course";
		s.prop5 = "Discipleship Course - LBTB - Course";
	}
	else if ((s.pageName.indexOf("/spirituallife/cbnteachingsheets/") >= 0) && (s.pageName.indexOf("/spirituallife/cbnteachingsheets/index.aspx") < 0)) {
		s.prop4 = "Discipleship Material";
		s.prop5 = "Discipleship Material - Teaching Sheet";
	}
	else if ((s.pageName.indexOf("/spirituallife/200questions/") >= 0) && (s.pageName.indexOf("/spirituallife/200questions/index.aspx") < 0)) {
		s.prop4 = "Discipleship Material";
		s.prop5 = "Discipleship Material - 200 Questions";
	}
	else if ((s.pageName.indexOf("/spirituallife/devotions/") >= 0) && (s.pageName.indexOf("/spirituallife/devotions/index.aspx") < 0)) {
		s.prop4 = "Discipleship Material";
		s.prop5 = "Discipleship Material - Devotion";
	}
	else if (s.pageName.indexOf("/spirituallife/shareyourfaith/") >= 0) {
		s.prop4 = "Discipleship Resources";
		s.prop5 = "Discipleship Resources - Share Your Faith";
	}
	else if ((s.pageName.indexOf("/giving/") >= 0) && (omNonDonation != "true") && ((s.pageName.indexOf("option.aspx") >= 0) || (s.pageName.indexOf("contribute.aspx") >= 0) || (s.pageName.indexOf("/beyondgrave.aspx") >= 0) || (s.pageName.indexOf("/wells.aspx") >= 0) )) {
		s.prop4 = "Donation - Donation Form";
		s.prop5 = "Donation - Donation Form";
		s.eVar29 = "Donation - Donation Form"; 							// form type
		s.events = "event16"; 											// form view
		s.prop39 = s.pageName; 											// for sitesection success pathing
	}
	else if ((s.pageName.indexOf("/giving/") >= 0) && (s.pageName.indexOf("confirm") >= 0) && (omNonDonation != "true")) {
		s.prop4 = "Donation - Confirmation Page";
		s.prop5 = "Donation - Confirmation Page";
		s.eVar29 = "Donation - Donation Form"; 							// form type
		s.events = "event15"; 											// form submit
		s.prop39 = s.pageName; 											// for sitesection success pathing
	}
	else if ((s.pageName.indexOf("/giving/") >= 0) && (s.pageName.indexOf("receipt") >= 0) && (omNonDonation != "true")) {
		s.prop4 = "Donation - Receipt Page";
		s.prop5 = "Donation - Receipt Page";
		s.events = "event24"; 											// donation
		s.prop39 = s.pageName; 											// for sitesection success pathing
		s.eVar30 = "Development - Donation";							// KPI
	}
	else if (s.pageName.indexOf("/community/af/confirmemail.aspx") >= 0) {
		s.events = "event3"; 											// registration confirmation
		s.prop39 = s.pageName; 											// for sitesection success pathing
		s.eVar30 = "Community - Registration Validation";	  			// KPI
	}

	/* ******************************************************************	*/
	/* INLINE - Track Content Keywords										*/
	/* ******************************************************************	*/
	if (typeof (sOm_ContentKeywords) == "undefined") {
		sOm_ContentKeywords = "";
	}
	// add directory information
	if (isArray(om_arr_sections)) {
		for (var om_iKeywordPath = 0; om_iKeywordPath < om_arr_sections.length; om_iKeywordPath++) {
			if (om_arr_sections[om_iKeywordPath] != "") {
				if (sOm_ContentKeywords == "") {
					sOm_ContentKeywords = om_arr_sections[om_iKeywordPath];
				} else {
					sOm_ContentKeywords = sOm_ContentKeywords + ", " + om_arr_sections[om_iKeywordPath];
				}
			}
		}
	}
	s.prop52 = sOm_ContentKeywords;
	s.eVar52 = s.prop52;

} catch (Error) { }


/* ******************************************************************	*/
/* INLINE: Handle Donations -- variables set on receipt page			*/
/* ******************************************************************	*/

try {
	if ((typeof(om_bDonation) != "undefined") && (om_bDonation == "true") && (typeof(om_sTransactionID) != "undefined") && (om_sTransactionID != "")) {
        
        // supress duplicate calls   
        sOm_don_tid = om_getCookie("don_tid");
        if ((typeof (sOm_don_tid) == "undefined") || (sOm_don_tid != om_sTransactionID)) {
            if ((om_sMonthlyPledge == "Y") || (om_sSinglePledge == "Y")) {
                try{
                    // ga commerce library
                    ga('require', 'ecommerce');   // Load the ecommerce plug-in.
                } catch (err) { }

                // set google donation amount
                ga_donationAmount = 0;
                // set T&T product list
                om_sTT_Products = "";
                // set FB product list
                om_sFB_Products = "";

                // modify donation detail - all large values need comma separator removed
                om_sDonationDetail = om_sDonationDetail.replace(/([^\|]\d+),(?=\d{3}\.\d{2}\D)/g, "$1");
                // modify donation detail - remove additional fraction values
                om_sDonationDetail = om_sDonationDetail.replace(/(\.\d{2})\d\d/g, "$1");
                // modify donation detail - replace | separators with a - separator for multiple order quantity of products (flag pins, continuity)
                om_sDonationDetail = om_sDonationDetail.replace(/([^\|,]\|[^\|,]+)\|(\d)/g, "$1-$2");
                om_sDonationDetail = om_sDonationDetail.replace(/^([^|,]+)\|(\d)/g, "$1-$2");

                // retrieve list of donations
                om_arr_donations = om_sDonationDetail.replace(/\|/g,",").split(",");
                if (isArray(om_arr_donations)) {
                    // our donation form has 3 comma separated items for each donation - loop through each donation
                    for (om_di=0; om_di<om_arr_donations.length; om_di=om_di+3) {
                        // reset donation amount
                        om_donationAmount = 0;
                        // do we have valid donation amounts
                        if (!isNaN(om_arr_donations[1 + om_di])) {
                            om_donationAmount = om_donationAmount + parseFloat(om_arr_donations[1 + om_di]);
                            // is the donation less than $30,000
                            if (om_donationAmount < 30000) {
                                // create the omniture products string
                                if (!s.products) {
                                    // ensure not equal to undefined
                                    s.products = "";
                                } else if (s.products != "") {
                                    // ensure list of different donations is comma separated
                                    s.products = s.products + ",";
                                }
                                if (om_sMonthlyPledge == "Y") {
                                        s.products = s.products + "Donation;" + om_arr_donations[om_di] + "_" + om_arr_donations[om_di + 2] + ";;;event20=" + om_donationAmount;
                                }
                                else if (om_sSinglePledge == "Y") {
                                    s.products = s.products + "Donation;" + om_arr_donations[om_di] + "_" + om_arr_donations[om_di + 2] + ";;;event19=" + om_donationAmount;
                                    // s.products=Pledge;Cause 1;;;event19=20,Pledge;Cause 2;;;event19=40,Pledge;Cause 3;;;event19=5
                                }
                                // Google Item Tracking
                                try{

                                    ga('ecommerce:addItem', {
                                      'id': om_sTransactionID,                     							// Transaction ID. Required
                                      'name': om_arr_donations[om_di],										// Product name. Required
                                      'sku': om_arr_donations[om_di] + '_' + om_arr_donations[om_di + 2],  	// SKU/code
                                      'category': om_arr_donations[om_di + 2],						       	// Category or variation
                                      'price': om_donationAmount,                							// Unit price
                                      'quantity': '1'                   									// Quantity
                                    });

                                    // track total
                                    if(om_arr_donations[om_di].toLowerCase().indexOf("mp") >=0) {
                                        ga_donationAmount = ga_donationAmount + (om_donationAmount * 12);
                                    } else {
                                        ga_donationAmount = ga_donationAmount + om_donationAmount;
                                    }
                                } catch (err) { }
                                // End Google Item Tracking
                                // T&T Item Tracking and FB Item Tracking
                                if (om_sTT_Products == "") {
                                    om_sTT_Products = om_arr_donations[om_di] + '_' + om_arr_donations[om_di + 2];
                                    om_sFB_Products = om_arr_donations[om_di];
                                } else {
                                    om_sTT_Products = om_arr_donations[om_di] + '_' + om_arr_donations[om_di + 2] + "," + om_sTT_Products;
                                    om_sFB_Products = om_arr_donations[om_di] + "," + om_sFB_Products;
                                }
                                // End T&T Item Tracking and FB Item Tracking
                            }
                        }
                    }
                    // s.prop26 = Club Level
                    if (om_sMonthlyPledge == "Y") {
                        s.prop25 = "Monthly Donation";
                        if ((s.events) && (s.events!="")) {
                            s.events = s.events + ",event20";
                        } else {
                            s.events = "event20";
                        }

                    } else if (om_sSinglePledge == "Y") {
                        s.prop25 = "Single Payment Donation";
                        if ((s.events) && (s.events!="")) {
                            s.events = s.events + ",event19";
                        } else {
                            s.events = "event19";
                        }
                    }
                    // Log the Transaction ID to prevent duplication of data on page refreshes
                    s.purchaseID = om_sTransactionID;
                    if ((s.events) && (s.events != "")) {
                        s.events = s.events + ",purchase";
                    } else {
                        s.events = "purchase";
                    }

                    // Google Order Tracking
                    try {
                        // determine correct order total to use
                        if (typeof(tt_sDonationTotal) != "undefined") {
                            if (tt_sDonationTotal > ga_donationAmount) {
                                ga_donationAmount = tt_sDonationTotal;
                            }
                        }

                        ga('ecommerce:addTransaction', {
                          'id': om_sTransactionID,                    // Transaction ID. Required
                          'affiliation': '',   						  // Affiliation or store name
                          'revenue': ga_donationAmount,               // Grand Total
                          'shipping': '',			                  // Shipping
                          'tax': ''				                      // Tax
                        });

                        ga('ecommerce:send');

                        // set ga conversion tracking (submitted in calling page/include file)
                        // if ((typeof(ga_donationAmount) != "undefined") && (!isNaN(ga_donationAmount))) {
                        google_conversion_value = ga_donationAmount;
                        google_conversion_label = "kh--CInE9QEQ0cWd8wM";
                        //}

                        // set adroll conversion amount (submited below)
                        adroll_conversion_value_in_dollars = ga_donationAmount;

                        // track KPI and details
                        om_gaTrackKPI("Donation_" + om_sDonationDetail);

                    } catch (err) { }
                    // End Google Order Tracking

                    // T&T Order Tracking
                    try {
                        mboxCreate('orderConfirmPage',
                        'productPurchasedID=' + om_sTT_Products,
                        'orderTotal=' + ga_donationAmount,
                        'orderId=' + om_sTransactionID);
                    } catch (Error) { }
                    // End T&T Order Tracking

                    // Strongview Tracking
                    try {
                      document.write(unescape("%3Cimg src='https://mailings.vb.cbn.com:443/conversion?version=1&conversion_items=1&conversion_value=" + ga_donationAmount + "' height='1' width='1' border='0'%3E"));
                     } catch (e) { }
                     // end Strongview Tracking

                    // transaction id
                    s.eVar50 = om_sTransactionID;
                    s.prop50 = s.eVar50;

                    // this is an online donor
                    om_setCookie("cbnod", "1", 365, "/");
                    
                    // set tid to supress duplicates
                     om_setCookie("don_tid", om_sTransactionID, 365, "/");
                }
            }
		}
	}

} catch (Error) { }




/* ******************************************************************	*/
/* INLINE: Set Contact Source											*/
/* ******************************************************************	*/
try {
	// do we have a value for contact source - set in s_code_community.aspx
	if ((typeof (sOm_ContactSource) != "undefined") && (sOm_ContactSource != "")) {
		s.eVar47 = sOm_ContactSource;
		s.prop47 = s.eVar47;
	}
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Set Contact													*/
/* ******************************************************************	*/
try {
	// do we have a value for contact  - set in s_code_community.aspx
	if ((typeof (sOm_ContactID) != "undefined") && (sOm_ContactID != "")) {
		s.eVar46 = sOm_ContactID;
		s.prop46 = s.eVar46;
		if (sOm_ContactID != "Value_Not_Set") {
			s.visitorID = sOm_ContactID.replace(/-/g,"_");
		}
	}
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Set Contact Logged in Status									*/
/* ******************************************************************	*/
try {
	// do we have a value for contact logged in - set in s_code_community.aspx
	if ((typeof (sOm_ContactLoggedIn) != "undefined") && (sOm_ContactLoggedIn != "")) {
		s.eVar15 = sOm_ContactLoggedIn;
		s.prop15 = s.eVar15;
		// ga login stats
		if (sOm_ContactLoggedIn != null) {
			sOm_gaLogStatus = om_getCookie("gaLS");
			if (sOm_gaLogStatus != sOm_ContactLoggedIn.replace(/a|e|i|o|u|g|t|d|s/gi, "")) {
				om_gaTrackKPI("Status_" + sOm_ContactLoggedIn);
				om_setCookie("gaLS", sOm_ContactLoggedIn.replace(/a|e|i|o|u|g|t|d|s/gi, ""), 365, "/");
			}
		}
	}
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Set Minute of Day, Day of Year and Year						*/
/* ******************************************************************	*/
try {
	// do we have a value for minute of day set in s_code_community.aspx
	if ((typeof (sOm_MinuteOfDay) != "undefined") && (sOm_MinuteOfDay != "")) {
		s.eVar54 = sOm_MinuteOfDay;
		s.prop54 = s.eVar54;
	}

	if ((typeof (sOm_Year) != "undefined") && (sOm_Year != "")) {
		s.eVar68 = sOm_Year;
		s.prop68 = s.eVar68;
	}

	if ((typeof (sOm_DayOfYear) != "undefined") && (sOm_DayOfYear != "")) {
		s.eVar67 = sOm_DayOfYear;
		s.prop67 = s.eVar67;
	}


} catch (Error) { }


/* ******************************************************************	*/
/* INLINE: Retrieve all intcmp links on the page						*/
/* ******************************************************************	*/
try {
	var om_link_intcmp_value = "";
	var om_links_list = "";
	var om_links_array = document.getElementsByTagName("a");
	for(var om_links_counter = 0; om_links_counter<om_links_array.length; om_links_counter++) {
		if (om_links_array[om_links_counter].href.indexOf("intcmp") >=0) {
			// extract intcmp value
			om_link_intcmp_value = getURLParam_v2('intcmp',om_links_array[om_links_counter].href);
			if (om_link_intcmp_value != "") {
				if (om_links_list != "") {
					om_links_list = om_links_list + "," + om_link_intcmp_value;
				} else {
					om_links_list = om_link_intcmp_value;
				}
			}
		} else if (om_links_array[om_links_counter].href.indexOf("oascentral") >=0) {
			// ad server - extract intcmp from image alt tag
			if (om_links_array[om_links_counter].hasChildNodes()) {
				var om_link_element = om_links_array[om_links_counter].childNodes[0];
				if (om_link_element.hasAttribute("alt")) {
					om_link_intcmp_value = om_links_array[om_links_counter].childNodes[0].alt.toLowerCase();
					if (om_link_intcmp_value != "") {
						if (om_links_list != "") {
							om_links_list = om_links_list + "," + om_link_intcmp_value;
						} else {
							om_links_list = om_link_intcmp_value;
						}
					}
					// set alt value to blank
					om_links_array[om_links_counter].childNodes[0].alt = "";
				}
			}
		}
	}
	s.list1 = om_links_list;
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Set LTV Group 												*/
/* ******************************************************************	*/
try {

	// do we have a value for LTV Group set in s_code_community.aspx
	if ((typeof (sOm_ContactLtvGroup) == "undefined") || (sOm_ContactLtvGroup == "")) {
		sOm_ContactLtvGroup = om_getCookie("omLTVG"); // check cookie
	} else {
		om_setCookie("omLTVG", sOm_ContactLtvGroup, 365, "/"); // update cookie
	}

	if ((typeof (sOm_ContactLtvGroup) != "undefined") && (sOm_ContactLtvGroup != "")) {
		s.eVar51 = sOm_ContactLtvGroup;
		s.prop51 = s.eVar51;
		// ga ltvg
		if (sOm_ContactLtvGroup != null) {
			sOm_gaVisitLtvg = om_getCookie("gaLTVG");
			if ((typeof (sOm_gaVisitLtvg) == "undefined") || (sOm_gaVisitLtvg == null) || (sOm_gaVisitLtvg == "")) {
				om_gaTrackKPI("Ltvg_" + sOm_ContactLtvGroup);
				om_setCookie("gaLTVG", "1", 1, "/"); // no need to submit to ga again
			}
		}
	}
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Set Level													*/
/* ******************************************************************	*/
try {
	// do we have a value for level set in s_code_community.aspx
	if ((typeof (sOm_Level) == "undefined") || (sOm_Level == "")) {
		sOm_Level = om_getCookie("LEVEL"); // check cookie
	}
	// online donation
	if ((typeof (sOm_Level) == "undefined") || (sOm_Level == null) || (sOm_Level == "")) {
		sOm_CBNOD = om_getCookie("cbnod");
		if ( ((typeof (sOm_CBNOD) != "undefined") && (sOm_CBNOD == "1")) || ((typeof (om_sTransactionID) != "undefined") && (om_sTransactionID != "")) ) {
        	sOm_Level = "NON-MATCHED ONLINE DONOR";
		}
     }
	if ((typeof (sOm_Level) != "undefined") && (sOm_Level != "")) {
		s.eVar49 = sOm_Level;
		s.prop49 = s.eVar49;

		// ga level
		if (sOm_Level != null) {
			sOm_gaVisitLevel = om_getCookie("gaVL");
			if ((typeof (sOm_gaVisitLevel) == "undefined") || (sOm_gaVisitLevel == null) || (sOm_gaVisitLevel == "")) {
				om_gaTrackKPI("Level_" + sOm_Level);
				om_setCookie("gaVL", "1", 1, "/"); // no need to submit to ga again
			}
		}
	}
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Set Motivation Code													*/
/* ******************************************************************	*/
try {
	// do we have a value for level set in s_code_community.aspx
	if ((typeof (sOm_Motivation) != "undefined") && (sOm_Motivation != "")) {
		s.eVar102 = sOm_Motivation;
	}
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Track Previews of Community Resources						*/
/* ******************************************************************	*/
try {

	if ((typeof (om_ResourcePreview) != "undefined") && (typeof (om_ResourcePreviewType) != "undefined") && (om_ResourcePreview != "") && (om_ResourcePreviewType != "")) {
		s.prop28 = om_ResourcePreviewType + "_" + om_ResourcePreview;
		s.eVar27 = s.prop28;
	}
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Track Agent String											*/
/* ******************************************************************	*/
try {
		s.prop70 = navigator.userAgent;
		s.eVar70 = s.prop70;
} catch (Error) { }

/* ******************************************************************	*/
/* INLINE: Track Registration KPIs indicated via parameters				*/
/* ******************************************************************	*/
try {

	// was there a KPI variable i.e. a successful superbook registration has /pagename.aspx?om=sbregister
	sOm_Parameter = getURLParam('om');
	if (sOm_Parameter == "sbregister") {
		// we have a successful superbook registration
		s.events = "event3"; 											// registration confirmation
		s.eVar30 = "Community - Superbook Registration";   				// KPI
		s.prop39 = s.eVar30; 											// site success pathing
	}
	if (sOm_Parameter == "mycbnregister") {
		// we have a successful registration and were redirected to the resource they were accessing before signing up e.g. /resourcepage.aspx?om=mycbnregister
		s.events = "event3"; 											// registration confirmation
		s.eVar30 = "Community - MyCBN Registration";   					// KPI
		s.prop29 = s.pageName; 											// Registration Resource (Motivation Page)
		s.prop39 = s.eVar30; 											// site success pathing
	}
	if (sOm_Parameter == "community-resources") {
		// we have a successful registration and were redirected to the resource they were accessing before signing up e.g. /resourcepage.aspx?om=community-resources
		s.events = "event3"; 											// registration confirmation
		s.eVar30 = "Community - Resource Registration";					// KPI
		s.prop29 = s.pageName; 											// Registration Resource (Motivation Page)
		s.prop39 = s.eVar30; 											// site success pathing
	}
	if (sOm_Parameter == "comment-lighbox") {
		// we have a successful registration and were redirected to the resource they were accessing before signing up e.g. /articlepage.aspx?om=comment-lighbox
		s.events = "event3"; 											// registration confirmation
		s.eVar30 = "Community - Comment Registration";					// KPI
		s.prop29 = s.pageName; 											// Registration Resource (Motivation Page)
		s.prop39 = s.eVar30; 											// site success pathing
	}
	if (sOm_Parameter == "homepage") {
		// we have a successful registration and were redirected to the resource they were accessing before signing up e.g. /index.aspx?om=homepage
		s.events = "event3"; 											// registration confirmation
		s.eVar30 = "Community - CBN Registration";						// KPI
		s.prop29 = s.pageName; 											// Registration Resource (Motivation Page)
		s.prop39 = s.eVar30; 											// site success pathing
	}
} catch (Error) { }

/* *************************************************************************	*/
/* INLINE: Track Legacy Webtrends Campaign Codes and Classify Organic Search	*/
/* **************************************************************************	*/
try {
	// Use Webtrends Campaign Code if no Omniture code is specified
	sOm_CampaignCode = getURLParam('cpid');
	if (sOm_CampaignCode == "") {
		// check if there is a legacy Webtrends Campaign Code
		sOm_CampaignCode = getURLParam('WT.mc_id');
		if (sOm_CampaignCode != "") {
			// we have a legacy campaign code
			s.campaign = "Campaign_WT_" + sOm_CampaignCode;
		} else {
			// there is still no campaign code - is this an organic search result?
			sReferrerURL = sOm_sReferrer.toLowerCase();
			if (sReferrerURL.indexOf(".google.c") > -1) {
				s.campaign = "Organic_Google";
			} else if (sReferrerURL.indexOf(".bing.c") > -1) {
				s.campaign = "Organic_Bing";
			} else if (sReferrerURL.indexOf("search.yahoo.com") > -1) {
				s.campaign = "Organic_Yahoo";
			}
		}
	}
} catch (Error) { }

/* ***************************************************************************************	*/
/* INLINE: Check previously set global variables that determine specific tracking variables	*/
/* ***************************************************************************************	*/

try {
	if (typeof (sOm) != "undefined") {

		if (sOm == "ev_gospel_view_english") {
			// Viewed Gospel Presentation
			s.eVar30 = "Evangelism - Viewed Gospel Presentation - English"; 	// KPI
			s.events = "event14"; 												// gospel view event
			s.prop39 = "Evangelism - Viewed Gospel Presentation - English";  	// site success pathing

		} else if (sOm == "ev_gospel_view_spanish") {
			// Viewed Gospel Presentation
			s.eVar30 = "Evangelism - Viewed Gospel Presentation - Spanish"; 	// KPI
			s.events = "event14"; 												// gospel view event
			s.prop39 = "Evangelism - Viewed Gospel Presentation - Spanish";   	// site success pathing

		} else if (sOm == "ev_gospel_view_mobile") {
			// Viewed Gospel Presentation
			s.eVar30 = "Evangelism - Viewed Gospel Presentation - Mobile"; 		// KPI
			s.events = "event14"; 												// gospel view event
			s.prop39 = "Evangelism - Viewed Gospel Presentation - Mobile";   	// site success pathing

		} else if (sOm == "ev_gospel_view_tipritv") {
			// Viewed Gospel Presentation
			s.eVar30 = "Evangelism - Viewed Gospel Presentation - TipriTv";		// KPI
			s.events = "event14"; 												// gospel view event
			s.prop39 = "Evangelism - Viewed Gospel Presentation - TipriTv";		// site success pathing

		} else if (sOm == "ev_gospel_ready_english") {
			// Presented with Salvation Prayer
			s.eVar30 = "Evangelism - Ready to Make Commitment - English"; 		// KPI
			s.prop39 = "Evangelism - Ready to Make Commitment - English";	    // site success pathing

		} else if (sOm == "ev_gospel_ready_spanish") {
			// Presented with Salvation Prayer
			s.eVar30 = "Evangelism - Ready to Make Commitment - Spanish"; 		 // KPI
			s.prop39 = "Evangelism - Ready to Make Commitment - Spanish";   	// site success pathing

		} else if (sOm == "ev_gospel_ready_mobile") {
			// Presented with Salvation Prayer
			s.eVar30 = "Evangelism - Ready to Make Commitment - Mobile"; 		 // KPI
			s.prop39 = "Evangelism - Ready to Make Commitment - Mobile";   		 // site success pathing

		} else if (sOm == "ev_gospel_ready_tipritv") {
			// Presented with Salvation Prayer
			s.eVar30 = "Evangelism - Ready to Make Commitment - TipriTv"; 		 // KPI
			s.prop39 = "Evangelism - Ready to Make Commitment - TipriTv";	    // site success pathing

		} else if ((sOm == "ev_gospel_made_commitment_english") || (sOm == "ev_gospel_made_commitment_prayer_request_english")){
			// Prayed Salvation Prayer and Presented with Commitment Form
			s.eVar29 = "Evangelism - Commitment Form"; 							// form type
			s.events = "event16,event41"; 										// form view + prayed
			s.eVar30 = "Evangelism - Prayed Salvation Prayer - English";
			s.prop39 = "Evangelism - Prayed Salvation Prayer - English";   		// site success pathing

		} else if (sOm == "ev_gospel_made_commitment_spanish") {
			// Prayed Salvation Prayer and Presented with Commitment Form
			s.eVar29 = "Evangelism - Commitment Form - Spanish";				// form type
			s.events = "event16,event41"; 										// form view + prayed
			s.eVar30 = "Evangelism - Prayed Salvation Prayer - Spanish"; 		// KPI
			s.prop39 = "Evangelism - Prayed Salvation Prayer - Spanish";		// site success pathing

		} else if (sOm == "ev_gospel_made_commitment_mobile") {
			// Prayed Salvation Prayer and Presented with Commitment Form
			s.eVar29 = "Evangelism - Commitment Form - Mobile";					// form type
			s.events = "event16,event41"; 										// form view + prayed
			s.eVar30 = "Evangelism - Prayed Salvation Prayer - Mobile"; 		// KPI
			s.prop39 = "Evangelism - Prayed Salvation Prayer - Mobile";			// site success pathing

		} else if (sOm == "ev_gospel_made_commitment_tipritv") {
			// Prayed Salvation Prayer and Presented with Commitment Form
			s.eVar29 = "Evangelism - Commitment Form - TipriTv"; 				// form type
			s.events = "event16,event41"; 										// form view + prayed
			s.eVar30 = "Evangelism - Prayed Salvation Prayer - TipriTv"; 		// KPI
			s.prop39 = "Evangelism - Prayed Salvation Prayer - TipriTv";		// site success pathing

		} else if ((sOm == "ev_gospel_new_commitment_english")  || (sOm == "ev_gospel_new_commitment_prayer_request_english")) {
			// Submitted form and indicated a new commitment
			s.eVar29 = "Evangelism - Commitment Form"; 							// form type
			s.events = "event15,event12,event42";								// form success and new commitment events
			s.eVar30 = "Evangelism - Contacted Us - New Commitment - English";
			s.prop39 = "Evangelism - Contacted Us - Commitment - English"; 		// site success pathing


		} else if (sOm == "ev_gospel_new_commitment_spanish") {
			// Submitted form and indicated a new commitment
			s.eVar29 = "Evangelism - Commitment Form - Spanish";				// form type
			s.events = "event15,event12,event42"; 								// form success and new commitment events
			s.eVar30 = "Evangelism - Contacted Us - New Commitment - Spanish";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - Spanish"; 		// site success pathing

		} else if (sOm == "ev_gospel_new_commitment_mobile") {
			// Submitted form and indicated a new commitment
			s.eVar29 = "Evangelism - Commitment Form - Mobile";					// form type
			s.events = "event15,event12,event42"; 								// form success and new commitment events
			s.eVar30 = "Evangelism - Contacted Us - New Commitment - Mobile";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment"; 				// site success pathing

		} else if (sOm == "ev_gospel_new_commitment_tipritv") {
			// Submitted form and indicated a new commitment
			s.eVar29 = "Evangelism - Commitment Form - TipriTv"; 				// form type
			s.events = "event15,event12,event42"; 								// form success and new commitment events
			s.eVar30 = "Evangelism - Contacted Us - New Commitment - TipriTv";  // KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - TipriTv"; 		// site success pathing

		} else if ((sOm == "ev_gospel_recommitment_english")  || (sOm == "ev_gospel_recommitment_prayer_request_english")) {
			// Submitted form and indicated a recommitment
			s.eVar29 = "Evangelism - Commitment Form"; 							// form type
			s.events = "event15,event13,event42"; 								// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Recommitment - English";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - English"; 		// site success pathing

		} else if (sOm == "ev_gospel_recommitment_spanish") {
			// Submitted form and indicated a recommitment
			s.eVar29 = "Evangelism - Commitment Form - Spanish";				// form type
			s.events = "event15,event13,event42"; 								// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Recommitment - Spanish";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - Spanish"; 		// site success pathing

		} else if (sOm == "ev_gospel_recommitment_mobile") {
			// Submitted form and indicated a recommitment
			s.eVar29 = "Evangelism - Commitment Form - Mobile";					// form type
			s.events = "event15,event13,event42"; 								// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Recommitment - Mobile";		// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - Mobile"; 		// site success pathing

		} else if (sOm == "ev_gospel_recommitment_tipritv") {
			// Submitted form and indicated a recommitment
			s.eVar29 = "Evangelism - Commitment Form - TipriTv"; 				// form type
			s.events = "event15,event13,event42"; 								// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Recommitment - TipriTv"; 	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - TipriTv"; 		// site success pathing

		} else if ((sOm == "ev_gospel_unknown_commitment_english") || (sOm == "ev_gospel_unknown_commitment_prayer_request_english")) {
			// Submitted form and didn't indicate the type of commitment
			s.eVar29 = "Evangelism - Commitment Form"; 								// form type
			s.events = "event15,event13,event42"; 									// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Unknown Commitment - English";  // KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - English"; 			// site success pathing

		} else if (sOm == "ev_gospel_unknown_commitment_spanish") {
			// Submitted form and didn't indicate the type of commitmentt
			s.eVar29 = "Evangelism - Commitment Form - Spanish";					// form type
			s.events = "event15,event13,event42"; 									// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Unknown Commitment - Spanish";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - Spanish"; 			// site success pathing

		} else if (sOm == "ev_gospel_unknown_commitment_mobile") {
			// Submitted form and didn't indicate the type of commitmentt
			s.eVar29 = "Evangelism - Commitment Form - Mobile";						// form type
			s.events = "event15,event13,event42"; 									// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Unknown Commitment - Mobile";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - Mobile"; 			// site success pathing

		} else if (sOm == "ev_gospel_unknown_commitment_tipritv") {
			// Submitted form and didn't indicate the type of commitment
			s.eVar29 = "Evangelism - Commitment Form - TipriTv"; 					// form type
			s.events = "event15,event13,event42"; 									// form success and recommitment events
			s.eVar30 = "Evangelism - Contacted Us - Unknown Commitment - TipriTv";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Commitment - TipriTv"; 			// site success pathing

		} else if (sOm == "ev_gospel_not_ready_english") {
			// Not Ready and Presented with Question Form
			s.eVar29 = "Evangelism - Questions Form"; 							// form type
			s.events = "event16"; 												// form view
			s.eVar30 = "Evangelism - Not Ready to Make Commitment - English"	// KPI
			s.prop39 = "Evangelism - Not Ready to Make Commitment - English"; 	// site success pathing

		} else if (sOm == "ev_gospel_not_ready_spanish") {
			// Not Ready and Presented with Question Form
			s.eVar29 = "Evangelism - Questions Form - Spanish";					// form type
			s.events = "event16"; 												// form view
			s.eVar30 = "Evangelism - Not Ready to Make Commitment - Spanish"	// KPI
			s.prop39 = "Evangelism - Not Ready to Make Commitment - Spanish"; 	// site success pathing

		} else if (sOm == "ev_gospel_not_ready_mobile") {
			// Not Ready and Presented with Question Form
			s.eVar29 = "Evangelism - Questions Form - Mobile";					// form type
			s.events = "event16"; 												// form view
			s.eVar30 = "Evangelism - Not Ready to Make Commitment - Mobile"		// KPI
			s.prop39 = "Evangelism - Not Ready to Make Commitment - Mobile"; 	// site success pathing

		} else if (sOm == "ev_gospel_not_ready_tipritv") {
			// Not Ready and Presented with Question Form
			s.eVar29 = "Evangelism - Questions Form - TipriTv"; 				// form type
			s.events = "event16"; 												// form view
			s.eVar30 = "Evangelism - Not Ready to Make Commitment - TipriTv"	// KPI
			s.prop39 = "Evangelism - Not Ready to Make Commitment - TipriTv"; 	// site success pathing

		} else if (sOm == "ev_gospel_asked_question_english") {
			// Not Ready and Submitted Question
			s.eVar29 = "Evangelism - Questions Form"; 							// form type
			s.events = "event15"; 												// form success
			s.eVar30 = "Evangelism - Contacted Us - Asked Question - English";
			s.prop39 = "Evangelism - Contacted Us - Asked Question - English"; 	// site success pathing

		} else if (sOm == "ev_gospel_asked_question_spanish") {
			// Not Ready and Submitted Question
			s.eVar29 = "Evangelism - Questions Form - Spanish";					// form type
			s.events = "event15"; 												// form success
			s.eVar30 = "Evangelism - Contacted Us - Asked Question - Spanish";  // KPI
			s.prop39 = "Evangelism - Contacted Us - Asked Question - Spanish"; 	// site success pathing

		} else if (sOm == "ev_gospel_asked_question_mobile") {
			// Not Ready and Submitted Question
			s.eVar29 = "Evangelism - Questions Form - Mobile";					// form type
			s.events = "event15"; 												// form success
			s.eVar30 = "Evangelism - Contacted Us - Asked Question - Mobile";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Asked Question - Mobile"; 	// site success pathing

		} else if (sOm == "ev_gospel_asked_question_tipritv") {
			// Not Ready and Submitted Question
			s.eVar29 = "Evangelism - Questions Form - TipriTv"; 				// form type
			s.events = "event15"; 												// form success
			s.eVar30 = "Evangelism - Contacted Us - Asked Question - TipriTv";	// KPI
			s.prop39 = "Evangelism - Contacted Us - Asked Question - TipriTv"; 	// site success pathing

		} else if (sOm == "ministry_prayer_request_form_view") {
			// Viewed Prayer Request Form
			s.eVar29 = "Ministry - Prayer Request Form"; 						// form type
			s.events = "event16"; 												// form view
			s.prop39 = "Ministry - Prayer Request Form"; 						// site success pathing

		} else if (sOm == "ministry_prayer_request_form_view_mobile") {
			// Viewed Prayer Request Form
			s.eVar29 = "Ministry - Prayer Request Form - Mobile"; 				// form type
			s.events = "event16"; 												// form view
			s.prop39 = "Ministry - Prayer Request Form - Mobile";				// site success pathing

		} else if (sOm == "ministry_prayer_request_form_submit") {
			// Submitted a Prayer Request
			s.eVar29 = "Ministry - Prayer Request Form"; 						// form type
			s.events = "event15,event43";										// form success
			if (typeof (sOm_FormName) != "undefined") {
				s.eVar30 = "Ministry - Submitted Prayer Request - " + sOm_FormName; // KPI
			}
			s.prop39 = "Ministry - Submitted Prayer Request"; 						// site success pathing

		} else if (sOm == "ministry_prayer_request_form_submit_mobile") {
			// Submitted a Prayer Request
			s.eVar29 = "Ministry - Prayer Request Form - Mobile"; 				// form type
			s.events = "event15,event43"; 										// form success
			s.eVar30 = "Ministry - Submitted Prayer Request - Mobile";			// KPI
			s.prop39 = "Ministry - Submitted Prayer Request - Mobile"; 			// site success pathing

		} else if (sOm == "email_subscribe") {
			// Subscribed to an email update or email discipleship course
			s.events = "event17"; 												// email subscribe
			if (typeof (sOm_EmailName) != "undefined") {
				s.eVar28 = "Email - Subscribe - " + sOm_EmailName;
				s.eVar30 = s.eVar28;											// KPI
				s.prop39 = s.eVar28; 											// site success pathing
			}

		} else if (sOm == "email_unsubscribe") {
			// Unsubscribed to an email update or email discipleship course
			s.events = "event18"; 												// email unsubscribe
			if (typeof (sOm_EmailName) != "undefined") {
				s.eVar28 = "Email - Unsubscribe - " + sOm_EmailName;
				s.eVar30 = s.eVar28;											// KPI
				s.prop39 = s.eVar28; 											// site success pathing
			}
		} else if (sOm == "mycbn_register_form") {
			// Viewed mycbn registration  Form
			s.eVar29 = "Community - mycbn Registration Form"; 					// form type
			s.events = "event16"; 												// form view
			s.prop39 = s.eVar29; 												// site success pathing
		} else if (sOm == "mycbn_register_success") {
			// Completed mycbn registration
			s.eVar29 = "Community - mycbn Registration Form"; 					// form type
			s.events = "event15"; 												// form submit
			s.eVar30 = "Community - mycbn Registration Validation"; 			// KPI
			s.prop39 = s.eVar30; 												// site success pathing
		} else if (sOm == "church_referral_form") {
			// form to search for a local church
			s.eVar29 = "Discipleship - Local Church Referral Form"; 		// form type
			s.events = "event16"											// form view
			s.prop39 = s.eVar29; 											// site success pathing
		} else if (sOm == "church_referral_submit") {
			// searched for a local church
			s.eVar29 = "Discipleship - Local Church Referral Form"; 		// form type
			s.events = "event15,event44";									// form submit
			s.eVar30 = "Discipleship - Local Church Referral"; 				// KPI
			s.prop39 = "Discipleship - Local Church Referral Form - Submit";// site success pathing
		} else if (sOm == "church_referral_form_offsite") {
			// form to search for a local church
			s.eVar29 = "Discipleship - Local Church Referral Form - Offsite"; 	// form type
			s.events = "event16"												// form view
			s.prop39 = s.eVar29; 												// site success pathing
		} else if (sOm == "church_referral_submit_offsite") {
			// searched for a local church
			s.eVar29 = "Discipleship - Local Church Referral Form - Offsite"; 	// form type
			s.events = "event15,event44"										// form submit
			s.eVar30 = "Discipleship - Local Church Referral - Offsite - Submit"; 		// KPI
			s.prop39 = s.eVar30; 												// site success pathing
		} else if (sOm == "church_referral_referral_mobile") {
			// form to search for a local church
			s.eVar29 = "Discipleship - Local Church Referral Form - Mobile"; 	// form type
			s.events = "event16"												// form view
			s.prop39 = s.eVar29; 												// site success pathing
		} else if (sOm == "church_referral_submit_mobile") {
			// searched for a local church
			s.eVar29 = "Discipleship - Local Church Referral Form - Mobile"; 	// form type
			s.events = "event15,event44"										// form submit
			s.eVar30 = "Discipleship - Local Church Referral - Mobile"; 		// KPI
			s.prop39 = "Discipleship - Local Church Referral Form - Mobile - Submit";// site success pathing
		} else if (sOm == "discipleship_view_print_answer") {
			// printed the answer to a spiritual question
			s.eVar30 = "Discipleship - Superbook - Viewed Printable Answer";	// KPI
			s.prop39 = s.eVar30; 												// site success pathing
		} else if (sOm == "contest_mothersday2010_form") {
			// Viewed mothers day contest form
			s.eVar29 = "Development - Contest - Mothers Day 2010 Entry Form"; 	// form type
			s.events = "event16"; 												// form view
			s.prop39 = s.eVar29; 												// site success pathing
		} else if (sOm == "contest_mothersday2010_success") {
			// Completed mothers day contest entry
			s.eVar29 = "Development - Contest - Mothers Day 2010 Entry Form"; 	// form type
			s.events = "event15"; 												// form submit
			s.eVar30 = "Development - Contest - Mothers Day 2010 Entry"; 		// KPI
			s.prop39 = s.eVar30; 												// site success pathing
		} else if (sOm == "donation_confirmation_cookie_block_error") {
			// Cookie Block error on the Donation Confirmation Page
			s.eVar30 = "Development - Donation Error - Confirmation Cookie Block";	// KPI
			s.prop39 = s.eVar30; 													// site success pathing
		} else if (sOm == "donation_confirmation_processing_error") {
			// Processing error on the Donation Confirmation Page
			s.eVar30 = "Development - Donation Error - Confirmation Processing"; 	// KPI
			s.prop39 = s.eVar30; 													// site success pathing
		} else if (sOm == "job_application") {
			// Submitted Job Application
			s.eVar30 = "HR - Submitted Job Application"; 							// KPI
			s.prop39 = s.eVar30; 													// site success pathing
		} else if (sOm == "matching_gifts_employer_search_form") {
			// form to search for a matching gifts employer
			s.eVar29 = "Fundraising - Matching Gifts Employer Search Form";	// form type
			s.events = "event16"											// form view
			s.prop39 = s.eVar29; 											// site success pathing
		}

	}

	// Handle Custom SiteSection Success Pathing
	if (!s.prop39) {
		// not a specific success page, default to the current Site Section (thereby enabling site section success pathing)
		s.prop39 = s.channel;
	}

} catch (Error) { }


/* ******************************************************************		*/
/* INLINE: Check for any custom errors that have occurred 					*/
/* ******************************************************************		*/

try {
	if (typeof (sOm_AdError) != "undefined") {
		s.eVar42 = sOm_AdError + " - " + s.pageName; // Error Code
	}
} catch (Error) { }


/* ******************************************************************		*/
/* INLINE: ga Track KPIs													*/
/* ******************************************************************		*/
try {
	om_gaTrackKPI(s.eVar30);
} catch (Error) { }


function omTrackMcEvents (sEventValue,iEventNum) {
    //
}


/* ******************************************************************		*/
/* INLINE: Remove invalid characters from all variables 					*/
/* ******************************************************************		*/

function om_cleanData(data) {
	// remove illegal characters and new lines
	try {
		if (typeof (data) != "undefined") {
			data = data.replace(/\r|\n/g,'');
		}
		return data;
	} catch (Error) {
		return data;
	}
}

try {
if(s.prop1) s.prop1 = om_cleanData(s.prop1);
if(s.prop2) s.prop2 = om_cleanData(s.prop2);
if(s.prop3) s.prop3 = om_cleanData(s.prop3);
if(s.prop4) s.prop4 = om_cleanData(s.prop4);
if(s.prop5) s.prop5 = om_cleanData(s.prop5);
if(s.prop6) s.prop6 = om_cleanData(s.prop6);
if(s.prop7) s.prop7 = om_cleanData(s.prop7);
if(s.prop8) s.prop8 = om_cleanData(s.prop8);
if(s.prop9) s.prop9 = om_cleanData(s.prop9);
if(s.prop10) s.prop10 = om_cleanData(s.prop10);
if(s.prop11) s.prop11 = om_cleanData(s.prop11);
if(s.prop12) s.prop12 = om_cleanData(s.prop12);
if(s.prop13) s.prop13 = om_cleanData(s.prop13);
if(s.prop14) s.prop14 = om_cleanData(s.prop14);
if(s.prop15) s.prop15 = om_cleanData(s.prop15);
if(s.prop16) s.prop16 = om_cleanData(s.prop16);
if(s.prop17) s.prop17 = om_cleanData(s.prop17);
if(s.prop18) s.prop18 = om_cleanData(s.prop18);
if(s.prop19) s.prop19 = om_cleanData(s.prop19);
if(s.prop20) s.prop20 = om_cleanData(s.prop20);
if(s.prop21) s.prop21 = om_cleanData(s.prop21);
if(s.prop22) s.prop22 = om_cleanData(s.prop22);
if(s.prop23) s.prop23 = om_cleanData(s.prop23);
if(s.prop24) s.prop24 = om_cleanData(s.prop24);
if(s.prop25) s.prop25 = om_cleanData(s.prop25);
if(s.prop26) s.prop26 = om_cleanData(s.prop26);
if(s.prop27) s.prop27 = om_cleanData(s.prop27);
if(s.prop28) s.prop28 = om_cleanData(s.prop28);
if(s.prop29) s.prop29 = om_cleanData(s.prop29);
if(s.prop30) s.prop30 = om_cleanData(s.prop30);
if(s.prop31) s.prop31 = om_cleanData(s.prop31);
if(s.prop32) s.prop32 = om_cleanData(s.prop32);
if(s.prop33) s.prop33 = om_cleanData(s.prop33);
if(s.prop34) s.prop34 = om_cleanData(s.prop34);
if(s.prop35) s.prop35 = om_cleanData(s.prop35);
if(s.prop36) s.prop36 = om_cleanData(s.prop36);
if(s.prop37) s.prop37 = om_cleanData(s.prop37);
if(s.prop38) s.prop38 = om_cleanData(s.prop38);
if(s.prop39) s.prop39 = om_cleanData(s.prop39);
if(s.prop40) s.prop40 = om_cleanData(s.prop40);
if(s.prop41) s.prop41 = om_cleanData(s.prop41);
if(s.prop42) s.prop42 = om_cleanData(s.prop42);
if(s.prop43) s.prop43 = om_cleanData(s.prop43);
if(s.prop44) s.prop44 = om_cleanData(s.prop44);
if(s.prop45) s.prop45 = om_cleanData(s.prop45);
if(s.prop46) s.prop46 = om_cleanData(s.prop46);
if(s.prop47) s.prop47 = om_cleanData(s.prop47);
if(s.prop48) s.prop48 = om_cleanData(s.prop48);
if(s.prop49) s.prop49 = om_cleanData(s.prop49);
if(s.prop50) s.prop50 = om_cleanData(s.prop50);
if(s.prop51) s.prop51 = om_cleanData(s.prop51);
if(s.prop52) s.prop52 = om_cleanData(s.prop52);
if(s.prop53) s.prop53 = om_cleanData(s.prop53);
if(s.prop54) s.prop54 = om_cleanData(s.prop54);
if(s.prop55) s.prop55 = om_cleanData(s.prop55);
if(s.prop56) s.prop56 = om_cleanData(s.prop56);
if(s.prop57) s.prop57 = om_cleanData(s.prop57);
if(s.prop58) s.prop58 = om_cleanData(s.prop58);
if(s.prop59) s.prop59 = om_cleanData(s.prop59);
if(s.prop60) s.prop60 = om_cleanData(s.prop60);
if(s.prop61) s.prop61 = om_cleanData(s.prop61);
if(s.prop62) s.prop62 = om_cleanData(s.prop62);
if(s.prop66) s.prop66 = om_cleanData(s.prop66);
if(s.prop69) s.prop69 = om_cleanData(s.prop69);
if(s.prop70) s.prop70 = om_cleanData(s.prop70);
if(s.prop71) s.prop71 = om_cleanData(s.prop71);
if(s.prop72) s.prop72 = om_cleanData(s.prop72);
if(s.eVar1) s.eVar1 = om_cleanData(s.eVar1);
if(s.eVar2) s.eVar2 = om_cleanData(s.eVar2);
if(s.eVar3) s.eVar3 = om_cleanData(s.eVar3);
if(s.eVar4) s.eVar4 = om_cleanData(s.eVar4);
if(s.eVar5) s.eVar5 = om_cleanData(s.eVar5);
if(s.eVar6) s.eVar6 = om_cleanData(s.eVar6);
if(s.eVar7) s.eVar7 = om_cleanData(s.eVar7);
if(s.eVar8) s.eVar8 = om_cleanData(s.eVar8);
if(s.eVar9) s.eVar9 = om_cleanData(s.eVar9);
if(s.eVar10) s.eVar10 = om_cleanData(s.eVar10);
if(s.eVar11) s.eVar11 = om_cleanData(s.eVar11);
if(s.eVar12) s.eVar12 = om_cleanData(s.eVar12);
if(s.eVar13) s.eVar13 = om_cleanData(s.eVar13);
if(s.eVar14) s.eVar14 = om_cleanData(s.eVar14);
if(s.eVar15) s.eVar15 = om_cleanData(s.eVar15);
if(s.eVar16) s.eVar16 = om_cleanData(s.eVar16);
if(s.eVar17) s.eVar17 = om_cleanData(s.eVar17);
if(s.eVar18) s.eVar18 = om_cleanData(s.eVar18);
if(s.eVar19) s.eVar19 = om_cleanData(s.eVar19);
if(s.eVar20) s.eVar20 = om_cleanData(s.eVar20);
if(s.eVar21) s.eVar21 = om_cleanData(s.eVar21);
if(s.eVar22) s.eVar22 = om_cleanData(s.eVar22);
if(s.eVar23) s.eVar23 = om_cleanData(s.eVar23);
if(s.eVar24) s.eVar24 = om_cleanData(s.eVar24);
if(s.eVar25) s.eVar25 = om_cleanData(s.eVar25);
if(s.eVar26) s.eVar26 = om_cleanData(s.eVar26);
if(s.eVar27) s.eVar27 = om_cleanData(s.eVar27);
if(s.eVar28) s.eVar28 = om_cleanData(s.eVar28);
if(s.eVar29) s.eVar29 = om_cleanData(s.eVar29);
if(s.eVar30) s.eVar30 = om_cleanData(s.eVar30);
if(s.eVar31) s.eVar31 = om_cleanData(s.eVar31);
if(s.eVar32) s.eVar32 = om_cleanData(s.eVar32);
if(s.eVar33) s.eVar33 = om_cleanData(s.eVar33);
if(s.eVar34) s.eVar34 = om_cleanData(s.eVar34);
if(s.eVar35) s.eVar35 = om_cleanData(s.eVar35);
if(s.eVar36) s.eVar36 = om_cleanData(s.eVar36);
if(s.eVar37) s.eVar37 = om_cleanData(s.eVar37);
if(s.eVar38) s.eVar38 = om_cleanData(s.eVar38);
if(s.eVar39) s.eVar39 = om_cleanData(s.eVar39);
if(s.eVar40) s.eVar40 = om_cleanData(s.eVar40);
if(s.eVar41) s.eVar41 = om_cleanData(s.eVar41);
if(s.eVar42) s.eVar42 = om_cleanData(s.eVar42);
if(s.eVar43) s.eVar43 = om_cleanData(s.eVar43);
if(s.eVar44) s.eVar44 = om_cleanData(s.eVar44);
if(s.eVar45) s.eVar45 = om_cleanData(s.eVar45);
if(s.eVar46) s.eVar46 = om_cleanData(s.eVar46);
if(s.eVar47) s.eVar47 = om_cleanData(s.eVar47);
if(s.eVar48) s.eVar48 = om_cleanData(s.eVar48);
if(s.eVar49) s.eVar49 = om_cleanData(s.eVar49);
if(s.eVar50) s.eVar50 = om_cleanData(s.eVar50);
if(s.eVar51) s.eVar51 = om_cleanData(s.eVar51);
if(s.eVar52) s.eVar52 = om_cleanData(s.eVar52);
if(s.eVar53) s.eVar53 = om_cleanData(s.eVar53);
if(s.eVar54) s.eVar54 = om_cleanData(s.eVar54);
if(s.eVar55) s.eVar55 = om_cleanData(s.eVar55);
if(s.eVar56) s.eVar56 = om_cleanData(s.eVar56);
if(s.eVar57) s.eVar57 = om_cleanData(s.eVar57);
if(s.eVar58) s.eVar58 = om_cleanData(s.eVar58);
if(s.eVar59) s.eVar59 = om_cleanData(s.eVar59);
if(s.eVar60) s.eVar60 = om_cleanData(s.eVar60);
if(s.eVar61) s.eVar61 = om_cleanData(s.eVar61);
if(s.eVar62) s.eVar62 = om_cleanData(s.eVar62);
if(s.eVar66) s.eVar66 = om_cleanData(s.eVar66);
if(s.eVar69) s.eVar69 = om_cleanData(s.eVar69);
if(s.eVar70) s.eVar70 = om_cleanData(s.eVar70);
if(s.eVar71) s.eVar71 = om_cleanData(s.eVar71);
if(s.eVar72) s.eVar72 = om_cleanData(s.eVar72);
if(s.pageName) s.pageName = om_cleanData(s.pageName);
if(s.channel) s.channel = om_cleanData(s.channel);
if(s.hier1) s.hier1 = om_cleanData(s.hier1);
} catch (Error) {}

/* ******************************************************************		*/
/* CBN: Additional Tag Management Code										*/
/* ******************************************************************		*/

/* ******************************************************************		*/
/* INLINE: T&T mbox banners															*/
/* ******************************************************************		*/
/*
// TTADG
try {
	document.write('<div class="mboxDefault"></div>');
	if ((typeof (TT_BannerAdGroup) != "undefined") && (TT_BannerAdGroup != null) && (TT_BannerAdGroup != "")) {
		mboxCreate('BannerAdGroup',"BannerAdGroup=" + TT_BannerAdGroup);
	} else {
		mboxCreate('BannerAdGroup_Unavailable');
	}
} catch (Error) {}
*/

/* ******************************************************************		*/
/* INLINE: T&T mbox Health DVD  													*/
/* ******************************************************************		*/

try {
	 if ((typeof (omTrackCommunityActivityName) != "undefined") && (omTrackCommunityActivityName == "Request DVD - Protect Your Health - Mail")) {
		document.write('<div class="mboxDefault"></div>');
		mboxCreate('Protect-Your-Health-Signup-DVD');
	}
} catch (Error) {}

/* ******************************************************************		*/
/* INLINE: T&T mbox GivingFooter													*/
/* ******************************************************************		*/
try {
	if (sOm_strHref.indexOf("giving") > -1) {
		document.write('<div class="mboxDefault"></div>');

		tt_lvl = "Unknown";
		tt_ltv = "Unknown";
		if ((typeof (s.eVar49) != "undefined") && (s.eVar49 != null) && (s.eVar49 != "")) {
			tt_lvl = s.eVar49;
		}
		if ((typeof (s.eVar51) != "undefined") && (s.eVar51 != null) && (s.eVar51 != "")) {
			tt_ltv = s.eVar51;
		}
		mboxCreate('GivingFooter','profile.LVL=' + tt_lvl, 'profile.LTV=' + tt_ltv);
	}
} catch (Error) {}


/* ******************************************************************		*/
// INLINE: Conversion OAS
/* ******************************************************************		*/
try {
	// gospel presentation response
	if (sOm == "ev_gospel_made_commitment_english") {
		cvoas_OAS_rn = new String (Math.random());
		cvoas_OAS_rns = cvoas_OAS_rn.substring (2, 11);
		var cvoas_tfsm_protocol = window.location.protocol;
		if (cvoas_tfsm_protocol == "https:") {
		 	cvoas_DataColl="https://";
		} else {
			cvoas_DataColl="http://";
		}
		document.write('<img alt=""  SRC="'+cvoas_DataColl+'oascentral.cbn.com/RealMedia/ads/adstream.track/1'+cvoas_OAS_rns+'?XE&epmAccountKey=3406&epmXTransKey=249&epmXtransStep=999&epmXtransCategory=&epmXtransItem=&epmXtransQuantity=&epmXTransRevenue=10&XE" style="width:0px;height:0px;border:none" />');
	}
} catch (Error) {}


/* ******************************************************************		*/
/* FUNCTION: mBox Link Function 											*/
/* ******************************************************************		*/

function om_mbox_popup(sMboxName, sClickedItem) {

	try {
		mboxUpdate(sMboxName, 'click=' + sClickedItem);
		/*
		var _delay=function(url){setTimeout(function(){location=url;},150)};
		_delay(sURL);
		return false;
		*/
	} catch (Error) { }

}

/* ******************************************************************		*/
/* INLINE: superbook kids?													*/
/* ******************************************************************		*/

try {
	om_sb_site = true;
	if ( (sOm_strHref.indexOf("/superbook/pages/") < 0) && (sOm_strHref.indexOf("/radio/superbook/player-new.aspx") <0) && (sOm_strHref.indexOf("/noindex/bible/superbookbiblereadingsignup.aspx") <0) && (!checkSuperbookDomain(sOm_strHref_Orig)) ) {
		om_sb_site = false;
	}
} catch (Error) {}


/* ******************************************************************		*/
/* INLINE: don?																*/
/* ******************************************************************		*/

try {
	om_don = false;
	if (((typeof (om_sDonationDetail) != "undefined") && (om_sDonationDetail != "")) && ((typeof (ga_donationAmount) != "undefined") && (ga_donationAmount != "")) && ((typeof (om_sTransactionID) != "undefined") && (om_sTransactionID != "")) ) {
		om_don = true;
	}
} catch (Error) {}


/* ******************************************************************		*/
/* INLINE + FUNCTION: Track KPIs in Test & Target							*/
/* ******************************************************************		*/

function om_testandtargetTrackKPI(sKPI) {
	try {
		var mboxValue = "";
		// update the global mbox with any of the selected KPIs that have occurred
		if ((typeof (sKPI) != "undefined") && (sKPI != "")) {
			if (sKPI.toLowerCase().indexOf("viewed gospel") > -1) {
				mboxValue = "Viewed Gospel Presentation";
			} else if (sKPI.toLowerCase().indexOf("prayed salvation prayer") > -1) {
				mboxValue = "Prayed Salvation Prayer";
			} else if (sKPI.toLowerCase().indexOf("submitted prayer request") > -1) {
				mboxValue = "Submitted Prayer Request";
			} else if (sKPI.toLowerCase().indexOf("email - subscribe") > -1) {
				mboxValue = "Email Subscribe";
			} else if (sKPI.toLowerCase().indexOf("email - unsubscribe") > -1) {
				mboxValue = "Email Unsubscribe";
			} else if (sKPI.toLowerCase().indexOf("request") > -1) {
				mboxValue = "Resource Request";
			} else if (sKPI.toLowerCase().indexOf("evangelism - contacted us") > -1) {
				mboxValue = "Submitted Gospel Response Form";
			} else if (sKPI.toLowerCase().indexOf("discipleship - local church referral") > -1) {
				mboxValue = "Church Referral";
			} else if (sKPI.toLowerCase().indexOf("registration") > -1) {
				mboxValue = "Registration";
			} else if (sKPI.toLowerCase().indexOf("posted-prayer-request") > -1) {
				mboxValue = "Submitted Community Prayer Request";
			} else if (sKPI.toLowerCase().indexOf("hr - submitted job application") > -1) {
				mboxValue = "HR Job Application";
			} else if (sKPI.toLowerCase().indexOf("matching gifts employer search") > -1) {
				mboxValue = "Matching Gifts Employer Search";
			} else if (sKPI.toLowerCase().indexOf("discipleship - viewed course page") > -1) {
				mboxValue = "Discipleship - Viewed Course Page";
			} else if (sKPI.toLowerCase().indexOf("download") > -1) {
				mboxValue = sKPI;
			} else if (sKPI.toLowerCase().indexOf("discipleship - viewed page") > -1) {
				mboxValue = sKPI;
			} else if (sKPI.toLowerCase().indexOf("submitted gospel response form - email") > -1) {
				mboxValue = "Submitted Gospel Response Form - Email";
			} else if (sKPI.toLowerCase().indexOf("video - start") > -1) {
				mboxValue = sKPI;
			}
			if (mboxValue != "") {

				$( document ).ready(function() {
                    try {
					   // ensure the global mbox exists before we update it
                        if ((document.getElementById("mboxMarker-default-global-0") === null) && ($('[id*="mbox-global"]').length <= 0) && (typeof (mboxGlobalReleaseVersion) == "undefined")) {
                            // need to create a global mbox
						  var div = document.createElement('div');
						  div.id = 'dynamicMboxContainer';
						  document.body.appendChild(div);
						  mboxDefine("dynamicMboxContainer","global",'websitekpi=' + mboxValue);
						  // omConsole("[OM] T&T - create global - kpi - " + mboxValue);
					   } else {
                           // update the global mbox with the KPI using a parameter
						  mboxUpdate('global', 'websitekpi=' + mboxValue);
						  // omConsole("[OM] T&T - update global - kpi - " + mboxValue);
					   }
                    } catch (Error) { }
				});
			}
		}
	} catch (Error) { }
}

try {
	om_testandtargetTrackKPI(s.eVar30);

	// exception case - multiple kpis need to be sent on the same page for a/b testing
	if ((sOm == "ev_gospel_new_commitment_english")  || (sOm == "ev_gospel_recommitment_english")  || (sOm == "ev_gospel_unknown_commitment_english") || (sOm == "ev_gospel_next_steps_english")) {
			om_testandtargetTrackKPI("Discipleship - Viewed Page - Steps for New Believers");
	}
	if (sOm == "ev_gospel_next_steps_english") {
			om_testandtargetTrackKPI("Submitted Gospel Response Form - Email");
			om_testandtargetTrackKPI("Email - Subscribe");
	}
	if ((sOm == "ev_gospel_new_commitment_english")  || (sOm == "ev_gospel_recommitment_english")  || (sOm == "ev_gospel_unknown_commitment_english")) {
			om_testandtargetTrackKPI("Submitted Gospel Response Form - Email");
	}
	// end exception case

} catch (Error) { }

/* ******************************************************************		*/
/* INLINE + FUNCTION: FB													*/
/* ******************************************************************		*/

function om_fbtrack(sTrackingEvent) {

	try {

	// new pixel and event tracking

	if(!om_fb_included) {

		!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
		n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
		n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
		t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
		document,'script','https://connect.facebook.net/en_US/fbevents.js');

		// determine appropriate pixel

		if (sOm_strHref.indexOf("superbookacademy.com") > 0) {
			fbq('init', '824138227697359');   // Academy
		} else {
			fbq('init', '1566496390231749'); // CBN
		}
		fbq('track', "PageView");

		om_fb_included = true;

	}

	if ((typeof (sOm_Motivation) != "undefined") && (sOm_Motivation != "")) {
		om_fb_motivation = sOm_Motivation;
	} else {
		om_fb_motivation = "none";
	}

	if ((typeof (om_don) != "undefined") && (om_don)) {
		om_prod_SB_member 	= "N";
		om_prod_SB_member_num 	= "0";
		om_prod_SB_dvd 		= "N";
		om_prod_SB_gift		= "N";
		om_prod_SB_member_and_dvd	= "N";
		om_prod_SB_member_and_gift	= "N";
		om_prod_SB_dvd_and_gift	= "N";
		om_prod_SB_member_and_dvd_and_gift	= "N";


		if (om_sFB_Products.toLowerCase().indexOf("sbcc") >=0 ) {
			om_prod_SB_member = "Y";
			// determine membership quantity
			om_prod_SB_member_num_match = om_sFB_Products.toLowerCase().match(/sbcc-([0-9]+)/);
			if (om_prod_SB_member_num_match != null) {
				om_prod_SB_member_num = om_prod_SB_member_num_match[1];
			}
		}
		if (om_sFB_Products.toLowerCase().indexOf("cp") >=0 ) {
			om_prod_SB_dvd = "Y";
		}
		if (om_sFB_Products.toLowerCase().indexOf("superbook") >=0 ) {
			om_prod_SB_gift	= "Y";
		}
		if ((om_prod_SB_member == "Y") && (om_prod_SB_dvd == "Y")) {
			om_prod_SB_member_and_dvd	= "Y";
		}
		if ((om_prod_SB_member == "Y") && (om_prod_SB_gift == "Y")) {
			om_prod_SB_member_and_gift	= "Y";
		}
		if ((om_prod_SB_dvd == "Y") && (om_prod_SB_gift == "Y")) {
			om_prod_SB_dvd_and_gift	= "Y";
		}
		if ((om_prod_SB_member == "Y") && (om_prod_SB_dvd == "Y") && (om_prod_SB_gift == "Y")) {
			om_prod_SB_member_and_dvd_and_gift	= "Y";
		}

       // prevent duplicate calls
        sOm_fbtid = om_getCookie("fbtid");
        if ((typeof (sOm_fbtid) == "undefined") || (sOm_fbtid != om_sTransactionID)) {
        	fbq('track', 'Purchase', {	value: ga_donationAmount, currency: 'USD', order_id: om_sTransactionID, monthly_donation: om_sMonthlyPledge, single_gift: om_sSinglePledge, sb_member: om_prod_SB_member, sb_dvd: om_prod_SB_dvd, sb_gift: om_prod_SB_gift, sb_member_num: om_prod_SB_member_num, sb_member_and_dvd: om_prod_SB_member_and_dvd, sb_member_and_gift: om_prod_SB_member_and_gift, sb_dvd_and_gift: om_prod_SB_dvd_and_gift, sb_member_and_dvd_and_gift: om_prod_SB_member_and_dvd_and_gift, motivation: om_fb_motivation, content_type: 'product', content_ids: [om_sFB_Products]});
            om_setCookie("fbtid", om_sTransactionID, 365, "/");
        }
        
	} else if ((typeof (s.eVar30) != "undefined") && (s.eVar30 != "")) {
		if (s.eVar30.toLowerCase().indexOf("prayed salvation prayer") >=0 ) {
            // prevent duplicate calls
            sOm_fbev = om_getCookie("fbev");
            if ((typeof (sOm_fbev) == "undefined") || (sOm_fbev != "Y")) {
                fbq('trackCustom', "EV", {decision_choice: 'Y', motivation: om_fb_motivation});
                om_setCookie("fbev", "Y", 365, "/");
            }
		} else if (s.eVar30.toLowerCase().indexOf("not ready") >=0 ) {
			fbq('trackCustom', "EV", {decision_choice: 'N'});
		} else if ((s.eVar30.toLowerCase().indexOf("subscribe") >=0) && (s.eVar30.toLowerCase().indexOf("unsubscribe") <0)) {
			fbq('track', "Lead", { content_name: s.eVar30, motivation: om_fb_motivation });
		} else if ((s.eVar30.toLowerCase().indexOf("contest") >=0) && (s.eVar30.toLowerCase().indexOf("superbook") <0)) {
			fbq('track', "Lead", { contest_entry_type: 'cbn - ' + s.eVar30, motivation: om_fb_motivation });
		} else if (s.eVar30.toLowerCase().indexOf("community - request") >=0) {
			fbq('track', "Lead", { resource_requested: s.eVar30, motivation: om_fb_motivation });
		} else if (s.eVar30.toLowerCase().indexOf("community - petition") >=0) {
			fbq('track', "Lead", { petition_signed: s.eVar30, motivation: om_fb_motivation });
		} else if ((s.eVar30.toLowerCase().indexOf("community") >=0) && (s.eVar30.toLowerCase().indexOf("watch online") >=0)) {
			fbq('track', "Lead", { resource_requested: s.eVar30.replace("Community","Community - Request"), motivation: om_fb_motivation });
		} else if ((s.eVar30.toLowerCase().indexOf("contest") >=0) && (s.eVar30.toLowerCase().indexOf("superbook") >=0)) {
			fbq('track', "Lead", { contest_entry_type: 'superbook', motivation: om_fb_motivation });
		} else if (s.eVar30.toLowerCase().indexOf("registration") >=0) {
			fbq('track', "CompleteRegistration", { motivation: om_fb_motivation });
		}
	} else if ((typeof (academy_event) != "undefined") && (academy_event == "purchase") && (typeof (academy_event_value ) != "undefined")) {
		if (sOm_strHref.indexOf("order-received") > 0) {
			fbq('track', 'Purchase', {	value: academy_event_value, currency: 'USD', motivation: om_fb_motivation });
		} else {
			fbq('track', 'InitiateCheckout', {	value: academy_event_value, currency: 'USD', motivation: om_fb_motivation });
		}
	}
	//<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1566496390231749&ev=PageView&noscript=1" /></noscript>

	// end new pixel and event tracking

	} catch (e) { }

}

if (!om_sb_site)  {
	om_fbtrack("");
}


/* ******************************************************************		*/
/* INLINE + FUNCTION: TW													*/
/* ******************************************************************		*/

function om_twtrack(sTrackingEvent) {

	try {

	if(!om_tw_included) {

		!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
		},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
		a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
		om_tw_included = true;
	}

	//  account
	 twq('init','nyeyz'); // News
	// twq('init','nyez2'); // CBN 
  
	twq('track','PageView');

	if ((typeof (om_don) != "undefined") && (om_don)) {		
		twq('track','Purchase', {
		    //required parameters
		    value: ga_donationAmount,
		    currency: 'USD',
		    num_items: om_sFB_Products.split(",").length,
		    content_ids: [om_sFB_Products],
		    content_type: 'product',
		    content_name: 'Donation',
		    order_id: om_sTransactionID
		});
	}
            
	} catch (e) { }

}

if ((!om_sb_site) && (/(\/amhf|confirmamhf|receiptamhf)/.test(sOm_strHref)) ) {
	om_twtrack("");
}

/* ******************************************************************		*/
/* INLINE: BING																*/
/* ******************************************************************		*/
try {

	if (!om_sb_site) {
		(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:"5283096"};o.q=w[u],w[u]=new UET(o),w[u].push("pageLoad")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!=="loaded"&&s!=="complete"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,"script","//bat.bing.com/bat.js","uetq");
	
		if (om_don) {
			// legacy document.write(' <iframe src="//flex.msn.com/mstag/tag/9264ce4c-bf28-43a7-91cb-6b6c3e2d427e/analytics.html?dedup=1&domainId=878711&type=1&revenue=' + ga_donationAmount + '&actionid=228375" frameborder="0" scrolling="no" width="1" height="1" style="visibility:hidden;display:none"> </iframe> ');
			window.uetq = window.uetq || []; window.uetq.push({ 'ec': 'Donation', 'ea': 'Donation', 'el': 'Donation', 'ev': ga_donationAmount, 'gv': ga_donationAmount });
		}
	
		/* <img src="//bat.bing.com/action/0?ti=5283096&Ver=2" height="0" width="0" style="display:none; visibility: hidden;" /> */
	}
} catch (e) { }

/* ******************************************************************		*/
/* INLINE + FUNCTION: Quantcast												*/
/* ******************************************************************		*/

var _qevents = _qevents || [];
_qoptions = {
	tags: "Site",
	qacct: "p-39bCOQJyrghjE"
};


function om_quanttrack(sTrackingEvent) {

try {

// code removed
    
} catch (Error) { }

}


if ((!om_sb_site) && (sOm_strHref.indexOf("/special/protectyourhealth/watchform") <0) && (sOm_strHref.indexOf("/giving/special/healthlit") <0)) {
	om_quanttrack("");
}



/* ******************************************************************		*/
/* INLINE: Modification to Journey Transcript - temporary fix				*/
/* ******************************************************************		*/
	try {

		if (sOm_strHref.indexOf("www1.cbn.com/journey") >=0) {
			 $(document).ready(function () {
				$(".transcript.collapsed").removeClass("collapsed");
			 });
		}
    } catch (Error) { }


/* ******************************************************************		*/
/* INLINE + FUNCTION: MC													*/
/* ******************************************************************		*/

if ((!om_sb_site) && (om_don) && (/(receiptcleanwater.aspx|receiptamhf.aspx|receiptcbnnews.aspx)/.test(sOm_strHref))) { 
    
    try {
        if (cbn_obj.id == "Value_Not_Set") {
            om_mc_contactid = "unknown - " + om_sTransactionID;
        } else {
            om_mc_contactid = cbn_obj.id;
        }   
        if (sOm_strHref.indexOf("receiptcleanwater.aspx") >=0) {
            om_mc_storeid = "5a7d086d2db68";
        } else if (sOm_strHref.indexOf("receiptamhf.aspx") >=0) {
            om_mc_storeid = "5a7de6ec4eaac";
        } else if (sOm_strHref.indexOf("receiptcbnnews.aspx") >=0) {
            om_mc_storeid = "5a7dfd6584823";
        }
        $.get("https://impact.cbn.com/mc_orderadd.php", { store:  om_mc_storeid, trx_id: om_sTransactionID, amt: om_donationAmount, product_id: om_sTT_Products, email: om_sDonationEmail, cust_id: om_mc_contactid, url: s.pageName });
    } catch (Error) { }
}

/* ******************************************************************	*/
/* END CBN CUSTOM CODE													*/
/* ******************************************************************	*/

/************************** CONFIG SECTION **************************/
/* You may add or alter any code config here. */
/* Conversion Config */
s.currencyCode="USD"
/* Link Tracking Config */
s.trackDownloadLinks=false
s.trackExternalLinks=false
s.trackInlineStats=true
s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx"
s.linkInternalFilters="javascript:,."
s.linkLeaveQueryString=false
s.linkTrackVars="None"
s.linkTrackEvents="None"
/* Plugin Config */
s.usePlugins=true

s.formList = ""
s.trackFormList = false
s.trackPageName = true
s.useCommerce = true
s.varUsed = "eVar43"
s.eventList = "event25" //Abandon,Success,Error

/* ensure global variables referenced by doPlugins function exist (declared by containing page) */

if (typeof(dfp_sSection1) == "undefined") {
	var dfp_sSection1 = "";
	var dfp_sSection2 = "";
	var dfp_sSection3 = "";
	var dfp_sSection4 = "";
	var dfp_sSection5 = "";
	var dfp_sSection6 = "";
}

if (bAmpPage) {
    dfp_sections = sOm_strHref.replace("https:\/\/","").replace("http:\/\/","").split("\/");
    if (dfp_isArray(dfp_sections)) {
       if (dfp_sections.length > 0) {  dfp_sSection1 = dfp_sections[0]; }
	   if (dfp_sections.length > 1) {  dfp_sSection2 = dfp_sections[1]; }
	   if (dfp_sections.length > 2) {  dfp_sSection3 = dfp_sections[2]; }
	   if (dfp_sections.length > 3) {  dfp_sSection4 = dfp_sections[3]; }
	   if (dfp_sections.length > 4) {  dfp_sSection5 = dfp_sections[4]; }
	   if (dfp_sections.length > 5) {  dfp_sSection6 = dfp_sections[5]; }
    }
}

if (typeof(dfp_sMenu1) == "undefined") {
	var dfp_sMenu1 = "";
	var dfp_sMenu2 = "";
	var dfp_sMenu3 = "";
	var dfp_sMenu4 = "";
	var dfp_sMenu5 = "";
	var dfp_sMenu6 = "";
}
if (typeof(dfp_sCategories) == "undefined") {
	var dfp_sCategories = "";
}
if (typeof(dfp_sTopics) == "undefined") {
	var dfp_sTopics = "";
}
if (typeof(dfp_sKeywords) == "undefined") {
	var dfp_sKeywords = "";
}
if (typeof(dfp_sNode) == "undefined") {
	var dfp_sNode = "";
}



/* ************************************************************************************** */
/* INLINE: Chartbeat 	- required global variables for reference in s_doPlugins(s) below */
/* ************************************************************************************** */
if (om_sb_site) {
	if (typeof(_sf_startpt) == "undefined") {
		 var _sf_async_config={};
		 var _sf_startpt = (new Date()).getTime();
	}
}

/************************** PLUGIN FUNCTION **************************/

function s_doPlugins(s) {
	/* Add calls to plugins here - this function is called by the Adobe Tracking library prior to sending tracking call in s.t() */

	/* Set Page View Event */
	s.events=s.apl(s.events,'event2',',',2)

	/* External Campaign Tracking */
	if(!s.campaign)
		s.campaign=s.Util.getQueryParam('cpid')
	s.campaign = s.getValOnce(s.campaign, 's_campaign', 0)
	if (!s.eVar94)
		s.eVar94=s.Util.getQueryParam('cid')
	if (!s.eVar96)
		s.eVar96=s.Util.getQueryParam('bid')

	/* Time Parting  -  Needs to be updated each year*/
	s.prop8=s.getTimeParting('h','-5'); // Set hour
	s.prop9=s.getTimeParting('d','-5'); // Set day
	s.prop10=s.getTimeParting('w','-5'); // Set Weekend / Weekday

	/*getNewRepeat*/
	s.prop21=s.getNewRepeat();
	/*setCookie*/
	try {
		om_setCookie("rpt", s.prop21, 365, "/")
	} catch (Error) { }


	/* Featured Content Tracking */
	if(!s.eVar13)
		s.eVar13=s.Util.getQueryParam('intcmp')
	if(s.eVar13) {
		s.events=s.apl(s.events,"event6",",",2);
		s.eVar13 = s.eVar13.toLowerCase()
	}


	/* Internal Search Tracking */
	// logic to set prop7 is now above (to prevent pages that use the q paramater from being incorrectly logged here)
	// if(!s.prop7)
	//	s.prop7=s.Util.getQueryParam('q')
	if (s.prop7) {
		s.prop7=s.prop7.toLowerCase()
		if(s.prop7){
			s.eVar7=s.prop7
		var t_search=s.getValOnce(s.eVar7,'ev1',0)
		if(t_search)
			s.events=s.apl(s.events,"event1",",",2)
		}
	}
	// also set the Search Type
	if (s.prop71) {
		s.eVar71=s.prop71;
	}

try {
	/* standardize host name and paths for selected domains */
	if (typeof (om_URL.host) != "undefined") {om_URL.host=om_URL.host.replace(/((www1|secure|static|specials|m|vb|nv|go|blogs|cdn)\.cbn\.com)/,"www.cbn.com")};
	if (typeof (s.channel) != "undefined") {s.channel=s.channel.replace(/((www1|secure|static|specials|m|vb|nv|go|blogs|cdn)\.cbn\.com)/,"www.cbn.com")};
	if (typeof (s.hier1) != "undefined") {s.hier1=s.hier1.replace(/((www1|secure|static|specials|m|vb|nv|go|blogs|cdn)\.cbn\.com)/,"www.cbn.com")};
	if (typeof (s.prop1) != "undefined") {s.prop1=s.prop1.replace(/((www1|secure|static|specials|m|vb|nv|go|blogs|cdn)\.cbn\.com)/,"www.cbn.com")};
	if (typeof (s.prop2) != "undefined") {s.prop2=s.prop2.replace(/((www1|secure|static|specials|m|vb|nv|go|blogs|cdn)\.cbn\.com)/,"www.cbn.com")};
	if (typeof (s.prop3) != "undefined") {s.prop3=s.prop3.replace(/((www1|secure|static|specials|m|vb|nv|go|blogs|cdn)\.cbn\.com)/,"www.cbn.com")};

	/* Update the section tracking if page_obj is available */
	// configure menu variables for ad units and section tracking

	if (typeof (page_obj) == "undefined") {
			if ((sOm_strHref.indexOf("/media/radio/") >=0) || (sOm_strHref.indexOf("/media/radio-embed/") >=0)) {
				page_obj = { categories:"Radio", keywords:"Radio", menu_heirarchy:"CBNRadio,RadioPlayer",show:"",topics:"",video_type:""};
			} else if ((sOm_strHref.indexOf("four0four.aspx") >=0) || (document.title.indexOf("Page Not Found") >=0)) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"page not found",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/radio/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"CBNRadio,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/cbnnews") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"",show:"",topics:"",video_type:""}; // code below to populate menu values
			} else if ((sOm_strHref.indexOf("devotional-email-signup") >=0) || (sOm_strHref.indexOf("daily-devotion-email-signup") >=0))   {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,SpiritualLife,Devotions,",show:"",topics:"",video_type:""};
			} else if ((sOm_strHref.indexOf("spiritual-life/church-directory") >=0) || (sOm_strHref.indexOf("cbn.com/contact/feedback-church") >=0))  {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,SpiritualLife,ChurchFinder,",show:"",topics:"",video_type:""};
			} else if (((sOm_strHref.indexOf("/700club/") >=0) || (sOm_strHref.indexOf("event.cbn.com/700club") >=0)) && (sOm_strHref.indexOf("/giving/") <0) && (sOm_strHref.indexOf("/source/") <0) && (sOm_strHref.indexOf("interactive") <0))  {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"CBNShows,The700Club,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/entertainment/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,Entertainment,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/family/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,Family,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/finance/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,Finance,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/health/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,Health,",show:"",topics:"",video_type:""};
			} else if ((sOm_strHref.indexOf("/about/") >=0) && (sOm_strHref.indexOf("/partners/") <0)) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"about,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/cbnmusic/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,Entertainment,Music,",show:"",topics:"",video_type:""};
			} else if ((sOm_strHref.indexOf("/tv/") >=0) || (sOm_strHref.indexOf("cbn.com/videos/") >=0) || (sOm_strHref.indexOf("/video-search") >=0)) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"WatchVideo,",show:"",topics:"",video_type:""};
			} else if (((sOm_strHref.indexOf("/stepstopeace/") >=0) || (sOm_strHref.indexOf("/contact/feedback-salvation") >=0)) && ((sOm_strHref.indexOf("hopedev") <0) && (sOm_strHref.indexOf("hope.cbn.com") <0))) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,SpiritualLife,KnowGod?,Topical,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/contact/prayer") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,SpiritualLife,Prayer,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/spirituallife/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,SpiritualLife,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/journey") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"ChristianLiving,SpiritualLife,Journey,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/employment") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"job-openings,",show:"",topics:"",video_type:""};
			} else if (s.channel.indexOf("www.cbn.com/index.aspx") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"CBNHome,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/healthyliving/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,healthy-living,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/hurdontheweb/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,hurd-on-the-web,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/stakelbeckonterror/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,watchman,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/jerusalemdateline/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,jerusalem-dateline,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/beltwaybuzz/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,beltway-buzz,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/thebrodyfile/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,brody-file,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/studio5/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,studio5,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/globallane/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,global-lane,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/newsroomtalk/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,newsroom-talk,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/the-link-blog/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,the-link,blog,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("cbn.com/news/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/news/faithinaction/") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"cbnnews,faithinaction,",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("mundocristiano") >=0) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"mundocristiano",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/partners/video") >=0)   {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"partners,video-library",show:"",topics:"",video_type:""};
			} else if ((sOm_strHref.indexOf("/partners") >=0) || (sOm_strHref.indexOf("/cbn-partners") >=0))   {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"partners",show:"",topics:"",video_type:""};
			} else if ((sOm_strHref.indexOf("cbn.com/community") >=0) || (sOm_strHref.indexOf("cbn.com/login") >=0)) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"community",show:"",topics:"",video_type:""};
			} else if ((sOm_strHref.indexOf("cbn.com/contact") >=0) && (sOm_strHref.indexOf("superbook") <0)) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"contact",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/activate/superbook") >=0) {
				if (typeof (s.channel) != "undefined") { s.channel = s.channel.replace("activate","superbook")};
			} else if ((sOm_strHref.indexOf("blogs.cbn.com") >=0) || (sOm_strHref.indexOf("cbn.com/node") >=0) || (sOm_strHref.indexOf("cbn.com/mycbn") >=0) || (sOm_strHref.indexOf("www1.cbn.com") >=0)) {
				page_obj = { categories:"", keywords:"", menu_heirarchy:"",show:"",topics:"",video_type:""};
			} else if (sOm_strHref.indexOf("/source/giving/") >=0) {
				// group under giving
				if (typeof (s.channel) != "undefined") { s.channel = s.channel.replace("source","giving")};
				if (typeof (s.hier1) != "undefined") { s.hier1 = s.hier1.replace("source","giving")};
				if (typeof (s.prop2) != "undefined") { s.prop1=s.prop2.replace("source/","")};
				if (typeof (s.prop3) != "undefined") { s.prop2=s.prop3.replace("source/","")};
				if (typeof (s.prop2) != "undefined") { s.prop3=s.prop2};
			}
	}

	if (typeof (page_obj) != "undefined") {

		// temporary fixes for missing menu structures
			// only manually update if not cbn news content or page not found
			if ((sOm_strHref.indexOf("/cbnnews/") <0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("page not found")<0)) {
				// site home?
				if ((page_obj.menu_heirarchy == "") && (page_obj.topics == "CBNHome")) { page_obj.menu_heirarchy = "CBNHome" };
				// devotional article?
				if ((page_obj.categories.toLowerCase().indexOf("devotions")>=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("devotions")<0)) {page_obj.menu_heirarchy = page_obj.menu_heirarchy + "Devotions," };
				// onlinediscipleship
				if ((sOm_strHref.indexOf("/onlinediscipleship/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("SpiritualLife")<0)) { page_obj.menu_heirarchy = "ChristianLiving,SpiritualLife,onlinediscipleship," + page_obj.menu_heirarchy  };
				// biblestudy
				if ((sOm_strHref.indexOf("/biblestudy/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("SpiritualLife")<0)) { page_obj.menu_heirarchy = "ChristianLiving,SpiritualLife,biblestudy," + page_obj.menu_heirarchy  };
				// courses
				if ((sOm_strHref.indexOf("/course/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("Courses")<0)) { 
						if (page_obj.menu_heirarchy.toLowerCase().indexOf("christianliving")<0) { 
							page_obj.menu_heirarchy = "ChristianLiving,SpiritualLife,Courses," + page_obj.menu_heirarchy;
						} else {	
							page_obj.menu_heirarchy = page_obj.menu_heirarchy + "Courses," ;
						}
				}
				// churchandministry
				if ((sOm_strHref.indexOf("/churchandministry/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("SpiritualLife")<0)) { page_obj.menu_heirarchy = "ChristianLiving,SpiritualLife,churchandministry," + page_obj.menu_heirarchy  };
				// spiritual-life
				if ((sOm_strHref.indexOf("/spiritual-life/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("SpiritualLife")<0)) { page_obj.menu_heirarchy = "ChristianLiving,SpiritualLife" + page_obj.menu_heirarchy  };
				// family section
				if ((sOm_strHref.indexOf("/family/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("family")<0)) { page_obj.menu_heirarchy = "ChristianLiving,Family," + page_obj.menu_heirarchy };
				// health section
				if ((sOm_strHref.indexOf("/health/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("health")<0)) { page_obj.menu_heirarchy = "ChristianLiving,Health," + page_obj.menu_heirarchy };
				// sports section
				if ((sOm_strHref.indexOf("/sports/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("sports")<0)) { page_obj.menu_heirarchy = "ChristianLiving,Sports," + page_obj.menu_heirarchy };
				// search
				if ((sOm_strHref.indexOf("/cbn-search") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("cbn-search")<0)) { page_obj.menu_heirarchy = "cbn-search," + page_obj.menu_heirarchy };
				// profiles section
				if ((sOm_strHref.indexOf("/profiles/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("about")<0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("profiles")<0)) { page_obj.menu_heirarchy = "about,profiles," + page_obj.menu_heirarchy };
				// partners section
				if ( ((sOm_strHref.indexOf("/partners") >=0) || (sOm_strHref.indexOf("/about/cbn-partners") >=0) || (sOm_strHref.indexOf("/about/cbn-staff") >=0) || (sOm_strHref.indexOf("/about/annual-financial") >=0)) && (page_obj.menu_heirarchy.toLowerCase().indexOf("partners")<0)) { page_obj.menu_heirarchy = "partners," + page_obj.menu_heirarchy };
				// job-openings section
				if (((sOm_strHref.indexOf("/job/") >=0) || (sOm_strHref.indexOf("cbn.com/jobs") >=0) || (sOm_strHref.indexOf("cbn.com/about/jobs") >=0)) && (page_obj.menu_heirarchy.toLowerCase().indexOf("job-openings")<0)) { page_obj.menu_heirarchy = "job-openings," + page_obj.menu_heirarchy };
				// radio section
				if ((sOm_strHref.indexOf("/radio/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("radio")<0)) { page_obj.menu_heirarchy = "CBNRadio," + page_obj.menu_heirarchy };
				// 700 club section
				if ((sOm_strHref.indexOf("/700club/") >=0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("700club")<0) && (sOm_strHref.indexOf("/giving/") <0) && (sOm_strHref.indexOf("/source/") <0) ) { page_obj.menu_heirarchy = "CBNShows,The700Club,Content," + page_obj.menu_heirarchy };
				// watch video section - ensure watchvideo is the top menu item
				if ((page_obj.menu_heirarchy.toLowerCase().indexOf("watchvideo")>0) && (page_obj.menu_heirarchy.toLowerCase().indexOf("watchvideo")!=0)) {
					// move watch video to become primary section - needed as videos are reused under shows and under cbn tv but menu structure and template are different
					page_obj.menu_heirarchy = "WatchVideo," + page_obj.menu_heirarchy.replace("WatchVideo,","");
				}
	 		 }
			// unknown section - use sub-section if possible
			if ((page_obj.menu_heirarchy == "")  && (dfp_sSection2 != "")) {
				if (sOm_strHref.indexOf("cbn.com/cbnnews") >= 0) {
					page_obj.menu_heirarchy = dfp_sSection2 + "," ;
				} else {
					page_obj.menu_heirarchy = "content," + dfp_sSection2 + "," ;
				}
				if (dfp_sSection3 != "") { page_obj.menu_heirarchy = page_obj.menu_heirarchy + dfp_sSection3 + "," };
				if (dfp_sSection4 != "") { page_obj.menu_heirarchy = page_obj.menu_heirarchy + dfp_sSection4 + "," };
			}

			var menu_sections = page_obj.menu_heirarchy.replace(/ |\[|\]/g, '').replace(/#(.)+,/,',').replace(/\?(.)+,/,',').replace(/[\?\#]/,"").replace(/,$/, "").replace("700ClubCBNShows","CBNShows").split(",");
			if (om_isArray(menu_sections)) {
			 	if (menu_sections.length > 0) {
					dfp_sMenu1 = menu_sections[0];
					s.channel = om_URL.host + " > " + menu_sections[0];
					s.hier1 = s.channel;
				}
				if (menu_sections.length > 1) {
					dfp_sMenu2 = menu_sections[1];
					s.prop1 = s.channel + " > " + menu_sections[1]; s.eVar1 = s.prop1;
				} else {
					s.prop1 = s.channel; s.eVar1 = s.prop1;
				}
				if (menu_sections.length > 2) {
					dfp_sMenu3 = menu_sections[2];
					s.prop2 = s.prop1 + " > " + menu_sections[2]; s.eVar2 = s.prop2;
				} else {
					s.prop2 = s.prop1; s.eVar2 = s.prop2;
				}
				if (menu_sections.length > 3) {
					dfp_sMenu4 = menu_sections[3];
					s.prop3 = s.prop2 + " > " + menu_sections[3]; s.eVar3 = s.prop3;
				} else {
					s.prop3 = s.prop2; s.eVar3 = s.prop3;
				}
				if (menu_sections.length > 4) {  dfp_sMenu5 = menu_sections[4]; }
		   }

	      dfp_sCategories = page_obj.categories.split(",").sort().join(",").replace(/\s+/g, " ").replace(/'/g,"").replace(/[^a-z0-9]/gmi, " ");
	      dfp_sTopics = page_obj.topics.split(",").sort().join(",").replace(/\s+/g, " ").replace(/'/g,"").replace(/[^a-z0-9]/gmi, " ");
	      dfp_sKeywords = ""; // page_obj.keywords.replace(/'/g,"").split(",").sort().join(",").replace(/\s+/g, " ").replace(/[^a-z0-9]/gmi, " ");
	}
    // append custom topics
    if ((dfp_sTopics.toLowerCase().indexOf("islam")<0) && (/(islam|iran|iraq|muslim|isis|akbar)/.test(sOm_strHref + " " + sOm_strPageTitle.toLowerCase()))) { 
        dfp_sTopics = "Islam " + dfp_sTopics; 
        s.prop52 = "islam, " + s.prop52;
        s.eVar52 = "islam, " + s.eVar52;
    };
	if ((dfp_sTopics.toLowerCase().indexOf("disaster")<0) && (/(hurricane|tornado|flood|harvey|irma|katrina|shooting|survivor|disaster)/.test(sOm_strHref + " " + sOm_strPageTitle.toLowerCase()))) { 
        dfp_sTopics = "Disaster " + dfp_sTopics; 
        s.prop52 = "disaster, " + s.prop52;
        s.eVar52 = "disaster, " + s.eVar52;
    };
     if ((dfp_sTopics.toLowerCase().indexOf("israel")<0) && (/(israel|jerusalem|jew|temple mount|tabernacle)/.test(sOm_strHref + " " + sOm_strPageTitle.toLowerCase()))) { 
        dfp_sTopics = "Israel " + dfp_sTopics; 
        s.prop52 = "israel, " + s.prop52;
        s.eVar52 = "israel, " + s.eVar52;
    };
	// additional dfp parameter
	if (typeof jQuery != 'undefined') {
		if( $('link[rel=shortlink]').eq(0).attr('href')) { 
			dfp_sNode = $('link[rel=shortlink]').eq(0).attr('href'); 
		}
	}

} catch (Error) { }

	// ensure all sub-sections contain values (parent section value if no sub-directory exists)
	if (s.prop1 == "Value_Not_Set") {s.prop1 = s.channel};
	if (s.prop2 == "Value_Not_Set") {s.prop2 = s.prop1};
	if (s.prop3 == "Value_Not_Set") {s.prop3 = s.prop2};

	/* Copy props to eVars */
	if(s.pageName&&!s.eVar11) s.eVar11=s.pageName;
	if(s.channel&&!s.eVar12) s.eVar12=s.channel;
	if(s.prop1&&!s.eVar1) s.eVar1=s.prop1;
	if(s.prop2&&!s.eVar2) s.eVar2=s.prop2;
	if(s.prop3&&!s.eVar3) s.eVar3=s.prop3;
	if(s.prop4&&!s.eVar4) s.eVar4=s.prop4;
	if(s.prop5&&!s.eVar5) s.eVar5=s.prop5;
	if(s.prop6&&!s.eVar6) s.eVar6=s.prop6;
	if(s.prop8&&!s.eVar8) s.eVar8=s.prop8;
	if(s.prop9&&!s.eVar9) s.eVar9=s.prop9;
	if(s.prop10&&!s.eVar10) s.eVar10=s.prop10;
	if(s.prop21&&!s.eVar21) s.eVar21=s.prop21;
	if(s.prop15&&!s.eVar15) s.eVar15=s.prop15;
	if(s.prop25&&!s.eVar25) s.eVar25=s.prop25;
	if(s.prop26&&!s.eVar26) s.eVar26=s.prop26;
	if(s.prop38&&!s.eVar38) s.eVar38=s.prop38;
	if(s.prop61&&!s.eVar61) s.eVar61=s.prop61;
	if (s.prop14 && !s.eVar39) s.eVar39 = s.prop14;
	if (s.prop69 && !s.eVar69) s.eVar69 = s.prop69;

	/* Copy eVars to props */
	if(s.eVar30&&!s.prop30) s.prop30=s.eVar30;

	/* All Traffic Sources plugin */
	/*
	s.allTrafficSources('cpid','organic:');
	s.prop22=s.eVar22=s.atsCampaign;
	s.prop23=s.eVar23=s.atsKeywords;
	s.prop24=s.eVar24=s.atsChannel;
	*/

	if(s.eVar22) {	s.events=s.apl(s.events,'event22',',',2);	s.ClickThroughCheck1="1"}
	if(!s.eVar22)s.ClickThroughCheck1="2";
	s.ClickThroughCheck2=s.getPreviousValue(s.ClickThroughCheck1,'ctc2','');
	if(!s.eVar22&&s.ClickThroughCheck2=="1") s.events=s.apl(s.events,'event23',',',2);


	/* CustomVisNum & Resetting New vs Repeat */
	s.prop32=s.eVar32=s.getVisitNumCustom('d'); // daily visits
	s.prop33=s.eVar33=s.getVisitNumCustom('w'); // weekly visits
	s.prop34=s.eVar34=s.getVisitNumCustom('m'); // monthly visits
	if (s.eVar32=="1" && s.eVar32) {s.prop35=s.eVar35="New";} else  if (s.eVar32!="1" && s.eVar32){s.prop35=s.eVar35="Repeat";}  	// daily new vs repeat
	if (s.eVar33=="1" && s.eVar33) {s.prop36=s.eVar36="New";} else  if (s.eVar33!="1" && s.eVar33){s.prop36=s.eVar36="Repeat";}  	// weekly new vs repeat
	if (s.eVar34=="1" && s.eVar34) {s.prop37=s.eVar37="New";} else  if (s.eVar34!="1" && s.eVar34){s.prop37=s.eVar37="Repeat";} 	// monthly new vs repeat

	/* Form Analysis Plugin */
	// only enable Form analysis on selected pages
	/*
	try {
		if ((sOm_strHref.indexOf("option.aspx") > -1) || (sOm_strHref.indexOf("contribute.aspx") > -1)) {
			s.setupFormAnalysis();
		}
	} catch (Error) { }
	*/

	/*Cross Visit Participation
	//Function crossVisitParticipation(v,cn,ex,ct,dl,ev,dv)*/
	/*********************************************************************
	*	PARAMETERS:
	*		v  = value to stack
	*		cn = name of the cookie storing the list of values
	*		ex = expiration (in days) of each value in the list
	*		ct = number of distinct values to store in the list
	*		dl = value delimiter
	*		ev = (optional) Comma seperated list of success events that will clear the list
	*		dv = (optional) whether consecutive duplicate values will be stored (0=no, 1=yes)
	*
	*********************************************************************/
	s.eVar44 = s.crossVisitParticipation(s.campaign, 's_ev', '14', '4', '>', '', ''); // cpid
	s.eVar55 = s.crossVisitParticipation(s.eVar13, 's_ev55', '14', '4', '>', '', ''); //intmcp


	/* ******************************************************************		*/
	/* INLINE: Chartbeat 														*/
	/* ******************************************************************		*/


	try {

	// only include if tracking correctly configured (header include in app_smart_banner.js not present on all pages)
	if (typeof(_sf_startpt) != "undefined") {

	    /** CONFIGURATION START **/
	    _sf_async_config.uid = 61703;
	    _sf_async_config.domain = 'cbn.com';
	    _sf_async_config.useCanonical = true;
		_sf_async_config.sections = "Section Not Specified";
		if (s.prop1.toLowerCase().indexOf("cbnnews") >= 0) {
				_sf_async_config.sections = "CBN News";
		} else if (om_sb_site) {
				_sf_async_config.sections = "Superbook";
		} else {
				_sf_async_config.sections = "CBN.com";
		}
		if (document.querySelector('div[property="schema:author"] a') != null) {
			_sf_async_config.authors = document.querySelector('div[property="schema:author"] a').text;
		} else {
			_sf_async_config.authors = "Author Not Specified";
		}
	    /** CONFIGURATION END **/
	    (function(){
	      function loadChartbeat() {
	        window._sf_endpt=(new Date()).getTime();
	        var e = document.createElement('script');
	        e.setAttribute('language', 'javascript');
	        e.setAttribute('type', 'text/javascript');
	        e.setAttribute('src', '//static.chartbeat.com/js/chartbeat.js');
	        document.body.appendChild(e);
	      }
	      var oldonload = window.onload;
	      window.onload = (typeof window.onload != 'function') ?
	         loadChartbeat : function() { oldonload(); loadChartbeat(); };
	    })();

	}

	} catch (Error) { }


}
s.doPlugins=s_doPlugins

/* ******************************************************************		*/
/* INLINE: CBN NEWS ARTICLE CTA	/ PROMO										*/
/* ******************************************************************		*/
/*
function ctaRun(selector,n) {
    try { 
        var j = selector.length;
        if (j > n) {
            selector.prepend( '<div class="news-promo-area" style="margin-bottom:20px;"><!--<strong>SPECIAL ONE-NIGHT EVENT IN SELECT CINEMAS</strong><br><i>In Our Hands: The Battle for Jerusalem</i><br>A CBN Documentaries Film<br>--><a href="http://inourhands1967.com/?cpid=news_article_promo_ioh&utm_source=cbn_news_article&utm_campaign=cbn_ioh&utm_medium=website" target="_blank" border=0 style="color:#B83D00;font-weight:800;"><img src="http://dl2.cbn.com/ads/InOurHands_970x250banner_encore_6.jpg" width="100%" alt="In Our Hands: The Battle for Jerusalem. Get Tickets"></a></div>' );
        } else {
            setTimeout(function () {
                ctaRun(selector,n);                                                                                                 
            }, 300);
        }
    } catch (e) { } 
}; 

try { 
    if (typeof(jQuery) != undefined) {
    	jQuery( document ).ready(function() {
            if ((sOm_strHref.indexOf("/cbnnews/") > -1) || (s.channel.toLowerCase().indexOf("cbnnews") > -1)) {
                var found=false;
                var parCount = 0;
                jQuery(".node-cbn-news.node-full .field-name-body .field-item").find('*').each(function(index) {   
                    
                    if (jQuery(this).is("p") || jQuery(this).is("div")) {
                        if (!jQuery(this).attr('class')) {
                            parCount++;
                        }
                    }
                    if ( (parCount==4) && !found) {
                        found = true;
                        ctaRun(jQuery(this).after(),0);
                    }
	           });
	         }
        });
    }  
} catch (e) { } 

*/

/* ******************************************************************		*/
/* INLINE: CBN PARTNER SECTION CAUSE LINKS									*/
/* ******************************************************************		*/

try { 
    if (typeof(jQuery) != undefined) {
    	jQuery( document ).ready(function() {
            if ((sOm_strHref.indexOf("/cbn-partners/") > -1) && ((sOm_strHref.indexOf("?p=") > -1) || (sOm_strHref.indexOf("&p=") > -1))) {
                var om_param_p =  getURLParam("p");
                var om_param_o =  getURLParam("o");
                jQuery(".call-to-action").find('a').each(function(index) {   
                       if ((jQuery(this).attr("href").indexOf("/giving/") > 0) && (om_param_p != "") && (om_param_o == "")) {
                            // modify to link directly to cause donation
                            if(jQuery(this).attr("href").indexOf("?") < 0) {
                                jQuery(this).attr("href", jQuery(this).attr("href") + "?o=2&p=" + om_param_p) ;
                            } else {
                                jQuery(this).attr("href", jQuery(this).attr("href") + "&o=2&p=" + om_param_p) ;
                            }
                        }
	           });
	         }
        });
    }  
} catch (e) { } 



/************************** PLUGINS SECTION ************************		*/
/* You may insert any plugins you wish to use here.                 		*/


/*
 * Plugin: getTimeParting 2.0
 */
s.getTimeParting=new Function("t","z","y","l",""
+"var s=this,d,A,U,X,Z,W,B,C,D,Y;d=new Date();A=d.getFullYear();Y=U=S"
+"tring(A);if(s.dstStart&&s.dstEnd){B=s.dstStart;C=s.dstEnd}else{;U=U"
+".substring(2,4);X='090801|101407|111306|121104|131003|140902|150801"
+"|161306|171205|181104|191003';X=s.split(X,'|');for(W=0;W<=10;W++){Z"
+"=X[W].substring(0,2);if(U==Z){B=X[W].substring(2,4);C=X[W].substrin"
+"g(4,6)}}if(!B||!C){B='08';C='01'}B='03/'+B+'/'+A;C='11/'+C+'/'+A;}D"
+"=new Date('1/1/2000');if(D.getDay()!=6||D.getMonth()!=0){return'Dat"
+"a Not Available'}else{z=z?z:'0';z=parseFloat(z);B=new Date(B);C=new"
+" Date(C);W=new Date();if(W>B&&W<C&&l!='0'){z=z+1}W=W.getTime()+(W.g"
+"etTimezoneOffset()*60000);W=new Date(W+(3600000*z));X=['Sunday','Mo"
+"nday','Tuesday','Wednesday','Thursday','Friday','Saturday'];B=W.get"
+"Hours();C=W.getMinutes();D=W.getDay();Z=X[D];U='AM';A='Weekday';X='"
+"00';if(C>30){X='30'}if(B>=12){U='PM';B=B-12};if(B==0){B=12};if(D==6"
+"||D==0){A='Weekend'}W=B+':'+X+U;if(y&&y!=Y){return'Data Not Availab"
+"le'}else{if(t){if(t=='h'){return W}if(t=='d'){return Z}if(t=='w'){r"
+"eturn A}}else{return Z+', '+W}}}");





/*
 * Plugin: getNewRepeat 1.0 - Return whether user is new or repeat
 */
s.getNewRepeat=new Function(""
+"var s=this,e=new Date(),cval,ct=e.getTime(),y=e.getYear();e.setTime"
+"(ct+30*24*60*60*1000);cval=s.c_r('s_nr');if(cval.length==0){s.c_w("
+"'s_nr',ct,e);return 'New';}if(cval.length!=0&&ct-cval<30*60*1000){s"
+".c_w('s_nr',ct,e);return 'New';}if(cval<1123916400001){e.setTime(cv"
+"al+30*24*60*60*1000);s.c_w('s_nr',ct,e);return 'Repeat';}else retur"
+"n 'Repeat';");





/*
 * Plugin: getQueryParam 2.3
 */
s.getQueryParam=new Function("p","d","u",""
+"var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.locati"
+"on);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p"
+".length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t){t=t.indexOf('#')>-"
+"1?t.substring(0,t.indexOf('#')):t;}if(t)v+=v?d+t:t;p=p.substring(i="
+"=p.length?i:i+1)}return v");
s.p_gpv=new Function("k","u",""
+"var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v"
+"=s.pt(q,'&','p_gvf',k)}return v");
s.p_gvf=new Function("t","k",""
+"if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'T"
+"rue':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s."
+"epa(v)}return ''");



/*
 * Plugin: getValOnce 0.2 - get a value once per session or number of days
 */
s.getValOnce=new Function("v","c","e",""
+"var s=this,k=s.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime("
+")+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v");



/*
 * Utility Function: split v1.5 - split a string (JS 1.0 compatible)
 */
s.split=new Function("l","d",""
+"var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x"
+"++]=l.substring(0,i);l=l.substring(i+d.length);}return a");



/*
 * Plugin Utility: apl v1.1
 */
s.apl=new Function("L","v","d","u",""
+"var s=this,m=0;if(!L)L='';if(u){var i,n,a=s.split(L,d);for(i=0;i<a."
+"length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas"
+"e()));}}if(!m)L=L?L+d+v:v;return L");


/*
 * Plugin Utility: Replace v1.0
 */
s.repl=new Function("x","o","n",""
+"var i=x.indexOf(o),l=n.length;while(x&&i>=0){x=x.substring(0,i)+n+x."
+"substring(i+o.length);i=x.indexOf(o,i+l)}return x");

/*
 * Plugin: getPreviousValue_v1.0 - return previous value of designated
 *   variable (requires split utility)
 */
s.getPreviousValue=new Function("v","c","el",""
+"var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el"
+"){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i"
+"){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)"
+":s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?"
+"s.c_w(c,v,t):s.c_w(c,'no value',t);return r}");

/*
 * Plugin: allTrafficSources v1.1
 */
s.allTrafficSources=new Function("a","b","c","d","e","f","g","h","i","j",""
+"var s=this,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,T;A=s.referrer?s.ref"
+"errer:document.referrer;j=j?j:'Typed/Bookmarked';if(!A)B=j;C=A.inde"
+"xOf('?')>-1?A.indexOf('?'):A.length;D=A.substring(0,C);F=s.split(s."
+"linkInternalFilters,',');E=F.length-1;for(G=0;G<=E;G++){H=D.indexOf"
+"(F[G])==-1?'':A;if(H)I=H}J=A.indexOf('//')>-1?A.indexOf('//')+2:0;i"
+"f(!I&&!B){f=f?f:'Paid Search';g=g?g:'Natural Search';h=h?h:'Paid No"
+"n-Search';i=i?i:'Referrers';J=A.indexOf('//')>-1?A.indexOf('//')+2:"
+"0;K=A.indexOf('/',J)>-1?A.indexOf('/',J):C;L=A.substring(J,K);M=L;B"
+"=N=i;C='.google.|q>.yahoo.|p>.msn.|q>.live.|q>.ask.|q>.aol.|query>."
+"myway.|searchfor>.netscape.|query>.altavista.|q>.lycos.|query';C=c?"
+"C+'>'+c:C;D=s.split(C,'>');E=D.length-1;for(G=0;G<=E;G++){F=D[G];F="
+"s.split(F,'|');O=L.indexOf(F[0]);if(O>-1){P=s.getQueryParam(F[1],''"
+",A);if(P)Q=P}}}R=s.getQueryParam(a);if(R){M=R;if(Q){B=N=f}else{B=N="
+"h}}if(!R&&Q){M=b+L;B=N=g}if(Q)Q=Q.toLowerCase();if(M){M=M.toLowerCa"
+"se();M=s.repl(M,'www.','')}T=Q+M;T=s.getValOnce(T,'ats',0);if(d){C="
+"s.split(d,'>');D=C.length;for(G=0;G<=D;G++){if(C[G]){E=s.split(C[G]"
+",'|');F=s.getQueryParam(E[1]);if(F)B=N=E[0]}}}if(e){C=s.split(e,'>'"
+");D=C.length;for(G=0;G<=D;G++){if(C[G]){E=s.split(C[G],'|');F=R.ind"
+"exOf(E[1]);if(F==0)B=N=E[0]}}}if(T){s.atsCampaign=T?M:'';s.atsKeywo"
+"rds=T?Q:'';s.atsChannel=T?N:''}B=s.getValOnce(B,'cs',0);s.atsChanne"
+"lStack=B;");

/*
*  Plugin:  getVisNum Custom v.1  adapted for CBN.com
*/
s.dimo=new Function ("m","y", "var d=new Date(y,m+1,0); return d.getDate();");
s.endof=new Function ("x", "var t = new Date(); t.setHours(0); t.setMinutes(0);"
	+"t.setSeconds(0); if(x=='m') d=s.dimo(t.getMonth(),t.getFullYear()) - t.getDate() + 1;"
	+"else if(x=='w') d=7-t.getDay(); else d=1; t.setDate(t.getDate()+d); return t;");
s.getVisitNumCustom=new Function("tp", ""
+"var s=this,e=new Date(),cval,cvisit,ct=e.getTime(),c='s_vnum_'+tp,c2='sinvisit_'+tp,eo=s.endof(tp),"
+"y=eo.getTime();e.setTime(y);cval=s.c_r(c);if(cval){var i=cval.indexOf('&vn='),str=cval.substring(i+4,cval.length),k;}"
+"cvisit=s.c_r(c2);if(cvisit){if(str){e.setTime(ct+30*60*1000);s.c_w(c2,'true',e);return str;}"
+"else return 'unknown visit number';}"
+"else{if(str){str++;k=cval.substring(0,i);e.setTime(k);s.c_w(c,k+'&vn='+str,e);e.setTime(ct+30*60*1000);s.c_w(c2,'true',e);return str;}"
+"else{s.c_w(c,y+'&vn=1',e);e.setTime(ct+30*60*1000);s.c_w(c2,'true',e);return 1;}}"
);

/*
* Plugin: Form Analysis 2.1 (Abandonment)
*/
s.setupFormAnalysis = new Function(""
+ "var s=this;if(!s.fa){s.fa=new Object;var f=s.fa;f.ol=s.wd.onload;s."
+ "wd.onload=s.faol;f.uc=s.useCommerce;f.vu=s.varUsed;f.vl=f.uc?s.even"
+ "tList:'';f.tfl=s.trackFormList;f.fl=s.formList;f.va=new Array('',''"
+ ",'','')}");
s.sendFormEvent = new Function("t", "pn", "fn", "en", ""
+ "var s=this,f=s.fa;t=t=='s'?t:'e';f.va[0]=pn;f.va[1]=fn;f.va[3]=t=='"
+ "s'?'Success':en;s.fasl(t);f.va[1]='';f.va[3]='';");
s.faol = new Function("e", ""
+ "var s=s_c_il[" + s._in + "],f=s.fa,r=true,fo,fn,i,en,t,tf;if(!e)e=s.wd."
+ "event;f.os=new Array;if(f.ol)r=f.ol(e);if(s.d.forms&&s.d.forms.leng"
+ "th>0){for(i=s.d.forms.length-1;i>=0;i--){fo=s.d.forms[i];fn=fo.name"
+ ";tf=f.tfl&&s.pt(f.fl,',','ee',fn)||!f.tfl&&!s.pt(f.fl,',','ee',fn);"
+ "if(tf){f.os[fn]=fo.onsubmit;fo.onsubmit=s.faos;f.va[1]=fn;f.va[3]='"
+ "No Data Entered';for(en=0;en<fo.elements.length;en++){el=fo.element"
+ "s[en];t=el.type;if(t&&t.toUpperCase){t=t.toUpperCase();var md=el.on"
+ "mousedown,kd=el.onkeydown,omd=md?md.toString():'',okd=kd?kd.toStrin"
+ "g():'';if(omd.indexOf('.fam(')<0&&okd.indexOf('.fam(')<0){el.s_famd"
+ "=md;el.s_fakd=kd;el.onmousedown=s.fam;el.onkeydown=s.fam}}}}}f.ul=s"
+ ".wd.onunload;s.wd.onunload=s.fasl;}return r;");
s.faos = new Function("e", ""
+ "var s=s_c_il[" + s._in + "],f=s.fa,su;if(!e)e=s.wd.event;if(f.vu){s[f.v"
+ "u]='';f.va[1]='';f.va[3]='';}su=f.os[this.name];return su?su(e):tru"
+ "e;");
s.fasl = new Function("e", ""
+ "var s=s_c_il[" + s._in + "],f=s.fa,a=f.va,l=s.wd.location,ip=s.trackPag"
+ "eName,p=s.pageName;if(a[1]!=''&&a[3]!=''){a[0]=!p&&ip?l.host+l.path"
+ "name:a[0]?a[0]:p;if(!f.uc&&a[3]!='No Data Entered'){if(e=='e')a[2]="
+ "'Error';else if(e=='s')a[2]='Success';else a[2]='Abandon'}else a[2]"
+ "='';var tp=ip?a[0]+':':'',t3=e!='s'?':('+a[3]+')':'',ym=!f.uc&&a[3]"
+ "!='No Data Entered'?tp+a[1]+':'+a[2]+t3:tp+a[1]+t3,ltv=s.linkTrackV"
+ "ars,lte=s.linkTrackEvents,up=s.usePlugins;if(f.uc){s.linkTrackVars="
+ "ltv=='None'?f.vu+',events':ltv+',events,'+f.vu;s.linkTrackEvents=lt"
+ "e=='None'?f.vl:lte+','+f.vl;f.cnt=-1;if(e=='e')s.events=s.pt(f.vl,'"
+ ",','fage',2);else if(e=='s')s.events=s.pt(f.vl,',','fage',1);else s"
+ ".events=s.pt(f.vl,',','fage',0)}else{s.linkTrackVars=ltv=='None'?f."
+ "vu:ltv+','+f.vu}s[f.vu]=ym;s.usePlugins=false;var faLink=new Object"
+ "();faLink.href='#';s.tl(faLink,'o','Form Analysis');s[f.vu]='';s.us"
+ "ePlugins=up}return f.ul&&e!='e'&&e!='s'?f.ul(e):true;");
s.fam = new Function("e", ""
+ "var s=s_c_il[" + s._in + "],f=s.fa;if(!e) e=s.wd.event;var o=s.trackLas"
+ "tChanged,et=e.type.toUpperCase(),t=this.type.toUpperCase(),fn=this."
+ "form.name,en=this.name,sc=false;if(document.layers){kp=e.which;b=e."
+ "which}else{kp=e.keyCode;b=e.button}et=et=='MOUSEDOWN'?1:et=='KEYDOW"
+ "N'?2:et;if(f.ce!=en||f.cf!=fn){if(et==1&&b!=2&&'BUTTONSUBMITRESETIM"
+ "AGERADIOCHECKBOXSELECT-ONEFILE'.indexOf(t)>-1){f.va[1]=fn;f.va[3]=e"
+ "n;sc=true}else if(et==1&&b==2&&'TEXTAREAPASSWORDFILE'.indexOf(t)>-1"
+ "){f.va[1]=fn;f.va[3]=en;sc=true}else if(et==2&&kp!=9&&kp!=13){f.va["
+ "1]=fn;f.va[3]=en;sc=true}if(sc){nface=en;nfacf=fn}}if(et==1&&this.s"
+ "_famd)return this.s_famd(e);if(et==2&&this.s_fakd)return this.s_fak"
+ "d(e);");
s.ee = new Function("e", "n", ""
+ "return n&&n.toLowerCase?e.toLowerCase()==n.toLowerCase():false;");
s.fage = new Function("e", "a", ""
+ "var s=this,f=s.fa,x=f.cnt;x=x?x+1:1;f.cnt=x;return x==a?e:'';");

/*
* s.join: 1.0 - s.join(v,p)
*
*  v - Array (may also be array of array)
*  p - formatting parameters (front, back, delim, wrap)
*
*/

s.join = new Function("v", "p", ""
+ "var s = this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back"
+ ":'';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0"
+ ";x<v.length;x++){if(typeof(v[x])=='object' )str+=s.join( v[x],p);el"
+ "se str+=w+v[x]+w;if(x<v.length-1)str+=d;}return f+str+b;");

/*
*	Plug-in: crossVisitParticipation v1.5 - stacks values from
*	specified variable in cookie and returns value
*/

s.crossVisitParticipation = new Function("v", "cn", "ex", "ct", "dl", "ev", "dv", ""
+ "var s=this,ce;if(typeof(dv)==='undefined')dv=0;if(s.events&&ev){var"
+ " ay=s.split(ev,',');var ea=s.split(s.events,',');for(var u=0;u<ay.l"
+ "ength;u++){for(var x=0;x<ea.length;x++){if(ay[u]==ea[x]){ce=1;}}}}i"
+ "f(!v||v=='')return '';v=escape(v);var arry=new Array(),a=new Array("
+ "),c=s.c_r(cn),g=0,h=new Array();if(c&&c!='')arry=eval(c);var e=new "
+ "Date();e.setFullYear(e.getFullYear()+5);if(dv==0 && arry.length>0 &"
+ "& arry[arry.length-1][0]==v)arry[arry.length-1]=[v, new Date().getT"
+ "ime()];else arry[arry.length]=[v, new Date().getTime()];var start=a"
+ "rry.length-ct<0?0:arry.length-ct;var td=new Date();for(var x=start;"
+ "x<arry.length;x++){var diff=Math.round((td.getTime()-arry[x][1])/86"
+ "400000);if(diff<ex){h[g]=unescape(arry[x][0]);a[g]=[arry[x][0],arry"
+ "[x][1]];g++;}}var data=s.join(a,{delim:',',front:'[',back:']',wrap:"
+ "\"'\"});s.c_w(cn,data,e);var r=s.join(h,{delim:dl});if(ce) s.c_w(cn"
+ ",'');return r;");


/* WARNING: Changing any of the below variables will cause drastic
changes to how your visitor data is collected.  Changes should only be
made when instructed to do so by your account manager.*/
s.debugTracking=false
s.trackingServer="metrics.cbn.com"
s.trackingServerSecure="smetrics.cbn.com"
s.visitorNamespace="cbn"
s.dc="122"


/***** UNCOMMENT TO USE THE New Media MODULE *****/


function AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c="s_m";b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l="",g;c||(c=-1);if(d&&e){b.list||(b.list={});b.list[d]&&b.close(d);k&&k.id&&(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&&b.list[g]&&b.list[g].R==l&&b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=
Math.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n="";f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f="";f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v="";f.J="";f.K=0;f.r=!1;f.H="";f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&&c.monitor&&clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&&!f.monitor&&
(f.monitor={},f.monitor.update=function(){1==f.k&&b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e="a.media.",k=d.linkTrackVars,f=d.linkTrackEvents,a="m_i",l,g=d.contextData,h;c.l&&(e+="ad.",c.v&&(g["a.media.name"]=c.v,g[e+"pod"]=c.J,g[e+"podPosition"]=c.K),c.G||(g[e+"CPM"]=c.H));c.r&&(g[e+"clicked"]=
!0,c.r=!1);g["a.contentType"]="video"+(c.l?"Ad":"");g["a.media.channel"]=b.channel;g[e+"name"]=c.name;g[e+"playerName"]=c.playerName;0<c.length&&(g[e+"length"]=c.length);g[e+"timePlayed"]=Math.floor(c.a);0<Math.floor(c.a)&&(g[e+"timePlayed"]=Math.floor(c.a));c.G||(g[e+"view"]=!0,a="m_s",b.Heartbeat&&b.Heartbeat.enabled&&(a=c.l?b.__primetime?"mspa_s":"msa_s":b.__primetime?"msp_s":"ms_s"),c.G=1);c.f&&(g[e+"segmentNum"]=c.m,g[e+"segment"]=c.f,0<c.B&&(g[e+"segmentLength"]=c.B),c.A&&0<c.a&&(g[e+"segmentView"]=
!0));!c.Q&&c.complete&&(g[e+"complete"]=!0,c.S=1);0<c.p&&(g[e+"milestone"]=c.p);0<c.q&&(g[e+"offsetMilestone"]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=",contextData."+h);l=g["a.contentType"];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=""),k&&(k+=",events"),b.contextDataMapping)if(!Object.prototype[h]){a=h.length>e.length&&h.substring(0,e.length)==e?h.substring(e.length):"";l=b.contextDataMapping[h];if("string"==typeof l)for(q=l.split(","),s=0;s<q.length;s++)l=
q[s],"a.contentType"==h?(k&&(k+=","+l),d[l]=g[h]):"view"==a||"segmentView"==a||"clicked"==a||"complete"==a||"timePlayed"==a||"CPM"==a?(f&&(f+=","+l),"timePlayed"==a||"CPM"==a?g[h]&&(d.events2+=(d.events2?",":"")+l+"="+g[h]):g[h]&&(d.events2+=(d.events2?",":"")+l)):"segment"==a&&g[h+"Num"]?(k&&(k+=","+l),d[l]=g[h+"Num"]+":"+g[h]):(k&&(k+=","+l),d[l]=g[h]);else if("milestones"==a||"offsetMilestones"==a)h=h.substring(0,h.length-1),g[h]&&b.contextDataMapping[h+"s"][g[h]]&&(f&&(f+=","+b.contextDataMapping[h+
"s"][g[h]]),d.events2+=(d.events2?",":"")+b.contextDataMapping[h+"s"][g[h]]);g[h]&&(g[h]=0);"segment"==a&&g[h+"Num"]&&(g[h+"Num"]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&&b.list&&b.list[d]?b.list[d]:0)if(a.l&&(t=b.adTrackSeconds,
u=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0>e&&(e=1==a.k&&0<a.u?l-a.u+a.c:a.c),0<a.length&&(e=e<a.length?e:a.length),0>e&&(e=0),a.offset=e,0<a.length&&(a.e=a.offset/a.length*100,a.e=100<a.e?100:a.e),0>a.c&&(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0>a.g?"OPEN":1==c?"PLAY":2==c?"STOP":3==c?"MONITOR":
4==c?"TRACK":5==c?"COMPLETE":7==c?"CLICK":"CLOSE",2<c||c!=a.k&&(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&&(a.c=e);if((3>=c||5<=c)&&0<=a.g&&(r=!1,q=s="None",a.g!=e)){h=a.g;h>e&&(h=a.c,h>e&&(h=e));p=u?u.split(","):0;if(0<a.length&&p&&e>=h)for(n=0;n<p.length;n++)(g=p[n]?parseFloat(""+p[n]):0)&&h/a.length*100<g&&a.e>=g&&(r=!0,n=p.length,m.mediaEvent="MILESTONE",a.p=m.milestone=g);if((p=v?v.split(","):0)&&e>=h)for(n=0;n<p.length;n++)(g=p[n]?parseFloat(""+p[n]):0)&&h<g&&e>=g&&(r=!0,n=p.length,m.mediaEvent=
"OFFSET_MILESTONE",a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&&u&&0<a.length){if(p=u.split(","))for(p.push("100"),n=h=0;n<p.length;n++)if(g=p[n]?parseFloat(""+p[n]):0)a.e<g&&(k=n+1,f="M:"+h+"-"+g,n=p.length),h=g}else if(x&&v&&(p=v.split(",")))for(p.push(""+(0<a.length?a.length:"E")),n=h=0;n<p.length;n++)if((g=p[n]?parseFloat(""+p[n]):0)||"E"==p[n]){if(e<g||"E"==p[n])k=n+1,f="O:"+h+"-"+g,n=p.length;h=g}f&&(a.L=!0)}(f||a.f)&&f!=a.f&&(a.F=!0,a.f||(a.m=k,a.f=f),0<=a.g&&(r=!0));(2<=c||100<=a.e)&&a.c<e&&
(a.C+=e-a.c,a.a+=e-a.c);if(2>=c||3==c&&!a.k)a.n+=(1==c||3==c?"S":"E")+Math.floor(e),a.k=3==c?1:c;!r&&0<=a.g&&3>=c&&(t=t?t:0)&&a.a>=t&&(r=!0,m.mediaEvent="SECONDS");a.u=l;a.c=e}if(!c||3>=c&&100<=a.e)2!=a.k&&(a.n+="E"+Math.floor(e)),c=0,q=s="None",m.mediaEvent="CLOSE";7==c&&(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&&(!c||100<=a.e)&&0<a.length&&e>=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;"MILESTONE"==l?l+="_"+m.milestone:"OFFSET_MILESTONE"==l&&(l+=
"_"+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&&4!=c&&b.monitor(b.s,m);b.Heartbeat&&b.Heartbeat.enabled&&0<=a.g&&(r=!1);0==c&&b.M(d);r&&a.D==y&&(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=""),d.linkTrackEvents||(d.linkTrackEvents=""),b.P(d,a),d.linkTrackVars||(d["!linkTrackVars"]=1),d.linkTrackEvents||(d["!linkTrackEvents"]=
1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0<a.a&&(a.A=!1),a.n="",a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&&(!b.autoTrackMediaLengthRequired||c&&0<c)){if(b.list&&b.list[d])a=1;else if(1==e||3==e)b.open(d,c,"HTML5 Video",f),a=1;a&&b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&&d.tagName&&"VIDEO"==d.tagName.toUpperCase()&&(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&&(e=c.currentSrc,(h=c.duration)||(h=-1),0>d&&(d=c.currentTime),b.O(e,h,a,
d,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,"play",c),b.j(d,"pause",e),b.j(d,"seeking",e),b.j(d,"seeked",c),b.j(d,"ended",function(){b.o(d,0,-1)}),b.j(d,"timeupdate",c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent("on"+c,e):b.addEventListener&&b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&&(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&&(b.completeCloseOffsetThreshold=
1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&&(d=b.s.d.getElementsByTagName("VIDEO")))for(c=0;c<d.length;c++)b.attach(d[c])};b.j(q,"load",b.N)}


/***** UNCOMMENT TO USE THE New Integrate MODULE *****/

function AppMeasurement_Module_Integrate(l){var c=this;c.s=l;var e=window;e.s_c_in||(e.s_c_il=[],e.s_c_in=0);c._il=e.s_c_il;c._in=e.s_c_in;c._il[c._in]=c;e.s_c_in++;c._c="s_m";c.list=[];c.add=function(d,b){var a;b||(b="s_Integrate_"+d);e[b]||(e[b]={});a=c[d]=e[b];a.a=d;a.e=c;a._c=0;a._d=0;void 0==a.disable&&(a.disable=0);a.get=function(b,d){var f=document,h=f.getElementsByTagName("HEAD"),k;if(!a.disable&&(d||(v="s_"+c._in+"_Integrate_"+a.a+"_get_"+a._c),a._c++,a.VAR=v,a.CALLBACK="s_c_il["+c._in+"]."+
a.a+".callback",a.delay(),h=h&&0<h.length?h[0]:f.body))try{k=f.createElement("SCRIPT"),k.type="text/javascript",k.setAttribute("async","async"),k.src=c.c(a,b),0>b.indexOf("[CALLBACK]")&&(k.onload=k.onreadystatechange=function(){a.callback(e[v])}),h.firstChild?h.insertBefore(k,h.firstChild):h.appendChild(k)}catch(l){}};a.callback=function(b){var c;if(b)for(c in b)Object.prototype[c]||(a[c]=b[c]);a.ready()};a.beacon=function(b){var d="s_i_"+c._in+"_Integrate_"+a.a+"_"+a._c;a.disable||(a._c++,d=e[d]=
new Image,d.src=c.c(a,b))};a.script=function(b){a.get(b,1)};a.delay=function(){a._d++};a.ready=function(){a._d--;a.disable||l.delayReady()};c.list.push(d)};c._g=function(d){var b,a=(d?"use":"set")+"Vars";for(d=0;d<c.list.length;d++)if((b=c[c.list[d]])&&!b.disable&&b[a])try{b[a](l,b)}catch(e){}};c._t=function(){c._g(1)};c._d=function(){var d,b;for(d=0;d<c.list.length;d++)if((b=c[c.list[d]])&&!b.disable&&0<b._d)return 1;return 0};c.c=function(c,b){var a,e,g,f;"http"!=b.toLowerCase().substring(0,4)&&
(b="http://"+b);l.ssl&&(b=l.replace(b,"http:","https:"));c.RAND=Math.floor(1E13*Math.random());for(a=0;0<=a;)a=b.indexOf("[",a),0<=a&&(e=b.indexOf("]",a),e>a&&(g=b.substring(a+1,e),2<g.length&&"s."==g.substring(0,2)?(f=l[g.substring(2)])||(f=""):(f=""+c[g],f!=c[g]&&parseFloat(f)!=c[g]&&(g=0)),g&&(b=b.substring(0,a)+encodeURIComponent(f)+b.substring(e+1)),a=e));return b}}

/*
 Start ActivityMap Module

 The following module enables ActivityMap tracking in Adobe Analytics. ActivityMap
 allows you to view data overlays on your links and content to understand how
 users engage with your web site. If you do not intend to use ActivityMap, you
 can remove the following block of code from your AppMeasurement.js file.
 Additional documentation on how to configure ActivityMap is available at:
 https://marketing.adobe.com/resources/help/en_US/analytics/activitymap/getting-started-admins.html
*/
function AppMeasurement_Module_ActivityMap(f){function g(a,d){var b,c,n;if(a&&d&&(b=e.c[d]||(e.c[d]=d.split(","))))for(n=0;n<b.length&&(c=b[n++]);)if(-1<a.indexOf(c))return null;p=1;return a}function q(a,d,b,c,e){var g,h;if(a.dataset&&(h=a.dataset[d]))g=h;else if(a.getAttribute)if(h=a.getAttribute("data-"+b))g=h;else if(h=a.getAttribute(b))g=h;if(!g&&f.useForcedLinkTracking&&e&&(g="",d=a.onclick?""+a.onclick:"")){b=d.indexOf(c);var l,k;if(0<=b){for(b+=10;b<d.length&&0<="= \t\r\n".indexOf(d.charAt(b));)b++;
if(b<d.length){h=b;for(l=k=0;h<d.length&&(";"!=d.charAt(h)||l);)l?d.charAt(h)!=l||k?k="\\"==d.charAt(h)?!k:0:l=0:(l=d.charAt(h),'"'!=l&&"'"!=l&&(l=0)),h++;if(d=d.substring(b,h))a.e=new Function("s","var e;try{s.w."+c+"="+d+"}catch(e){}"),a.e(f)}}}return g||e&&f.w[c]}function r(a,d,b){var c;return(c=e[d](a,b))&&(p?(p=0,c):g(k(c),e[d+"Exclusions"]))}function s(a,d,b){var c;if(a&&!(1===(c=a.nodeType)&&(c=a.nodeName)&&(c=c.toUpperCase())&&t[c])&&(1===a.nodeType&&(c=a.nodeValue)&&(d[d.length]=c),b.a||
b.t||b.s||!a.getAttribute||((c=a.getAttribute("alt"))?b.a=c:(c=a.getAttribute("title"))?b.t=c:"IMG"==(""+a.nodeName).toUpperCase()&&(c=a.getAttribute("src")||a.src)&&(b.s=c)),(c=a.childNodes)&&c.length))for(a=0;a<c.length;a++)s(c[a],d,b)}function k(a){if(null==a||void 0==a)return a;try{return a.replace(RegExp("^[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]+","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]+$",
"mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]{1,}","mg")," ").substring(0,254)}catch(d){}}var e=this;e.s=f;var m=window;m.s_c_in||(m.s_c_il=[],m.s_c_in=0);e._il=m.s_c_il;e._in=m.s_c_in;e._il[e._in]=e;m.s_c_in++;e._c="s_m";e.c={};var p=0,t={SCRIPT:1,STYLE:1,LINK:1,CANVAS:1};e._g=function(){var a,d,b,c=f.contextData,e=f.linkObject;(a=f.pageName||f.pageURL)&&(d=r(e,"link",f.linkName))&&(b=r(e,"region"))&&(c["a.activitymap.page"]=a.substring(0,
255),c["a.activitymap.link"]=128<d.length?d.substring(0,128):d,c["a.activitymap.region"]=127<b.length?b.substring(0,127):b,c["a.activitymap.pageIDType"]=f.pageName?1:0)};e.link=function(a,d){var b;if(d)b=g(k(d),e.linkExclusions);else if((b=a)&&!(b=q(a,"sObjectId","s-object-id","s_objectID",1))){var c,f;(f=g(k(a.innerText||a.textContent),e.linkExclusions))||(s(a,c=[],b={a:void 0,t:void 0,s:void 0}),(f=g(k(c.join(""))))||(f=g(k(b.a?b.a:b.t?b.t:b.s?b.s:void 0)))||!(c=(c=a.tagName)&&c.toUpperCase?c.toUpperCase():
"")||("INPUT"==c||"SUBMIT"==c&&a.value?f=g(k(a.value)):"IMAGE"==c&&a.src&&(f=g(k(a.src)))));b=f}return b};e.region=function(a){for(var d,b=e.regionIDAttribute||"id";a&&(a=a.parentNode);){if(d=q(a,b,b,b))return d;if("BODY"==a.nodeName)return"BODY"}}}
/* End ActivityMap Module */
/*
 ============== DO NOT ALTER ANYTHING BELOW THIS LINE ! ===============

AppMeasurement for JavaScript version: 2.1.0
Copyright 1996-2016 Adobe, Inc. All Rights Reserved
More info available at http://www.adobe.com/marketing-cloud.html
*/
function AppMeasurement(){var a=this;a.version="2.1.0";var h=window;h.s_c_in||(h.s_c_il=[],h.s_c_in=0);a._il=h.s_c_il;a._in=h.s_c_in;a._il[a._in]=a;h.s_c_in++;a._c="s_c";var n=h.AppMeasurement.Ob;n||(n=null);var p=h,l,r;try{for(l=p.parent,r=p.location;l&&l.location&&r&&""+l.location!=""+r&&p.location&&""+l.location!=""+p.location&&l.location.host==r.host;)p=l,l=p.parent}catch(s){}a.P=function(a){try{console.log(a)}catch(b){}};a.La=function(a){return""+parseInt(a)==""+a};a.replace=function(a,b,d){return!a||
0>a.indexOf(b)?a:a.split(b).join(d)};a.escape=function(c){var b,d;if(!c)return c;c=encodeURIComponent(c);for(b=0;7>b;b++)d="+~!*()'".substring(b,b+1),0<=c.indexOf(d)&&(c=a.replace(c,d,"%"+d.charCodeAt(0).toString(16).toUpperCase()));return c};a.unescape=function(c){if(!c)return c;c=0<=c.indexOf("+")?a.replace(c,"+"," "):c;try{return decodeURIComponent(c)}catch(b){}return unescape(c)};a.vb=function(){var c=h.location.hostname,b=a.fpCookieDomainPeriods,d;b||(b=a.cookieDomainPeriods);if(c&&!a.cookieDomain&&
!/^[0-9.]+$/.test(c)&&(b=b?parseInt(b):2,b=2<b?b:2,d=c.lastIndexOf("."),0<=d)){for(;0<=d&&1<b;)d=c.lastIndexOf(".",d-1),b--;a.cookieDomain=0<d?c.substring(d):c}return a.cookieDomain};a.c_r=a.cookieRead=function(c){c=a.escape(c);var b=" "+a.d.cookie,d=b.indexOf(" "+c+"="),f=0>d?d:b.indexOf(";",d);c=0>d?"":a.unescape(b.substring(d+2+c.length,0>f?b.length:f));return"[[B]]"!=c?c:""};a.c_w=a.cookieWrite=function(c,b,d){var f=a.vb(),e=a.cookieLifetime,g;b=""+b;e=e?(""+e).toUpperCase():"";d&&"SESSION"!=
e&&"NONE"!=e&&((g=""!=b?parseInt(e?e:0):-60)?(d=new Date,d.setTime(d.getTime()+1E3*g)):1==d&&(d=new Date,g=d.getYear(),d.setYear(g+5+(1900>g?1900:0))));return c&&"NONE"!=e?(a.d.cookie=a.escape(c)+"="+a.escape(""!=b?b:"[[B]]")+"; path=/;"+(d&&"SESSION"!=e?" expires="+d.toGMTString()+";":"")+(f?" domain="+f+";":""),a.cookieRead(c)==b):0};a.K=[];a.ia=function(c,b,d){if(a.Ea)return 0;a.maxDelay||(a.maxDelay=250);var f=0,e=(new Date).getTime()+a.maxDelay,g=a.d.visibilityState,k=["webkitvisibilitychange",
"visibilitychange"];g||(g=a.d.webkitVisibilityState);if(g&&"prerender"==g){if(!a.ja)for(a.ja=1,d=0;d<k.length;d++)a.d.addEventListener(k[d],function(){var c=a.d.visibilityState;c||(c=a.d.webkitVisibilityState);"visible"==c&&(a.ja=0,a.delayReady())});f=1;e=0}else d||a.p("_d")&&(f=1);f&&(a.K.push({m:c,a:b,t:e}),a.ja||setTimeout(a.delayReady,a.maxDelay));return f};a.delayReady=function(){var c=(new Date).getTime(),b=0,d;for(a.p("_d")?b=1:a.xa();0<a.K.length;){d=a.K.shift();if(b&&!d.t&&d.t>c){a.K.unshift(d);
setTimeout(a.delayReady,parseInt(a.maxDelay/2));break}a.Ea=1;a[d.m].apply(a,d.a);a.Ea=0}};a.setAccount=a.sa=function(c){var b,d;if(!a.ia("setAccount",arguments))if(a.account=c,a.allAccounts)for(b=a.allAccounts.concat(c.split(",")),a.allAccounts=[],b.sort(),d=0;d<b.length;d++)0!=d&&b[d-1]==b[d]||a.allAccounts.push(b[d]);else a.allAccounts=c.split(",")};a.foreachVar=function(c,b){var d,f,e,g,k="";e=f="";if(a.lightProfileID)d=a.O,(k=a.lightTrackVars)&&(k=","+k+","+a.na.join(",")+",");else{d=a.g;if(a.pe||
a.linkType)k=a.linkTrackVars,f=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(k=a[e].Mb,f=a[e].Lb));k&&(k=","+k+","+a.G.join(",")+",");f&&k&&(k+=",events,")}b&&(b=","+b+",");for(f=0;f<d.length;f++)e=d[f],(g=a[e])&&(!k||0<=k.indexOf(","+e+","))&&(!b||0<=b.indexOf(","+e+","))&&c(e,g)};a.r=function(c,b,d,f,e){var g="",k,m,h,t,l=0;"contextData"==c&&(c="c");if(b){for(k in b)if(!(Object.prototype[k]||e&&k.substring(0,e.length)!=e)&&b[k]&&(!d||0<=d.indexOf(","+(f?f+
".":"")+k+","))){h=!1;if(l)for(m=0;m<l.length;m++)k.substring(0,l[m].length)==l[m]&&(h=!0);if(!h&&(""==g&&(g+="&"+c+"."),m=b[k],e&&(k=k.substring(e.length)),0<k.length))if(h=k.indexOf("."),0<h)m=k.substring(0,h),h=(e?e:"")+m+".",l||(l=[]),l.push(h),g+=a.r(m,b,d,f,h);else if("boolean"==typeof m&&(m=m?"true":"false"),m){if("retrieveLightData"==f&&0>e.indexOf(".contextData."))switch(h=k.substring(0,4),t=k.substring(4),k){case "transactionID":k="xact";break;case "channel":k="ch";break;case "campaign":k=
"v0";break;default:a.La(t)&&("prop"==h?k="c"+t:"eVar"==h?k="v"+t:"list"==h?k="l"+t:"hier"==h&&(k="h"+t,m=m.substring(0,255)))}g+="&"+a.escape(k)+"="+a.escape(m)}}""!=g&&(g+="&."+c)}return g};a.usePostbacks=0;a.yb=function(){var c="",b,d,f,e,g,k,m,h,l="",p="",q=e="";if(a.lightProfileID)b=a.O,(l=a.lightTrackVars)&&(l=","+l+","+a.na.join(",")+",");else{b=a.g;if(a.pe||a.linkType)l=a.linkTrackVars,p=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(l=a[e].Mb,p=a[e].Lb));
l&&(l=","+l+","+a.G.join(",")+",");p&&(p=","+p+",",l&&(l+=",events,"));a.events2&&(q+=(""!=q?",":"")+a.events2)}if(a.visitor&&a.visitor.getCustomerIDs){e=n;if(g=a.visitor.getCustomerIDs())for(d in g)Object.prototype[d]||(f=g[d],"object"==typeof f&&(e||(e={}),f.id&&(e[d+".id"]=f.id),f.authState&&(e[d+".as"]=f.authState)));e&&(c+=a.r("cid",e))}a.AudienceManagement&&a.AudienceManagement.isReady()&&(c+=a.r("d",a.AudienceManagement.getEventCallConfigParams()));for(d=0;d<b.length;d++){e=b[d];g=a[e];f=e.substring(0,
4);k=e.substring(4);g||("events"==e&&q?(g=q,q=""):"marketingCloudOrgID"==e&&a.visitor&&(g=a.visitor.marketingCloudOrgID));if(g&&(!l||0<=l.indexOf(","+e+","))){switch(e){case "customerPerspective":e="cp";break;case "marketingCloudOrgID":e="mcorgid";break;case "supplementalDataID":e="sdid";break;case "timestamp":e="ts";break;case "dynamicVariablePrefix":e="D";break;case "visitorID":e="vid";break;case "marketingCloudVisitorID":e="mid";break;case "analyticsVisitorID":e="aid";break;case "audienceManagerLocationHint":e=
"aamlh";break;case "audienceManagerBlob":e="aamb";break;case "authState":e="as";break;case "pageURL":e="g";255<g.length&&(a.pageURLRest=g.substring(255),g=g.substring(0,255));break;case "pageURLRest":e="-g";break;case "referrer":e="r";break;case "vmk":case "visitorMigrationKey":e="vmt";break;case "visitorMigrationServer":e="vmf";a.ssl&&a.visitorMigrationServerSecure&&(g="");break;case "visitorMigrationServerSecure":e="vmf";!a.ssl&&a.visitorMigrationServer&&(g="");break;case "charSet":e="ce";break;
case "visitorNamespace":e="ns";break;case "cookieDomainPeriods":e="cdp";break;case "cookieLifetime":e="cl";break;case "variableProvider":e="vvp";break;case "currencyCode":e="cc";break;case "channel":e="ch";break;case "transactionID":e="xact";break;case "campaign":e="v0";break;case "latitude":e="lat";break;case "longitude":e="lon";break;case "resolution":e="s";break;case "colorDepth":e="c";break;case "javascriptVersion":e="j";break;case "javaEnabled":e="v";break;case "cookiesEnabled":e="k";break;case "browserWidth":e=
"bw";break;case "browserHeight":e="bh";break;case "connectionType":e="ct";break;case "homepage":e="hp";break;case "events":q&&(g+=(""!=g?",":"")+q);if(p)for(k=g.split(","),g="",f=0;f<k.length;f++)m=k[f],h=m.indexOf("="),0<=h&&(m=m.substring(0,h)),h=m.indexOf(":"),0<=h&&(m=m.substring(0,h)),0<=p.indexOf(","+m+",")&&(g+=(g?",":"")+k[f]);break;case "events2":g="";break;case "contextData":c+=a.r("c",a[e],l,e);g="";break;case "lightProfileID":e="mtp";break;case "lightStoreForSeconds":e="mtss";a.lightProfileID||
(g="");break;case "lightIncrementBy":e="mti";a.lightProfileID||(g="");break;case "retrieveLightProfiles":e="mtsr";break;case "deleteLightProfiles":e="mtsd";break;case "retrieveLightData":a.retrieveLightProfiles&&(c+=a.r("mts",a[e],l,e));g="";break;default:a.La(k)&&("prop"==f?e="c"+k:"eVar"==f?e="v"+k:"list"==f?e="l"+k:"hier"==f&&(e="h"+k,g=g.substring(0,255)))}g&&(c+="&"+e+"="+("pev"!=e.substring(0,3)?a.escape(g):g))}"pev3"==e&&a.e&&(c+=a.e)}return c};a.D=function(a){var b=a.tagName;if("undefined"!=
""+a.Rb||"undefined"!=""+a.Hb&&"HTML"!=(""+a.Hb).toUpperCase())return"";b=b&&b.toUpperCase?b.toUpperCase():"";"SHAPE"==b&&(b="");b&&(("INPUT"==b||"BUTTON"==b)&&a.type&&a.type.toUpperCase?b=a.type.toUpperCase():!b&&a.href&&(b="A"));return b};a.Ha=function(a){var b=h.location,d=a.href?a.href:"",f,e,g;f=d.indexOf(":");e=d.indexOf("?");g=d.indexOf("/");d&&(0>f||0<=e&&f>e||0<=g&&f>g)&&(e=a.protocol&&1<a.protocol.length?a.protocol:b.protocol?b.protocol:"",f=b.pathname.lastIndexOf("/"),d=(e?e+"//":"")+(a.host?
a.host:b.host?b.host:"")+("/"!=d.substring(0,1)?b.pathname.substring(0,0>f?0:f)+"/":"")+d);return d};a.L=function(c){var b=a.D(c),d,f,e="",g=0;return b&&(d=c.protocol,f=c.onclick,!c.href||"A"!=b&&"AREA"!=b||f&&d&&!(0>d.toLowerCase().indexOf("javascript"))?f?(e=a.replace(a.replace(a.replace(a.replace(""+f,"\r",""),"\n",""),"\t","")," ",""),g=2):"INPUT"==b||"SUBMIT"==b?(c.value?e=c.value:c.innerText?e=c.innerText:c.textContent&&(e=c.textContent),g=3):"IMAGE"==b&&c.src&&(e=c.src):e=a.Ha(c),e)?{id:e.substring(0,
100),type:g}:0};a.Pb=function(c){for(var b=a.D(c),d=a.L(c);c&&!d&&"BODY"!=b;)if(c=c.parentElement?c.parentElement:c.parentNode)b=a.D(c),d=a.L(c);d&&"BODY"!=b||(c=0);c&&(b=c.onclick?""+c.onclick:"",0<=b.indexOf(".tl(")||0<=b.indexOf(".trackLink("))&&(c=0);return c};a.Gb=function(){var c,b,d=a.linkObject,f=a.linkType,e=a.linkURL,g,k;a.oa=1;d||(a.oa=0,d=a.clickObject);if(d){c=a.D(d);for(b=a.L(d);d&&!b&&"BODY"!=c;)if(d=d.parentElement?d.parentElement:d.parentNode)c=a.D(d),b=a.L(d);b&&"BODY"!=c||(d=0);
if(d&&!a.linkObject){var m=d.onclick?""+d.onclick:"";if(0<=m.indexOf(".tl(")||0<=m.indexOf(".trackLink("))d=0}}else a.oa=1;!e&&d&&(e=a.Ha(d));e&&!a.linkLeaveQueryString&&(g=e.indexOf("?"),0<=g&&(e=e.substring(0,g)));if(!f&&e){var l=0,p=0,n;if(a.trackDownloadLinks&&a.linkDownloadFileTypes)for(m=e.toLowerCase(),g=m.indexOf("?"),k=m.indexOf("#"),0<=g?0<=k&&k<g&&(g=k):g=k,0<=g&&(m=m.substring(0,g)),g=a.linkDownloadFileTypes.toLowerCase().split(","),k=0;k<g.length;k++)(n=g[k])&&m.substring(m.length-(n.length+
1))=="."+n&&(f="d");if(a.trackExternalLinks&&!f&&(m=e.toLowerCase(),a.Ka(m)&&(a.linkInternalFilters||(a.linkInternalFilters=h.location.hostname),g=0,a.linkExternalFilters?(g=a.linkExternalFilters.toLowerCase().split(","),l=1):a.linkInternalFilters&&(g=a.linkInternalFilters.toLowerCase().split(",")),g))){for(k=0;k<g.length;k++)n=g[k],0<=m.indexOf(n)&&(p=1);p?l&&(f="e"):l||(f="e")}}a.linkObject=d;a.linkURL=e;a.linkType=f;if(a.trackClickMap||a.trackInlineStats)a.e="",d&&(f=a.pageName,e=1,d=d.sourceIndex,
f||(f=a.pageURL,e=0),h.s_objectID&&(b.id=h.s_objectID,d=b.type=1),f&&b&&b.id&&c&&(a.e="&pid="+a.escape(f.substring(0,255))+(e?"&pidt="+e:"")+"&oid="+a.escape(b.id.substring(0,100))+(b.type?"&oidt="+b.type:"")+"&ot="+c+(d?"&oi="+d:"")))};a.zb=function(){var c=a.oa,b=a.linkType,d=a.linkURL,f=a.linkName;b&&(d||f)&&(b=b.toLowerCase(),"d"!=b&&"e"!=b&&(b="o"),a.pe="lnk_"+b,a.pev1=d?a.escape(d):"",a.pev2=f?a.escape(f):"",c=1);a.abort&&(c=0);if(a.trackClickMap||a.trackInlineStats||a.ActivityMap){var b={},
d=0,e=a.cookieRead("s_sq"),g=e?e.split("&"):0,k,m,h,e=0;if(g)for(k=0;k<g.length;k++)m=g[k].split("="),f=a.unescape(m[0]).split(","),m=a.unescape(m[1]),b[m]=f;f=a.account.split(",");k={};for(h in a.contextData)h&&!Object.prototype[h]&&"a.activitymap."==h.substring(0,14)&&(k[h]=a.contextData[h],a.contextData[h]="");a.e=a.r("c",k)+(a.e?a.e:"");if(c||a.e){c&&!a.e&&(e=1);for(m in b)if(!Object.prototype[m])for(h=0;h<f.length;h++)for(e&&(g=b[m].join(","),g==a.account&&(a.e+=("&"!=m.charAt(0)?"&":"")+m,b[m]=
[],d=1)),k=0;k<b[m].length;k++)g=b[m][k],g==f[h]&&(e&&(a.e+="&u="+a.escape(g)+("&"!=m.charAt(0)?"&":"")+m+"&u=0"),b[m].splice(k,1),d=1);c||(d=1);if(d){e="";k=2;!c&&a.e&&(e=a.escape(f.join(","))+"="+a.escape(a.e),k=1);for(m in b)!Object.prototype[m]&&0<k&&0<b[m].length&&(e+=(e?"&":"")+a.escape(b[m].join(","))+"="+a.escape(m),k--);a.cookieWrite("s_sq",e)}}}return c};a.Ab=function(){if(!a.Kb){var c=new Date,b=p.location,d,f,e=f=d="",g="",k="",h="1.2",l=a.cookieWrite("s_cc","true",0)?"Y":"N",n="",q="";
if(c.setUTCDate&&(h="1.3",(0).toPrecision&&(h="1.5",c=[],c.forEach))){h="1.6";f=0;d={};try{f=new Iterator(d),f.next&&(h="1.7",c.reduce&&(h="1.8",h.trim&&(h="1.8.1",Date.parse&&(h="1.8.2",Object.create&&(h="1.8.5")))))}catch(r){}}d=screen.width+"x"+screen.height;e=navigator.javaEnabled()?"Y":"N";f=screen.pixelDepth?screen.pixelDepth:screen.colorDepth;g=a.w.innerWidth?a.w.innerWidth:a.d.documentElement.offsetWidth;k=a.w.innerHeight?a.w.innerHeight:a.d.documentElement.offsetHeight;try{a.b.addBehavior("#default#homePage"),
n=a.b.Qb(b)?"Y":"N"}catch(s){}try{a.b.addBehavior("#default#clientCaps"),q=a.b.connectionType}catch(u){}a.resolution=d;a.colorDepth=f;a.javascriptVersion=h;a.javaEnabled=e;a.cookiesEnabled=l;a.browserWidth=g;a.browserHeight=k;a.connectionType=q;a.homepage=n;a.Kb=1}};a.Q={};a.loadModule=function(c,b){var d=a.Q[c];if(!d){d=h["AppMeasurement_Module_"+c]?new h["AppMeasurement_Module_"+c](a):{};a.Q[c]=a[c]=d;d.cb=function(){return d.hb};d.ib=function(b){if(d.hb=b)a[c+"_onLoad"]=b,a.ia(c+"_onLoad",[a,d],
1)||b(a,d)};try{Object.defineProperty?Object.defineProperty(d,"onLoad",{get:d.cb,set:d.ib}):d._olc=1}catch(f){d._olc=1}}b&&(a[c+"_onLoad"]=b,a.ia(c+"_onLoad",[a,d],1)||b(a,d))};a.p=function(c){var b,d;for(b in a.Q)if(!Object.prototype[b]&&(d=a.Q[b])&&(d._olc&&d.onLoad&&(d._olc=0,d.onLoad(a,d)),d[c]&&d[c]()))return 1;return 0};a.Cb=function(){var c=Math.floor(1E13*Math.random()),b=a.visitorSampling,d=a.visitorSamplingGroup,d="s_vsn_"+(a.visitorNamespace?a.visitorNamespace:a.account)+(d?"_"+d:""),f=
a.cookieRead(d);if(b){b*=100;f&&(f=parseInt(f));if(!f){if(!a.cookieWrite(d,c))return 0;f=c}if(f%1E4>b)return 0}return 1};a.R=function(c,b){var d,f,e,g,k,h;for(d=0;2>d;d++)for(f=0<d?a.Aa:a.g,e=0;e<f.length;e++)if(g=f[e],(k=c[g])||c["!"+g]){if(!b&&("contextData"==g||"retrieveLightData"==g)&&a[g])for(h in a[g])k[h]||(k[h]=a[g][h]);a[g]=k}};a.Ua=function(c,b){var d,f,e,g;for(d=0;2>d;d++)for(f=0<d?a.Aa:a.g,e=0;e<f.length;e++)g=f[e],c[g]=a[g],b||c[g]||(c["!"+g]=1)};a.ub=function(a){var b,d,f,e,g,k=0,h,
l="",n="";if(a&&255<a.length&&(b=""+a,d=b.indexOf("?"),0<d&&(h=b.substring(d+1),b=b.substring(0,d),e=b.toLowerCase(),f=0,"http://"==e.substring(0,7)?f+=7:"https://"==e.substring(0,8)&&(f+=8),d=e.indexOf("/",f),0<d&&(e=e.substring(f,d),g=b.substring(d),b=b.substring(0,d),0<=e.indexOf("google")?k=",q,ie,start,search_key,word,kw,cd,":0<=e.indexOf("yahoo.co")&&(k=",p,ei,"),k&&h)))){if((a=h.split("&"))&&1<a.length){for(f=0;f<a.length;f++)e=a[f],d=e.indexOf("="),0<d&&0<=k.indexOf(","+e.substring(0,d)+",")?
l+=(l?"&":"")+e:n+=(n?"&":"")+e;l&&n?h=l+"&"+n:n=""}d=253-(h.length-n.length)-b.length;a=b+(0<d?g.substring(0,d):"")+"?"+h}return a};a.$a=function(c){var b=a.d.visibilityState,d=["webkitvisibilitychange","visibilitychange"];b||(b=a.d.webkitVisibilityState);if(b&&"prerender"==b){if(c)for(b=0;b<d.length;b++)a.d.addEventListener(d[b],function(){var b=a.d.visibilityState;b||(b=a.d.webkitVisibilityState);"visible"==b&&c()});return!1}return!0};a.ea=!1;a.I=!1;a.kb=function(){a.I=!0;a.j()};a.ca=!1;a.V=!1;
a.gb=function(c){a.marketingCloudVisitorID=c;a.V=!0;a.j()};a.fa=!1;a.W=!1;a.lb=function(c){a.visitorOptedOut=c;a.W=!0;a.j()};a.Z=!1;a.S=!1;a.Wa=function(c){a.analyticsVisitorID=c;a.S=!0;a.j()};a.ba=!1;a.U=!1;a.Ya=function(c){a.audienceManagerLocationHint=c;a.U=!0;a.j()};a.aa=!1;a.T=!1;a.Xa=function(c){a.audienceManagerBlob=c;a.T=!0;a.j()};a.Za=function(c){a.maxDelay||(a.maxDelay=250);return a.p("_d")?(c&&setTimeout(function(){c()},a.maxDelay),!1):!0};a.da=!1;a.H=!1;a.xa=function(){a.H=!0;a.j()};a.isReadyToTrack=
function(){var c=!0,b=a.visitor,d,f,e;a.ea||a.I||(a.$a(a.kb)?a.I=!0:a.ea=!0);if(a.ea&&!a.I)return!1;b&&b.isAllowed()&&(a.ca||a.marketingCloudVisitorID||!b.getMarketingCloudVisitorID||(a.ca=!0,a.marketingCloudVisitorID=b.getMarketingCloudVisitorID([a,a.gb]),a.marketingCloudVisitorID&&(a.V=!0)),a.fa||a.visitorOptedOut||!b.isOptedOut||(a.fa=!0,a.visitorOptedOut=b.isOptedOut([a,a.lb]),a.visitorOptedOut!=n&&(a.W=!0)),a.Z||a.analyticsVisitorID||!b.getAnalyticsVisitorID||(a.Z=!0,a.analyticsVisitorID=b.getAnalyticsVisitorID([a,
a.Wa]),a.analyticsVisitorID&&(a.S=!0)),a.ba||a.audienceManagerLocationHint||!b.getAudienceManagerLocationHint||(a.ba=!0,a.audienceManagerLocationHint=b.getAudienceManagerLocationHint([a,a.Ya]),a.audienceManagerLocationHint&&(a.U=!0)),a.aa||a.audienceManagerBlob||!b.getAudienceManagerBlob||(a.aa=!0,a.audienceManagerBlob=b.getAudienceManagerBlob([a,a.Xa]),a.audienceManagerBlob&&(a.T=!0)),c=a.ca&&!a.V&&!a.marketingCloudVisitorID,b=a.Z&&!a.S&&!a.analyticsVisitorID,d=a.ba&&!a.U&&!a.audienceManagerLocationHint,
f=a.aa&&!a.T&&!a.audienceManagerBlob,e=a.fa&&!a.W,c=c||b||d||f||e?!1:!0);a.da||a.H||(a.Za(a.xa)?a.H=!0:a.da=!0);a.da&&!a.H&&(c=!1);return c};a.o=n;a.u=0;a.callbackWhenReadyToTrack=function(c,b,d){var f;f={};f.pb=c;f.ob=b;f.mb=d;a.o==n&&(a.o=[]);a.o.push(f);0==a.u&&(a.u=setInterval(a.j,100))};a.j=function(){var c;if(a.isReadyToTrack()&&(a.jb(),a.o!=n))for(;0<a.o.length;)c=a.o.shift(),c.ob.apply(c.pb,c.mb)};a.jb=function(){a.u&&(clearInterval(a.u),a.u=0)};a.eb=function(c){var b,d,f=n,e=n;if(!a.isReadyToTrack()){b=
[];if(c!=n)for(d in f={},c)f[d]=c[d];e={};a.Ua(e,!0);b.push(f);b.push(e);a.callbackWhenReadyToTrack(a,a.track,b);return!0}return!1};a.wb=function(){var c=a.cookieRead("s_fid"),b="",d="",f;f=8;var e=4;if(!c||0>c.indexOf("-")){for(c=0;16>c;c++)f=Math.floor(Math.random()*f),b+="0123456789ABCDEF".substring(f,f+1),f=Math.floor(Math.random()*e),d+="0123456789ABCDEF".substring(f,f+1),f=e=16;c=b+"-"+d}a.cookieWrite("s_fid",c,1)||(c=0);return c};a.t=a.track=function(c,b){var d,f=new Date,e="s"+Math.floor(f.getTime()/
108E5)%10+Math.floor(1E13*Math.random()),g=f.getYear(),g="t="+a.escape(f.getDate()+"/"+f.getMonth()+"/"+(1900>g?g+1900:g)+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()+" "+f.getDay()+" "+f.getTimezoneOffset());a.visitor&&a.visitor.getAuthState&&(a.authState=a.visitor.getAuthState());a.p("_s");a.eb(c)||(b&&a.R(b),c&&(d={},a.Ua(d,0),a.R(c)),a.Cb()&&!a.visitorOptedOut&&(a.analyticsVisitorID||a.marketingCloudVisitorID||(a.fid=a.wb()),a.Gb(),a.usePlugins&&a.doPlugins&&a.doPlugins(a),a.account&&
(a.abort||(a.trackOffline&&!a.timestamp&&(a.timestamp=Math.floor(f.getTime()/1E3)),f=h.location,a.pageURL||(a.pageURL=f.href?f.href:f),a.referrer||a.Va||(f=a.Util.getQueryParam("adobe_mc_ref",null,null,!0),a.referrer=f||void 0===f?void 0===f?"":f:p.document.referrer),a.Va=1,a.referrer=a.ub(a.referrer),a.p("_g")),a.zb()&&!a.abort&&(a.visitor&&!a.supplementalDataID&&a.visitor.getSupplementalDataID&&(a.supplementalDataID=a.visitor.getSupplementalDataID("AppMeasurement:"+a._in,a.expectSupplementalData?
!1:!0)),a.Ab(),g+=a.yb(),a.Fb(e,g),a.p("_t"),a.referrer=""))),c&&a.R(d,1));a.abort=a.supplementalDataID=a.timestamp=a.pageURLRest=a.linkObject=a.clickObject=a.linkURL=a.linkName=a.linkType=h.s_objectID=a.pe=a.pev1=a.pev2=a.pev3=a.e=a.lightProfileID=0};a.za=[];a.registerPreTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.za.push([c,b]):a.debugTracking&&a.P("DEBUG: Non function type passed to registerPreTrackCallback")};a.bb=function(c){a.wa(a.za,
c)};a.ya=[];a.registerPostTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.ya.push([c,b]):a.debugTracking&&a.P("DEBUG: Non function type passed to registerPostTrackCallback")};a.ab=function(c){a.wa(a.ya,c)};a.wa=function(c,b){if("object"==typeof c)for(var d=0;d<c.length;d++){var f=c[d][0],e=c[d][1];e.unshift(b);if("function"==typeof f)try{f.apply(null,e)}catch(g){a.debugTracking&&a.P(g.message)}}};a.tl=a.trackLink=function(c,b,d,f,e){a.linkObject=
c;a.linkType=b;a.linkName=d;e&&(a.l=c,a.A=e);return a.track(f)};a.trackLight=function(c,b,d,f){a.lightProfileID=c;a.lightStoreForSeconds=b;a.lightIncrementBy=d;return a.track(f)};a.clearVars=function(){var c,b;for(c=0;c<a.g.length;c++)if(b=a.g[c],"prop"==b.substring(0,4)||"eVar"==b.substring(0,4)||"hier"==b.substring(0,4)||"list"==b.substring(0,4)||"channel"==b||"events"==b||"eventList"==b||"products"==b||"productList"==b||"purchaseID"==b||"transactionID"==b||"state"==b||"zip"==b||"campaign"==b)a[b]=
void 0};a.tagContainerMarker="";a.Fb=function(c,b){var d,f=a.trackingServer;d="";var e=a.dc,g="sc.",h=a.visitorNamespace;f?a.trackingServerSecure&&a.ssl&&(f=a.trackingServerSecure):(h||(h=a.account,f=h.indexOf(","),0<=f&&(h=h.substring(0,f)),h=h.replace(/[^A-Za-z0-9]/g,"")),d||(d="2o7.net"),e=e?(""+e).toLowerCase():"d1","2o7.net"==d&&("d1"==e?e="112":"d2"==e&&(e="122"),g=""),f=h+"."+e+"."+g+d);d=a.ssl?"https://":"http://";e=a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks;d+=
f+"/b/ss/"+a.account+"/"+(a.mobile?"5.":"")+(e?"10":"1")+"/JS-"+a.version+(a.Jb?"T":"")+(a.tagContainerMarker?"-"+a.tagContainerMarker:"")+"/"+c+"?AQB=1&ndh=1&pf=1&"+(e?"callback=s_c_il["+a._in+"].doPostbacks&et=1&":"")+b+"&AQE=1";a.bb(d);a.sb(d);a.ka()};a.Ta=/{(%?)(.*?)(%?)}/;a.Nb=RegExp(a.Ta.source,"g");a.tb=function(c){if("object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];if("string"==typeof d.c&&"aa."==d.id.substr(0,3))for(var f=d.c.match(a.Nb),e=0;e<f.length;++e){var g=
f[e],h=g.match(a.Ta),l="";"%"==h[1]&&"timezone_offset"==h[2]?l=(new Date).getTimezoneOffset():"%"==h[1]&&"timestampz"==h[2]&&(l=a.xb());d.c=d.c.replace(g,a.escape(l))}}};a.xb=function(){var c=new Date,b=new Date(6E4*Math.abs(c.getTimezoneOffset()));return a.k(4,c.getFullYear())+"-"+a.k(2,c.getMonth()+1)+"-"+a.k(2,c.getDate())+"T"+a.k(2,c.getHours())+":"+a.k(2,c.getMinutes())+":"+a.k(2,c.getSeconds())+(0<c.getTimezoneOffset()?"-":"+")+a.k(2,b.getUTCHours())+":"+a.k(2,b.getUTCMinutes())};a.k=function(a,
b){return(Array(a+1).join(0)+b).slice(-a)};a.ta={};a.doPostbacks=function(c){if("object"==typeof c)if(a.tb(c),"object"==typeof a.AudienceManagement&&"function"==typeof a.AudienceManagement.isReady&&a.AudienceManagement.isReady()&&"function"==typeof a.AudienceManagement.passData)a.AudienceManagement.passData(c);else if("object"==typeof c&&"object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];"object"==typeof d&&"string"==typeof d.c&&"string"==typeof d.id&&"aa."==d.id.substr(0,
3)&&(a.ta[d.id]=new Image,a.ta[d.id].alt="",a.ta[d.id].src=d.c)}};a.sb=function(c){a.i||a.Bb();a.i.push(c);a.ma=a.C();a.Ra()};a.Bb=function(){a.i=a.Db();a.i||(a.i=[])};a.Db=function(){var c,b;if(a.ra()){try{(b=h.localStorage.getItem(a.pa()))&&(c=h.JSON.parse(b))}catch(d){}return c}};a.ra=function(){var c=!0;a.trackOffline&&a.offlineFilename&&h.localStorage&&h.JSON||(c=!1);return c};a.Ia=function(){var c=0;a.i&&(c=a.i.length);a.q&&c++;return c};a.ka=function(){if(a.q&&(a.B&&a.B.complete&&a.B.F&&a.B.va(),
a.q))return;a.Ja=n;if(a.qa)a.ma>a.N&&a.Pa(a.i),a.ua(500);else{var c=a.nb();if(0<c)a.ua(c);else if(c=a.Fa())a.q=1,a.Eb(c),a.Ib(c)}};a.ua=function(c){a.Ja||(c||(c=0),a.Ja=setTimeout(a.ka,c))};a.nb=function(){var c;if(!a.trackOffline||0>=a.offlineThrottleDelay)return 0;c=a.C()-a.Oa;return a.offlineThrottleDelay<c?0:a.offlineThrottleDelay-c};a.Fa=function(){if(0<a.i.length)return a.i.shift()};a.Eb=function(c){if(a.debugTracking){var b="AppMeasurement Debug: "+c;c=c.split("&");var d;for(d=0;d<c.length;d++)b+=
"\n\t"+a.unescape(c[d]);a.P(b)}};a.fb=function(){return a.marketingCloudVisitorID||a.analyticsVisitorID};a.Y=!1;var q;try{q=JSON.parse('{"x":"y"}')}catch(u){q=null}q&&"y"==q.x?(a.Y=!0,a.X=function(a){return JSON.parse(a)}):h.$&&h.$.parseJSON?(a.X=function(a){return h.$.parseJSON(a)},a.Y=!0):a.X=function(){return null};a.Ib=function(c){var b,d,f;a.fb()&&2047<c.length&&("undefined"!=typeof XMLHttpRequest&&(b=new XMLHttpRequest,"withCredentials"in b?d=1:b=0),b||"undefined"==typeof XDomainRequest||(b=
new XDomainRequest,d=2),b&&(a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks)&&(a.Y?b.Ba=!0:b=0));!b&&a.Sa&&(c=c.substring(0,2047));!b&&a.d.createElement&&(0!=a.usePostbacks||a.AudienceManagement&&a.AudienceManagement.isReady())&&(b=a.d.createElement("SCRIPT"))&&"async"in b&&((f=(f=a.d.getElementsByTagName("HEAD"))&&f[0]?f[0]:a.d.body)?(b.type="text/javascript",b.setAttribute("async","async"),d=3):b=0);b||(b=new Image,b.alt="",b.abort||"undefined"===typeof h.InstallTrigger||
(b.abort=function(){b.src=n}));b.Da=function(){try{b.F&&(clearTimeout(b.F),b.F=0)}catch(a){}};b.onload=b.va=function(){a.ab(c);b.Da();a.rb();a.ga();a.q=0;a.ka();if(b.Ba){b.Ba=!1;try{a.doPostbacks(a.X(b.responseText))}catch(d){}}};b.onabort=b.onerror=b.Ga=function(){b.Da();(a.trackOffline||a.qa)&&a.q&&a.i.unshift(a.qb);a.q=0;a.ma>a.N&&a.Pa(a.i);a.ga();a.ua(500)};b.onreadystatechange=function(){4==b.readyState&&(200==b.status?b.va():b.Ga())};a.Oa=a.C();if(1==d||2==d){var e=c.indexOf("?");f=c.substring(0,
e);e=c.substring(e+1);e=e.replace(/&callback=[a-zA-Z0-9_.\[\]]+/,"");1==d?(b.open("POST",f,!0),b.send(e)):2==d&&(b.open("POST",f),b.send(e))}else if(b.src=c,3==d){if(a.Ma)try{f.removeChild(a.Ma)}catch(g){}f.firstChild?f.insertBefore(b,f.firstChild):f.appendChild(b);a.Ma=a.B}b.F=setTimeout(function(){b.F&&(b.complete?b.va():(a.trackOffline&&b.abort&&b.abort(),b.Ga()))},5E3);a.qb=c;a.B=h["s_i_"+a.replace(a.account,",","_")]=b;if(a.useForcedLinkTracking&&a.J||a.A)a.forcedLinkTrackingTimeout||(a.forcedLinkTrackingTimeout=
250),a.ha=setTimeout(a.ga,a.forcedLinkTrackingTimeout)};a.rb=function(){if(a.ra()&&!(a.Na>a.N))try{h.localStorage.removeItem(a.pa()),a.Na=a.C()}catch(c){}};a.Pa=function(c){if(a.ra()){a.Ra();try{h.localStorage.setItem(a.pa(),h.JSON.stringify(c)),a.N=a.C()}catch(b){}}};a.Ra=function(){if(a.trackOffline){if(!a.offlineLimit||0>=a.offlineLimit)a.offlineLimit=10;for(;a.i.length>a.offlineLimit;)a.Fa()}};a.forceOffline=function(){a.qa=!0};a.forceOnline=function(){a.qa=!1};a.pa=function(){return a.offlineFilename+
"-"+a.visitorNamespace+a.account};a.C=function(){return(new Date).getTime()};a.Ka=function(a){a=a.toLowerCase();return 0!=a.indexOf("#")&&0!=a.indexOf("about:")&&0!=a.indexOf("opera:")&&0!=a.indexOf("javascript:")?!0:!1};a.setTagContainer=function(c){var b,d,f;a.Jb=c;for(b=0;b<a._il.length;b++)if((d=a._il[b])&&"s_l"==d._c&&d.tagContainerName==c){a.R(d);if(d.lmq)for(b=0;b<d.lmq.length;b++)f=d.lmq[b],a.loadModule(f.n);if(d.ml)for(f in d.ml)if(a[f])for(b in c=a[f],f=d.ml[f],f)!Object.prototype[b]&&("function"!=
typeof f[b]||0>(""+f[b]).indexOf("s_c_il"))&&(c[b]=f[b]);if(d.mmq)for(b=0;b<d.mmq.length;b++)f=d.mmq[b],a[f.m]&&(c=a[f.m],c[f.f]&&"function"==typeof c[f.f]&&(f.a?c[f.f].apply(c,f.a):c[f.f].apply(c)));if(d.tq)for(b=0;b<d.tq.length;b++)a.track(d.tq[b]);d.s=a;break}};a.Util={urlEncode:a.escape,urlDecode:a.unescape,cookieRead:a.cookieRead,cookieWrite:a.cookieWrite,getQueryParam:function(c,b,d,f){var e,g="";b||(b=a.pageURL?a.pageURL:h.location);d=d?d:"&";if(!c||!b)return g;b=""+b;e=b.indexOf("?");if(0>
e)return g;b=d+b.substring(e+1)+d;if(!f||!(0<=b.indexOf(d+c+d)||0<=b.indexOf(d+c+"="+d))){e=b.indexOf(d+c+"=");if(0>e)return g;b=b.substring(e+d.length+c.length+1);e=b.indexOf(d);0<=e&&(b=b.substring(0,e));0<b.length&&(g=a.unescape(b));return g}}};a.G="supplementalDataID timestamp dynamicVariablePrefix visitorID marketingCloudVisitorID analyticsVisitorID audienceManagerLocationHint authState fid vmk visitorMigrationKey visitorMigrationServer visitorMigrationServerSecure charSet visitorNamespace cookieDomainPeriods fpCookieDomainPeriods cookieLifetime pageName pageURL customerPerspective referrer contextData currencyCode lightProfileID lightStoreForSeconds lightIncrementBy retrieveLightProfiles deleteLightProfiles retrieveLightData".split(" ");
a.g=a.G.concat("purchaseID variableProvider channel server pageType transactionID campaign state zip events events2 products audienceManagerBlob tnt".split(" "));a.na="timestamp charSet visitorNamespace cookieDomainPeriods cookieLifetime contextData lightProfileID lightStoreForSeconds lightIncrementBy".split(" ");a.O=a.na.slice(0);a.Aa="account allAccounts debugTracking visitor visitorOptedOut trackOffline offlineLimit offlineThrottleDelay offlineFilename usePlugins doPlugins configURL visitorSampling visitorSamplingGroup linkObject clickObject linkURL linkName linkType trackDownloadLinks trackExternalLinks trackClickMap trackInlineStats linkLeaveQueryString linkTrackVars linkTrackEvents linkDownloadFileTypes linkExternalFilters linkInternalFilters useForcedLinkTracking forcedLinkTrackingTimeout trackingServer trackingServerSecure ssl abort mobile dc lightTrackVars maxDelay expectSupplementalData usePostbacks registerPreTrackCallback registerPostTrackCallback AudienceManagement".split(" ");
for(l=0;250>=l;l++)76>l&&(a.g.push("prop"+l),a.O.push("prop"+l)),a.g.push("eVar"+l),a.O.push("eVar"+l),6>l&&a.g.push("hier"+l),4>l&&a.g.push("list"+l);l="pe pev1 pev2 pev3 latitude longitude resolution colorDepth javascriptVersion javaEnabled cookiesEnabled browserWidth browserHeight connectionType homepage pageURLRest marketingCloudOrgID".split(" ");a.g=a.g.concat(l);a.G=a.G.concat(l);a.ssl=0<=h.location.protocol.toLowerCase().indexOf("https");a.charSet="UTF-8";a.contextData={};a.offlineThrottleDelay=
0;a.offlineFilename="AppMeasurement.offline";a.Oa=0;a.ma=0;a.N=0;a.Na=0;a.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";a.w=h;a.d=h.document;try{if(a.Sa=!1,navigator){var v=navigator.userAgent;if("Microsoft Internet Explorer"==navigator.appName||0<=v.indexOf("MSIE ")||0<=v.indexOf("Trident/")&&0<=v.indexOf("Windows NT 6"))a.Sa=!0}}catch(w){}a.ga=function(){a.ha&&(h.clearTimeout(a.ha),a.ha=n);a.l&&a.J&&a.l.dispatchEvent(a.J);a.A&&("function"==typeof a.A?a.A():
a.l&&a.l.href&&(a.d.location=a.l.href));a.l=a.J=a.A=0};a.Qa=function(){a.b=a.d.body;a.b?(a.v=function(c){var b,d,f,e,g;if(!(a.d&&a.d.getElementById("cppXYctnr")||c&&c["s_fe_"+a._in])){if(a.Ca)if(a.useForcedLinkTracking)a.b.removeEventListener("click",a.v,!1);else{a.b.removeEventListener("click",a.v,!0);a.Ca=a.useForcedLinkTracking=0;return}else a.useForcedLinkTracking=0;a.clickObject=c.srcElement?c.srcElement:c.target;try{if(!a.clickObject||a.M&&a.M==a.clickObject||!(a.clickObject.tagName||a.clickObject.parentElement||
a.clickObject.parentNode))a.clickObject=0;else{var k=a.M=a.clickObject;a.la&&(clearTimeout(a.la),a.la=0);a.la=setTimeout(function(){a.M==k&&(a.M=0)},1E4);f=a.Ia();a.track();if(f<a.Ia()&&a.useForcedLinkTracking&&c.target){for(e=c.target;e&&e!=a.b&&"A"!=e.tagName.toUpperCase()&&"AREA"!=e.tagName.toUpperCase();)e=e.parentNode;if(e&&(g=e.href,a.Ka(g)||(g=0),d=e.target,c.target.dispatchEvent&&g&&(!d||"_self"==d||"_top"==d||"_parent"==d||h.name&&d==h.name))){try{b=a.d.createEvent("MouseEvents")}catch(l){b=
new h.MouseEvent}if(b){try{b.initMouseEvent("click",c.bubbles,c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}catch(n){b=0}b&&(b["s_fe_"+a._in]=b.s_fe=1,c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),c.preventDefault(),a.l=c.target,a.J=b)}}}}}catch(p){a.clickObject=0}}},a.b&&a.b.attachEvent?a.b.attachEvent("onclick",a.v):a.b&&a.b.addEventListener&&(navigator&&(0<=navigator.userAgent.indexOf("WebKit")&&
a.d.createEvent||0<=navigator.userAgent.indexOf("Firefox/2")&&h.MouseEvent)&&(a.Ca=1,a.useForcedLinkTracking=1,a.b.addEventListener("click",a.v,!0)),a.b.addEventListener("click",a.v,!1))):setTimeout(a.Qa,30)};a.Qa();a.loadModule("ActivityMap")}
function s_gi(a){var h,n=window.s_c_il,p,l,r=a.split(","),s,q,u=0;if(n)for(p=0;!u&&p<n.length;){h=n[p];if("s_c"==h._c&&(h.account||h.oun))if(h.account&&h.account==a)u=1;else for(l=h.account?h.account:h.oun,l=h.allAccounts?h.allAccounts:l.split(","),s=0;s<r.length;s++)for(q=0;q<l.length;q++)r[s]==l[q]&&(u=1);p++}u||(h=new AppMeasurement);h.setAccount?h.setAccount(a):h.sa&&h.sa(a);return h}AppMeasurement.getInstance=s_gi;window.s_objectID||(window.s_objectID=0);
function s_pgicq(){var a=window,h=a.s_giq,n,p,l;if(h)for(n=0;n<h.length;n++)p=h[n],l=s_gi(p.oun),l.setAccount(p.un),l.setTagContainer(p.tagContainerName);a.s_giq=0}s_pgicq();

