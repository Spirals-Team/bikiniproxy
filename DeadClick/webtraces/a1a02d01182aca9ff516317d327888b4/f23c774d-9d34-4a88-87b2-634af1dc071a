/*************************
 * Croppie
 * Copyright 2015
 * Foliotek
 * Version: 1.0.3
 * https://github.com/foliotek/croppie
 *************************/

(function(e,t){typeof define=="function"&&define.amd?define("libs/jquery-plugins/community/croppie",["exports"],t):typeof exports=="object"&&typeof exports.nodeName!="string"?t(exports):t(e.commonJsStrict={})})(this,function(e){function o(e){if(e in n)return e;var r=e[0].toUpperCase()+e.slice(1),i=t.length;while(i--){e=t[i]+r;if(e in n)return e}}function u(e){e=e||{};for(var t=1;t<arguments.length;t++){var n=arguments[t];if(!n)continue;for(var r in n)n.hasOwnProperty(r)&&(typeof n[r]=="object"?e[r]=u({},n[r]):e[r]=n[r])}return e}function a(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)},u=n&&!r;clearTimeout(r),r=setTimeout(o,t),u&&e.apply(i,s)}}function f(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function l(e,t,n){if(typeof t=="string"){var r=t;t={},t[r]=n}for(var i in t)e.style[i]=t[i]}function c(e){var t=e.points,n=document.createElement("div"),r=document.createElement("img"),i=t[2]-t[0],s=t[3]-t[1];return n.classList.add("croppie-result"),n.appendChild(r),l(r,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),r.src=e.url,l(n,{width:i+"px",height:s+"px"}),n}function h(e,t){var n=t.points,r=n[0],i=n[1],s=n[2]-n[0],o=n[3]-n[1],u=t.circle,a=document.createElement("canvas"),f=a.getContext("2d"),l=s,c=o;return t.outputWidth&&t.outputHeight&&(l=t.outputWidth,c=t.outputHeight),a.width=l,a.height=c,f.drawImage(e,r,i,s,o,0,0,l,c),a.toDataURL()}function p(e,t){var n=t||new Image,r;return r=new Promise(function(t,r){e.substring(0,4).toLowerCase()==="http"&&n.setAttribute("crossOrigin","anonymous"),n.onload=function(){setTimeout(function(){t(n)},1)}}),n.src=e,r}function y(){var e=this,t=["croppie-container"],n=e.options.viewport.type?"cr-vp-"+e.options.viewport.type:null,r,i,s,o;e.data={},e.elements={},r=e.elements.boundary=document.createElement("div"),s=e.elements.viewport=document.createElement("div"),i=e.elements.img=document.createElement("img"),o=e.elements.overlay=document.createElement("div"),r.classList.add("cr-boundary"),l(r,{width:e.options.boundary.width+"px",height:e.options.boundary.height+"px"}),s.classList.add("cr-viewport"),n&&s.classList.add(n),l(s,{width:e.options.viewport.width+"px",height:e.options.viewport.height+"px"}),i.classList.add("cr-image"),o.classList.add("cr-overlay"),e.element.appendChild(r),r.appendChild(i),r.appendChild(s),r.appendChild(o),e.element.classList.add(t),e.options.customClass&&e.element.classList.add(e.options.customClass),T.call(this),e.options.showZoom&&w.call(e)}function b(e){this.options.showZoom&&(this.elements.zoomer.value=D(e))}function w(){function o(){x.call(e),r=new g(e.elements.img),i=e.elements.viewport.getBoundingClientRect(),s=m.parse(e.elements.img)}function u(){E.call(e,{value:parseFloat(n.value),origin:r||new g(e.elements.img),viewportRect:i||e.elements.viewport.getBoundingClientRect(),transform:s||m.parse(e.elements.img)})}function a(t){var n,r;t.wheelDelta?n=t.wheelDelta/1200:t.deltaY?n=t.deltaY/1060:t.detail?n=t.detail/60:n=0,r=e._currentZoom+n,t.preventDefault(),o(),b.call(e,r),u()}var e=this,t=e.elements.zoomerWrap=document.createElement("div"),n=e.elements.zoomer=document.createElement("input"),r,i,s;t.classList.add("cr-slider-wrap"),n.type="range",n.classList.add("cr-slider"),n.step="0.01",n.value=1,e.element.appendChild(t),t.appendChild(n),e._currentZoom=1,e.elements.zoomer.addEventListener("mousedown",o),e.elements.zoomer.addEventListener("touchstart",o),e.elements.zoomer.addEventListener("input",u),e.elements.zoomer.addEventListener("change",u),e.options.mouseWheelZoom&&(e.elements.boundary.addEventListener("mousewheel",a),e.elements.boundary.addEventListener("DOMMouseScroll",a))}function E(e){var t=this,n=e.transform,s=e.viewportRect,o=e.origin;t._currentZoom=e.value,n.scale=t._currentZoom;var u=S.call(t,s),a=u.translate,f=u.origin;n.x>=a.maxX&&(o.x=f.minX,n.x=a.maxX),n.x<=a.minX&&(o.x=f.maxX,n.x=a.minX),n.y>=a.maxY&&(o.y=f.minY,n.y=a.maxY),n.y<=a.minY&&(o.y=f.maxY,n.y=a.minY);var c={};c[i]=n.toString(),c[r]=o.toString(),l(t.elements.img,c),C.call(t),k.call(t)}function S(e){var t=this,n=t._currentZoom,r=e.width,i=e.height,s=t.options.boundary.width/2,o=t.options.boundary.height/2,u=t._originalImageWidth,a=t._originalImageHeight,f=u*n,l=a*n,c=r/2,h=i/2,p=(c/n-s)*-1,d=p-(f*(1/n)-r*(1/n)),v=(h/n-o)*-1,m=v-(l*(1/n)-i*(1/n)),g=1/n*c,y=f*(1/n)-g,b=1/n*h,w=l*(1/n)-b;return{translate:{maxX:p,minX:d,maxY:v,minY:m},origin:{maxX:y,minX:g,maxY:w,minY:b}}}function x(){var e=this,t=e._currentZoom,n=e.elements.img.getBoundingClientRect(),s=e.elements.viewport.getBoundingClientRect(),o=m.parse(e.elements.img.style[i]),u=new g(e.elements.img),a=s.top-n.top+s.height/2,f=s.left-n.left+s.width/2,c={},h={};c.y=a/t,c.x=f/t,h.y=(c.y-u.y)*(1-t),h.x=(c.x-u.x)*(1-t),o.x-=h.x,o.y-=h.y;var p={};p[r]=c.x+"px "+c.y+"px",p[i]=o.toString(),l(e.elements.img,p)}function T(){function a(i){i.preventDefault();if(t)return;t=!0,n=i.pageX,r=i.pageY,transform=m.parse(e.elements.img),window.addEventListener("mousemove",c),window.addEventListener("touchmove",c),window.addEventListener("mouseup",h),window.addEventListener("touchend",h),document.body.style[s]="none",u=e.elements.viewport.getBoundingClientRect()}function c(t){t.preventDefault();var s=t.pageX||t.touches[0].pageX,a=t.pageY||t.touches[0].pageY,c=s-n,h=a-r,p=e.elements.img.getBoundingClientRect(),d=transform.y+h,v=transform.x+c,m={};if(t.type=="touchmove"&&t.touches.length>1){var g=t.touches[0],y=t.touches[1],w=Math.sqrt((g.pageX-y.pageX)*(g.pageX-y.pageX)+(g.pageY-y.pageY)*(g.pageY-y.pageY));o||(o=w/e._currentZoom);var E=w/o;b.call(e,E),f(e.elements.zoomer);return}u.top>p.top+h&&u.bottom<p.bottom+h&&(transform.y=d),u.left>p.left+c&&u.right<p.right+c&&(transform.x=v),m[i]=transform.toString(),l(e.elements.img,m),N.call(e),r=a,n=s}function h(){t=!1,window.removeEventListener("mousemove",c),window.removeEventListener("touchmove",c),window.removeEventListener("mouseup",h),window.removeEventListener("touchend",h),document.body.style[s]="",x.call(e),k.call(e),o=0}var e=this,t=!1,n,r,o,u;e.elements.overlay.addEventListener("mousedown",a),e.elements.overlay.addEventListener("touchstart",a)}function N(){var e=this,t=e.elements.boundary.getBoundingClientRect(),n=e.elements.img.getBoundingClientRect();l(e.elements.overlay,{width:n.width+"px",height:n.height+"px",top:n.top-t.top+"px",left:n.left-t.left+"px"})}function k(){var e=this;L.call(e)&&e.options.update.call(e,e.get())}function L(){return this.elements.img.offsetHeight>0&&this.elements.img.offsetWidth>0}function A(){var e=this,t=0,n=1.5,s=1,o={},u=e.elements.img,a=e.elements.zoomer,c=new m(0,0,s),h=new g,p=L.call(e),d,v,y,w,E;if(!p||e.data.bound)return;e.data.bound=!0,o[i]=c.toString(),o[r]=h.toString(),l(u,o),d=u.getBoundingClientRect(),v=e.elements.viewport.getBoundingClientRect(),y=e.elements.boundary.getBoundingClientRect(),e._originalImageWidth=d.width,e._originalImageHeight=d.height,e.options.showZoom&&(w=v.width/d.width,E=v.height/d.height,t=Math.max(w,E),t>=n&&(n=t+1),a.min=D(t),a.max=D(n),s=Math.max(y.width/d.width,y.height/d.height),b.call(e,s),f(a)),e._currentZoom=c.scale=s,o[i]=c.toString(),l(u,o),e.data.points.length?O.call(e,e.data.points):M.call(e),N.call(e)}function O(e){if(e.length!=4)throw"Croppie - Invalid number of points supplied: "+e;var t=this,n=e[2]-e[0],s=t.elements.viewport.getBoundingClientRect(),o=t.elements.boundary.getBoundingClientRect(),u={left:s.left-o.left,top:s.top-o.top},a=s.width/n,f=e[1],c=e[0],h=-1*e[1]+u.top,p=-1*e[0]+u.left,d={};d[r]=c+"px "+f+"px",d[i]=(new m(p,h,a)).toString(),l(t.elements.img,d)}function M(){var e=this,t=e.elements.img.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),r=e.elements.boundary.getBoundingClientRect(),s=n.left-r.left,o=n.top-r.top,u=s-(t.width-n.width)/2,a=o-(t.height-n.height)/2,f=new m(u,a,e._currentZoom);l(e.elements.img,i,f.toString())}function _(e,t){var n=this,r,i=[];if(typeof e=="string")r=e,e={};else if(Array.isArray(e))i=e.slice();else{if(typeof e=="undefined"&&n.data.url)return A.call(n),k.call(n),null;r=e.url,i=e.points||[]}n.data.bound=!1,n.data.url=r||n.data.url,n.data.points=(i||n.data.points).map(function(e){return parseFloat(e)});var s=p(r,n.elements.img);return s.then(function(){A.call(n),k.call(n),t&&t()}),s}function D(e){return parseFloat(e).toFixed(2)}function P(){var e=this,t=e.elements.img.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),r=n.left-t.left,i=n.top-t.top,s=r+n.width,o=i+n.height,u=e._currentZoom;if(u===Infinity||isNaN(u))u=1;return r=Math.max(0,r/u),i=Math.max(0,i/u),s=Math.max(0,s/u),o=Math.max(0,o/u),{points:[D(r),D(i),D(s),D(o)],zoom:u}}function H(e){var t=this,n=P.call(t),r=e||{type:"canvas",size:"viewport"},i=typeof r=="string"?r:r.type,s=r.size||"viewport",o,u;return s==="viewport"&&(o=t.elements.viewport.getBoundingClientRect(),n.outputWidth=o.width,n.outputHeight=o.height),n.circle=t.options.viewport.type==="circle",n.url=t.data.url,u=new Promise(function(e,t){i==="canvas"?p(n.url).then(function(t){e(h(t,n))}):e(c(n))}),u}function B(){console.warn("Croppie.refresh() is deprecated.  Please use Croppie.bind() without any arguments instead.  refresh() will be removed in a later release."),A.call(this)}function j(){var e=this;e.element.removeChild(e.elements.boundary),e.options.showZoom&&e.element.removeChild(e.elements.zoomerWrap),delete e.elements}function I(e,t){this.element=e,this.options=u({},I.defaults,t),y.call(this)}var t=["Webkit","Moz","ms"],n=document.createElement("div").style,r,i,s;i=o("transform"),r=o("transformOrigin"),s=o("userSelect");var d="translate3d",v=", 0px",m=function(e,t,n){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(n)};m.parse=function(e){return e.style?m.parse(e.style[i]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?m.fromMatrix(e):m.fromString(e)},m.fromMatrix=function(e){var t=e.substring(7).split(",");if(!t.length||e==="none")t=[1,0,0,1,0,0];return new m(parseInt(t[4],10),parseInt(t[5],10),parseFloat(t[0]))},m.fromString=function(e){var t=e.split(") "),n=t[0].substring(d.length+1).split(","),r=t.length>1?t[1].substring(6):1,i=n.length>1?n[0]:0,s=n.length>1?n[1]:0;return new m(i,s,r)},m.prototype.toString=function(){return d+"("+this.x+"px, "+this.y+"px"+v+") scale("+this.scale+")"};var g=function(e){if(!e||!e.style[r]){this.x=0,this.y=0;return}var t=e.style[r].split(" ");this.x=parseFloat(t[0]),this.y=parseFloat(t[1])};g.prototype.toString=function(){return this.x+"px "+this.y+"px"};var C=a(N,500);if(this.jQuery){var F=this.jQuery;F.fn.croppie=function(e){var t=typeof e;if(t==="string"){var n=Array.prototype.slice.call(arguments,1),r=F(this).data("croppie");return e==="get"?r.get():e==="result"?r.result.apply(r,n):this.each(function(){var t=F(this).data("croppie");if(!t)return;var r=t[e];if(!F.isFunction(r))throw"Croppie "+e+" method not found";r.apply(t,n),e==="destroy"&&F(this).removeData("croppie")})}return this.each(function(){var t=new I(this,e);F(this).data("croppie",t)})}}I.defaults={viewport:{width:100,height:100,type:"square"},boundary:{width:300,height:300},customClass:"",showZoom:!0,mouseWheelZoom:!0,update:function(){}},u(I.prototype,{bind:function(e,t){return _.call(this,e,t)},get:function(){return P.call(this)},result:function(e){return H.call(this,e)},refresh:function(){return B.call(this)},destroy:function(){return j.call(this)}}),e.Croppie=window.Croppie=I}),function(){function a(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function f(e){return!!e.exifdata}function l(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/mi)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gmi,"");var n=atob(e),r=n.length,i=new ArrayBuffer(r),s=new Uint8Array(i);for(var o=0;o<r;o++)s[o]=n.charCodeAt(o);return i}function c(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){(this.status==200||this.status===0)&&t(this.response)},n.send()}function h(t,n){function r(e){var r=p(e),i=d(e);t.exifdata=r||{},t.iptcdata=i||{},n&&n.call(t)}if(t.src)if(/^data\:/i.test(t.src)){var i=l(t.src);r(i)}else if(/^blob\:/i.test(t.src)){var s=new FileReader;s.onload=function(e){r(e.target.result)},c(t.src,function(e){s.readAsArrayBuffer(e)})}else{var o=new XMLHttpRequest;o.onload=function(){if(this.status!=200&&this.status!==0)throw"Could not load image";r(o.response),o=null},o.open("GET",t.src,!0),o.responseType="arraybuffer",o.send(null)}else if(window.FileReader&&(t instanceof window.Blob||t instanceof window.File)){var s=new FileReader;s.onload=function(t){e&&console.log("Got file of length "+t.target.result.byteLength),r(t.target.result)},s.readAsArrayBuffer(t)}}function p(t){var n=new DataView(t);e&&console.log("Got file of length "+t.byteLength);if(n.getUint8(0)!=255||n.getUint8(1)!=216)return e&&console.log("Not a valid JPEG"),!1;var r=2,i=t.byteLength,s;while(r<i){if(n.getUint8(r)!=255)return e&&console.log("Not a valid marker at offset "+r+", found: "+n.getUint8(r)),!1;s=n.getUint8(r+1),e&&console.log(s);if(s==225)return e&&console.log("Found 0xFFE1 marker"),w(n,r+4,n.getUint16(r+2)-2);r+=2+n.getUint16(r+2)}}function d(t){var n=new DataView(t);e&&console.log("Got file of length "+t.byteLength);if(n.getUint8(0)!=255||n.getUint8(1)!=216)return e&&console.log("Not a valid JPEG"),!1;var r=2,i=t.byteLength,s=function(e,t){return e.getUint8(t)===56&&e.getUint8(t+1)===66&&e.getUint8(t+2)===73&&e.getUint8(t+3)===77&&e.getUint8(t+4)===4&&e.getUint8(t+5)===4};while(r<i){if(s(n,r)){var o=n.getUint8(r+7);o%2!==0&&(o+=1),o===0&&(o=4);var u=r+8+o,a=n.getUint16(r+6+o);return m(t,u,a)}r++}}function m(e,t,n){var r=new DataView(e),i={},s,o,u,a,f,l=t;while(l<t+n)r.getUint8(l)===28&&r.getUint8(l+1)===2&&(a=r.getUint8(l+2),a in v&&(u=r.getInt16(l+3),f=u+5,o=v[a],s=b(r,l+5,u),i.hasOwnProperty(o)?i[o]instanceof Array?i[o].push(s):i[o]=[i[o],s]:i[o]=s)),l++;return i}function g(t,n,r,i,s){var o=t.getUint16(r,!s),u={},a,f,l;for(l=0;l<o;l++)a=r+l*12+2,f=i[t.getUint16(a,!s)],!f&&e&&console.log("Unknown tag: "+t.getUint16(a,!s)),u[f]=y(t,a,n,r,s);return u}function y(e,t,n,r,i){var s=e.getUint16(t+2,!i),o=e.getUint32(t+4,!i),u=e.getUint32(t+8,!i)+n,a,f,l,c,h,p;switch(s){case 1:case 7:if(o==1)return e.getUint8(t+8,!i);a=o>4?u:t+8,f=[];for(c=0;c<o;c++)f[c]=e.getUint8(a+c);return f;case 2:return a=o>4?u:t+8,b(e,a,o-1);case 3:if(o==1)return e.getUint16(t+8,!i);a=o>2?u:t+8,f=[];for(c=0;c<o;c++)f[c]=e.getUint16(a+2*c,!i);return f;case 4:if(o==1)return e.getUint32(t+8,!i);f=[];for(c=0;c<o;c++)f[c]=e.getUint32(u+4*c,!i);return f;case 5:if(o==1)return h=e.getUint32(u,!i),p=e.getUint32(u+4,!i),l=new Number(h/p),l.numerator=h,l.denominator=p,l;f=[];for(c=0;c<o;c++)h=e.getUint32(u+8*c,!i),p=e.getUint32(u+4+8*c,!i),f[c]=new Number(h/p),f[c].numerator=h,f[c].denominator=p;return f;case 9:if(o==1)return e.getInt32(t+8,!i);f=[];for(c=0;c<o;c++)f[c]=e.getInt32(u+4*c,!i);return f;case 10:if(o==1)return e.getInt32(u,!i)/e.getInt32(u+4,!i);f=[];for(c=0;c<o;c++)f[c]=e.getInt32(u+8*c,!i)/e.getInt32(u+4+8*c,!i);return f}}function b(e,t,r){var i="";for(n=t;n<t+r;n++)i+=String.fromCharCode(e.getUint8(n));return i}function w(t,n){if(b(t,n,4)!="Exif")return e&&console.log("Not valid EXIF data! "+b(t,n,4)),!1;var r,a,f,l,c,h=n+6;if(t.getUint16(h)==18761)r=!1;else{if(t.getUint16(h)!=19789)return e&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;r=!0}if(t.getUint16(h+2,!r)!=42)return e&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var p=t.getUint32(h+4,!r);if(p<8)return e&&console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(h+4,!r)),!1;a=g(t,h,h+p,s,r);if(a.ExifIFDPointer){l=g(t,h,h+a.ExifIFDPointer,i,r);for(f in l){switch(f){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":l[f]=u[f][l[f]];break;case"ExifVersion":case"FlashpixVersion":l[f]=String.fromCharCode(l[f][0],l[f][1],l[f][2],l[f][3]);break;case"ComponentsConfiguration":l[f]=u.Components[l[f][0]]+u.Components[l[f][1]]+u.Components[l[f][2]]+u.Components[l[f][3]]}a[f]=l[f]}}if(a.GPSInfoIFDPointer){c=g(t,h,h+a.GPSInfoIFDPointer,o,r);for(f in c){switch(f){case"GPSVersionID":c[f]=c[f][0]+"."+c[f][1]+"."+c[f][2]+"."+c[f][3]}a[f]=c[f]}}return a}var e=!1,t=this,r=function(e){if(e instanceof r)return e;if(!(this instanceof r))return new r(e);this.EXIFwrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=r),exports.EXIF=r):t.EXIF=r;var i=r.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},s=r.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},o=r.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},u=r.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},v={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};r.getData=function(e,t){return(e instanceof Image||e instanceof HTMLImageElement)&&!e.complete?!1:(f(e)?t&&t.call(e):h(e,t),!0)},r.getTag=function(e,t){if(!f(e))return;return e.exifdata[t]},r.getAllTags=function(e){if(!f(e))return{};var t,n=e.exifdata,r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);return r},r.pretty=function(e){if(!f(e))return"";var t,n=e.exifdata,r="";for(t in n)n.hasOwnProperty(t)&&(typeof n[t]=="object"?n[t]instanceof Number?r+=t+" : "+n[t]+" ["+n[t].numerator+"/"+n[t].denominator+"]\r\n":r+=t+" : ["+n[t].length+" values]\r\n":r+=t+" : "+n[t]+"\r\n");return r},r.readFromBinaryFile=function(e){return p(e)},typeof define=="function"&&define.amd&&define("exif-js",[],function(){return r})}.call(this),define("modules/community/login-facebook",["jquery-full","facebook","base/base","helpers/helpers"],function(e,t,n,r){"use strict";var i=n.elements.getBody(),s={},o=!1,u=!1,a="unknow",f={},l={},c=!1,h="",p={},d={onLoginRequest:function(){},onMissingEmailPermissionFb:function(){},onLogoutEnd:function(){}},v={callbacks:{onGetFacebookPictures:[]},init:function(){v.reflow(),v.initProcess()},reflow:function(){v.reflowElements(),v.reflowEvents()},reflowElements:function(){s=i.find(".social-buttons .facebook")},reflowEvents:function(){s.off().on("click",function(t){t.preventDefault(),t.stopPropagation();var n=e(this).data("action");switch(n){case"revoke":v.revoke();break;case"ask-pictures":v.askPicturesPermissions();break;case"synchronize":v.synchronize();break;default:v.login()}})},initProcess:function(){var e=function(){v.getLoginStatus()};r.social.initFacebook(e)},getLoginStatus:function(){t.getLoginStatus(function(e){if(e!=null){a=e.status,f=e.authResponse;switch(e.status){case"connected":v.getPermissions();break;case"not_authorized":break;default:}}})},getPermissions:function(){t.api("/me/permissions",function(e){e!=null&&v.checkPermissions(e.data)})},checkPermissions:function(t){var n=[];e.each(t,function(t,r){var i=r.permission,s=r.status;(e.inArray(i,o.scope)==-1||s=="declined")&&n.push(i)}),e.inArray("email",n)>-1?(o.scope=["public_profile","email"],d.onMissingEmailPermissionFb()):v.requestBasics()},requestBasics:function(){t.api("/me?fields=email,birthday,name,gender,verified,last_name,first_name",function(e){if(e!=null)if(c)l.socialType="Facebook",l.id=e.id,l.avatar="//graph.facebook.com/"+l.id+"/picture",l.accessToken=f.accessToken,d.onSynchronizeRequest(l),c=!1;else{if(e.birthday!=null&&e.birthday!=""){var t=e.birthday.split("/");e.birthday=t[1]+t[0]+t[2]}l=e,l.socialType="Facebook",l.pseudo=l.name,l.avatar="//graph.facebook.com/"+l.id+"/picture",l.accessToken=f.accessToken,l.email||(l.email=""),d.onLoginRequest(l)}})},login:function(){t.login(function(e){v.getLoginStatus()},{scope:o.scope.join(","),auth_type:"rerequest"})},synchronize:function(){t.login(function(e){c=!0,v.getLoginStatus()},{scope:o.scope.join(","),auth_type:"rerequest"})},logout:function(){t.getAuthResponse()==null?d.onLogoutEnd(o.name):t.logout(function(e){d.onLogoutEnd(o.name)})},revoke:function(){t.api("/me/permissions","DELETE")},askPicturesPermissions:function(){t.login(function(e){t.api("/me/photos?type=uploaded",function(e){e!=null&&(p=e.data,v._runCallbacks("onGetFacebookPictures"))})},{scope:"user_photos",auth_type:"rerequest"})},registerCallback:function(e,t){typeof t=="function"&&this.callbacks[e].push(t)},unRegisterCallback:function(e,t){if(typeof t=="function"){var n=this.callbacks[e].indexOf(t);n!=-1&&this.callbacks[e].splice(n,1)}},_runCallbacks:function(t){e.each(this.callbacks[t],function(e,t){t(p)})}},m={initialize:function(e,t){o=e,d=r.mergeObject.mergeObject(d,t,!0),v.init()},reflow:function(){v.reflow()},onGetFacebookPictures:function(e){v.registerCallback("onGetFacebookPictures",e)},synchronize:function(e){v.synchronize(e)},logout:function(){v.logout()},revoke:function(){v.revoke()}};return m}),define("modules/community/login-google",["jquery-full","google","base/base","helpers/helpers"],function(e,t,n,r){"use strict";var i=n.elements.getBody(),s={},o=!1,u=!1,a="unknow",f={},l={},c=!1,h={onLoginEnd:function(){},onLoginRequest:function(){},onSynchronizeRequest:function(){},onLogoutEnd:function(){}},p={init:function(){p.reflow()},reflow:function(){p.reflowElements(),p.reflowEvents()},reflowElements:function(){s=i.find(".social-buttons .google")},reflowEvents:function(){s.on("click",function(t){t.preventDefault(),t.stopPropagation();var n=e(this).data("action");switch(n){case"revoke":p.revoke();break;case"synchronize":p.synchronize();break;default:p.login()}})},getLoginStatus:function(e){e.status.method=="PROMPT"&&e.access_token&&p.requestBasics()},requestBasics:function(){gapi.client.load("plus","v1",function(){var e=gapi.client.plus.people.get({userId:"me"});e.execute(function(e){e!=null&&(c?(l.socialType="Google",l.id=e.id,l.avatar=e.image.url,l.accessToken=gapi.auth.getToken().access_token,h.onSynchronizeRequest(l),c=!1):(l.socialType="Google",l.id=e.id,l.pseudo=e.displayName,l.gender=e.gender,l.avatar=e.image.url,l.email=e.emails[0].value,l.last_name=e.name.familyName,l.first_name=e.name.givenName,l.accessToken=gapi.auth.getToken().access_token,l.id&&l.email&&(l.email||(l.email=""),h.onLoginRequest(l))))})})},login:function(e){gapi.auth.authorize({client_id:o.appId,immediate:!1,cookiepolicy:o.cookiepolicy,scope:o.scope},function(e){e.status.signed_in&&p.getLoginStatus(e)})},synchronize:function(){gapi.auth.authorize({client_id:o.appId,immediate:!1,cookiepolicy:o.cookiepolicy,scope:o.scope},function(e){e.status.signed_in&&(c=!0,p.getLoginStatus(e))})},logout:function(){},revoke:function(){}},d={initialize:function(e,t){o=e,h=r.mergeObject.mergeObject(h,t,!0),p.init()},reflow:function(){p.reflow()},logout:function(){p.logout()}};return d}),define("modules/community/login-vkontakte",["jquery-full","vkontakte","base/base","helpers/helpers"],function(e,t,n,r){"use strict";var i=n.elements.getBody(),s={},o=!1,u=!1,a="unknow",f={},l={},c=!1,h={onLoginEnd:function(){},onLoginRequest:function(){},onSynchronizeRequest:function(){},onLogoutEnd:function(){}},p={init:function(){p.reflow(),p.initProcess()},reflow:function(){p.reflowElements(),p.reflowEvents()},reflowElements:function(){s=i.find(".social-buttons .vk")},reflowEvents:function(){s.on("click",function(t){t.preventDefault(),t.stopPropagation();var n=e(this).data("action");switch(n){case"revoke":p.revoke();break;case"synchronize":p.synchronize();break;default:p.login()}})},initProcess:function(){t.init({apiId:o.appId})},getLoginStatus:function(e){t.Auth.getLoginStatus(function(e){e.session&&p.requestBasics(e.session.mid)})},requestBasics:function(e){t.Api.call("users.get",{uids:e,fields:"sex,photo_medium,bdate,nickname"},function(e){if(e!=null){var t=e.response[0];if(c)l.socialType="Vkontakte",l.id=t.uid,l.avatar=t.photo_medium,h.onSynchronizeRequest(l),c=!1;else{if(t.bdate!=null&&t.bdate!=""){var n=t.bdate.split(".");l.birthday=n[0]+n[1]+n[2]}l.socialType="Vkontakte",l.id=t.uid,l.pseudo=t.nickname!=""?t.nickname:t.first_name+t.last_name,l.gender=t.sex,l.avatar=t.photo_medium,l.last_name=t.last_name,l.first_name=t.first_name,h.onLoginRequest(l)}}})},login:function(){t.Auth.login(function(e){p.getLoginStatus(e)})},synchronize:function(){t.Auth.login(function(e){c=!0,p.getLoginStatus(e)})},logout:function(){t.Auth.getLoginStatus(function(e){e.status=="connected"?t.Auth.logout(function(){h.onLogoutEnd(o.name)}):h.onLogoutEnd(o.name)})},revoke:function(){}},d={initialize:function(e,t){o=e,h=r.mergeObject.mergeObject(h,t,!0),p.init()},reflow:function(){p.reflow()},logout:function(){p.logout()}};return d}),define("modules/community/login-twitter",function(){}),define("modules/community/login",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws"],function(e,t,n,r,i){"use strict";var s=t.elements.getBody(),o=s.find("#login__form"),u=e(".avatar-eurosport"),a=new n.form,f=new r.loader,l=new r.loader,c=new r.loader,h={Facebook:{login:e("#social-button-facebook-login"),subscription:e("#social-button-facebook-subscription")},Google:{login:e("#social-button-google-login"),subscription:e("#social-button-google-subscription")},Vkontakte:{login:e("#social-button-vk-login"),subscription:e("#social-button-vk-subscription")}},f=new r.loader,p={},d={eurosport:{name:"none",active:!0,load:"onOpenPopup",isLoaded:!1},facebook:{name:"facebook",active:!0,load:"onLoad",isLoaded:!1,appId:t.storage.community.get("socialFacebookId"),scope:["public_profile","email","user_birthday"]},google:{name:"googlePlus",active:!0,load:"onOpenPopup",isLoaded:!1,appId:t.storage.community.get("socialGoogleId"),scope:["profile","email"],appPackageName:"com.eurosport",cookiepolicy:"single_host_origin"},vk:{name:"vk",active:!0,load:"onOpenPopup",isLoaded:!1,appId:t.storage.community.get("socialVkontakteId")}},v={onSocialEmailMissing:function(){}},m={init:function(r,i){if(!m.initElements())return;v=n.mergeObject.mergeObject(v,i,!0),e.each(d,function(e,i){i.active==1&&r==i.load&&!i.isLoaded&&(i.name=="none"?(m.initForm(),m.initEvents()):m.initSocials(i,{onLoginRequest:function(e){n.community.isConnected()||m.loginSocialRequest(e)},onMissingEmailPermissionFb:function(){a.showSubmitError(p.submit,t.storage.labels.get("7480"))},onLogoutEnd:function(){m.logoutSuccess()},onSynchronizeRequest:function(e){m.synchronizeSocialRequest(e)}}),i.isLoaded=!0)})},initElements:function(){return p.email=o.find(".input-email"),p.password=o.find(".input-password"),p.submit=o.find(".submit-button"),p.submitError=p.submit.parent().find(".message-error"),p.submitErrorLabel=p.submitError.find(".message"),p.email.length==0||p.password.length==0||p.submit.length==0||p.submitError.length==0||p.submitErrorLabel.length==0?(console.error("Login : Missing element(s) in form",p),!1):!0},initForm:function(){var e=[{key:"email",type:"text",element:p.email,checkOptions:["mandatory","email","noIllegalChars"]},{key:"password",type:"password",element:p.password,checkOptions:["mandatory"]}];a.add(e)},initEvents:function(){p.submit.on("click",function(e){e.preventDefault(),e.stopPropagation(),m.loginEurosportProcess()})},initSocials:function(e,n){var r=function(t){e.instance=t,t.initialize(e,n)};switch(e.name){case"facebook":require(["modules/community/login-facebook"],r);break;case"googlePlus":require(["modules/community/login-google"],r);break;case"vk":t.storage.context.get("languageid")==15&&require(["modules/community/login-vkontakte"],r);break;case"twitter":require(["modules/community/login-twitter"],r)}},loginEurosportProcess:function(){a.hideSubmitError(p.submit);if(!a.isValidForSend())return!1;var e=a.getValues(),n={email:e.email,password:e.password,dropletId:t.storage.context.get("dropletId")};f.append(p.submit.parent(),!0),m.loginEurosportRequest(n)},loginEurosportRequest:function(e){var n=i.community.get("LoginEurosport"),r=new i.ajax(n,{success:function(e){f.detach(!1),e.Success==1?m.loginSuccess(e.Message):(f.detach(!1),a.showSubmitError(p.submit,e.Message))},error:function(){f.detach(!1),a.showSubmitError(p.submit,t.storage.labels.get("3414"))}});r.send(e)},loginSocialRequest:function(e){l.append(h[e.socialType].subscription.parent(),!0),c.append(h[e.socialType].login.parent(),!0);var n="";switch(e.socialType){case"Facebook":n=i.community.get("LoginFacebook");break;case"Google":n=i.community.get("LoginGoogle");break;case"Vkontakte":n=i.community.get("LoginVkontakte");break;case"Twitter":n=i.community.get("LoginTwitter")}if(n==""){console.warn("loginSocialRequest : Social not found",e.socialType);return}var r={email:e.email||"",pseudo:e.pseudo||"",lastname:e.last_name||"",firstname:e.first_name||"",birthdate:e.birthday||"",sex:e.gender=="male"?1:e.gender=="female"?2:-1,socialUserId:e.id||"",socialUserAvatar:e.avatar||"",accessToken:e.accessToken||"",dropletId:t.storage.context.get("dropletId")},s=new i.ajax(n,{success:function(n){l.detach(!1),c.detach(!1);if(n.Success==1)m.loginSuccess(n.Message);else switch(n.Code){case 10:v.onSocialEmailMissing(e,n.Message);break;case 20:a.showSubmitError(p.submit,n.Message);break;default:a.showSubmitError(p.submit,t.storage.labels.get("3414"))}},error:function(){l.detach(!1),c.detach(!1),a.showSubmitError(p.submit,t.storage.labels.get("3414"))}});r.socialUserId!=""?s.send(r):a.showSubmitError(p.submit,t.storage.labels.get("3414"))},loginSuccess:function(t){var i=e.getUrlVars(),s=e.inArray("urlReferrer",i);if(s==-1){var o=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t}),f=n.modals.get("modal_community"),l=function(){a.reset(),n.community.loginSuccess(),new r.notification({element:o,duration:5e3}),n.community.playPictureAnimation(u),f.removeOnAfterClose(l)};f.onAfterClose(l),f.close()}else window.location.href=e.getUrlVar("urlReferrer")},synchronizeSocialRequest:function(s){var o="";switch(s.socialType){case"Facebook":o=i.community.get("SynchronizeFacebook");break;case"Google":o=i.community.get("SynchronizeGoogle");break;case"Vkontakte":o=i.community.get("SynchronizeVkontakte")}if(o==""){console.warn("synchronizeSocialRequest : Social not found",s.socialType);return}var u={socialUserId:s.id||"",socialUserAvatar:s.avatar||"",accessToken:s.accessToken||"",dropletId:t.storage.context.get("dropletId")},a=new i.ajax(o,{success:function(i){if(i.Success==1)n.community.synchronizeSuccess(s);else{var o=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:o,duration:5e3})}},error:function(){var n=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:n,duration:5e3})}});if(u.socialUserId!="")a.send(u);else{var f=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:f,duration:5e3})}},logoutRequest:function(r){e.removeCookie("CommunityUser",{path:"/",domain:n.community.getCookieBaseDomain()}),e.removeCookie("CommunityUserNew",{path:"/",domain:n.community.getCookieBaseDomain()}),e.removeCookie("CommunityUserCheck",{path:"/",domain:n.community.getCookieBaseDomain()}),e.removeCookie("personalizationNew",{path:"/",domain:n.community.getCookieBaseDomain()}),t.localStorage.remove("personalization"),e.each(d,function(e,t){t.name.toUpperCase()==r.toUpperCase()&&(t.name=="facebook"?t.instance.logout():m.logoutSuccess())})},logoutSuccess:function(){n.community.logoutSuccess();if(!n.community.isCommunityPage()){var i=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("6741")});new r.notification({element:i,duration:5e3})}else t.localStorage.set("action","logout"),window.location.href="/"},deleteAccountRequest:function(r){e.removeCookie("CommunityUser",{path:"/",domain:n.community.getCookieBaseDomain()}),e.removeCookie("CommunityUserNew",{path:"/",domain:n.community.getCookieBaseDomain()}),e.removeCookie("CommunityUserCheck",{path:"/",domain:n.community.getCookieBaseDomain()}),e.removeCookie("personalizationNew",{path:"/",domain:n.community.getCookieBaseDomain()}),t.localStorage.remove("personalization")}},g={initializeOnLoad:function(e){m.init("onLoad",e)},initializeOnOpenPopup:function(e){m.init("onOpenPopup",e)},loginSuccess:function(e){m.loginSuccess(e)},logout:function(e){m.logoutRequest(e)},deleteAccount:function(e){m.deleteAccountRequest(e)}};return g}),define("modules/community/personalization-profile",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/login"],function(e,t,n,r,i,s){"use strict";var o=t.elements.getBody(),u=null,a=null,f=null,l=null,c=null,h=null,p=0,d=null,v=null,m=!1,g=new r.loader("small"),y={init:function(){y.reflow()},reflow:function(){y.reflowElements(),y.reflowUserEvents(),y.reflowEvents(),y.reflowFavoritesButtonsStatus()},reflowElements:function(){u=e(".favorites-button"),a=e("#favorites-edit-button"),f=e("#no-favorites-popup__button"),c=e("#myfavorites-container"),l=e("#favorites-suggested-container"),h=e("#myfavorites__no-follows"),u.addClass("loaded")},reflowUserEvents:function(){n.community.onLoginSuccess(function(){y.reflowEvents()}),n.bookmarks.onAddSuccess(function(e){y.setBookmarksSuccess(e),e.elem.addClass("selected")}),n.bookmarks.onRemoveSuccess(function(e){y.setBookmarksSuccess(e),e.elem.removeClass("selected")}),n.bookmarks.onAddComplete(function(e){g.detach(!1),u.not(e.elem).removeClass("not-active")}),n.bookmarks.onRemoveComplete(function(e){g.detach(!1),u.not(e.elem).removeClass("not-active")}),n.bookmarks.onLimitReached(function(e){g.detach(!1),u.not(e.elem).removeClass("not-active")}),n.bookmarks.onGetSuccess(function(e){y.reflowFavoritesButtonsStatus(e)})},reflowEvents:function(){n.community.isConnected()&&e.each(u,function(t,n){y.reflowEventFavorite(n,e(n).find(".favorites-field-star, .storyfull__favorite-button"))}),a.off("click.favorites").on("click.favorites",function(e){n.community.isConnected()?y.openModalProfile():(e.stopPropagation(),y.openModalCommunity())}),f.off("click.favorites").on("click.favorites",function(e){n.community.isConnected()?y.openModalProfile():(e.stopPropagation(),y.openModalCommunity())})},reflowFavoritesButtonsStatus:function(t){var r=[];t!=null?r=t:r=n.bookmarks.getLocalStorage(),u.removeClass("selected"),e.each(r,function(t,n){var r=n.entity,i=n.typenu,s=r+"_"+i,o=u.filter("[data-id='"+s+"']");o.length>0&&(y.updateButtonLabel(e(o),!0),e(o).addClass("selected"))})},setBookmarksSuccess:function(e){y.reflowFavoritesButtonsStatus(),y.pasteFavoriteButton(e.id,e.typenu,e.entity,e.elem),y.updateButtonLabel(e.elem,!0),e.elem.find(".svg-favorite").addClass("bounceIn")},updateButtonLabel:function(e,t){if(e.hasClass("storyfull__favorite-container"))y.setLabelToButton(e,t);else if(!t){var n=e.data("id");e=o.find('.storyfull__favorite-container[data-id="'+n+'"]'),e.length>0&&y.setLabelToButton(e,t)}},setLabelToButton:function(e,t){if(d===null||v===null)d=e.data("label-favorite"),v=e.data("label-favorited");var n=t?v:d;e.find(".storyfull__favorite-button-text").text(n)},openModalProfile:function(){a.data("is-active",1);var e=n.modals.get("modal_myprofile"),t=e.getElement();e.onAfterClose(function(){a.data("is-active")==1&&(n.navTabs.getElements("navtab_storylist_latest_personal")[0].activate(),a.data("is-active",0))})},openModalCommunity:function(){var e=n.modals.get("modal_community");e.open()},reflowEventFavorite:function(t,r){r.off("click.favorites").on("click.favorites",function(){var i=e(t);if(i.hasClass("not-active"))return;var s=i.data("id"),o=i.data("typenu"),a=i.data("netsportid"),f=i.data("type");m=!i.hasClass("selected"),g.append(r,!0),u=e(".favorites-button"),u.not(i).addClass("not-active"),m?(l.find(".favorites-button").length==1&&n.bookmarks.countItemsLocalStorage()<30&&l.closest(".favorites-suggested-wrapper").slideUp(800),n.bookmarks.add(i,s,a,o)):n.bookmarks.remove(i,s,a,o)})},pasteFavoriteButton:function(e,t,n,r){var i=r.data("mode")?r.data("mode"):"",s=r.data("type")?r.data("type"):"";i=="myprofile"&&s=="suggestedFavorite"?(y.copyFavoriteTo(r,c,e,t,n,"myFavorite"),y.removeFavoriteFrom(r,l)):i=="myprofile"&&s=="myFavorite"?y.removeFavoriteFrom(r,c):m?(y.copyFavoriteTo(r,c,e,t,n,"myFavorite"),y.removeFavoriteFrom(r,l)):(y.removeFavoriteFrom(r,c),y.removeFavoriteFrom(r,l))},copyFavoriteTo:function(e,t,r,i,s,o){var u=y.buildFavorite(e,r,i,s,o);y.reflowEventFavorite(u,u.find(".favorites-field-star, .storyfull__favorite-button")),u.appendTo(t),n.bookmarks.countItemsLocalStorage()>0&&h.addClass("hide")},removeFavoriteFrom:function(e,t){var r=l.find(e).nextAll(".hide:first");r.removeClass("hide");var i=e.data("id"),s=t.find('.favorites-button[data-id="'+i+'"]');s.addClass("hide"),setTimeout(function(){s.detach()},200),n.bookmarks.countItemsLocalStorage()==0&&h.removeClass("hide")},buildFavorite:function(t,n,r,i,s){var o=t.data("name")?t.data("name"):"",u=t.data("picture")?t.data("picture"):"",a=t.data("link")?t.data("link"):"",f=e("<div>",{"class":"myprofile-row-wrapper favorites-button selected","data-id":n,"data-typenu":r,"data-netsportid":i,"data-name":o,"data-picture":u,"data-link":a,"data-mode":"myprofile","data-type":s});if(a!="")var l=e("<a>",{href:a,"class":"myprofile__description-left"});else var l=e("<div>",{"class":"myprofile__description-left"});if(r==0||u=="")var c=e("<span>",{"class":"svg-font svg-sports svg-sport-"+i});else var c=e("<img>",{"class":"favorites-field-img",alt:o,src:u});var h=e("<div>",{"class":"favorites-field-name",html:o}),p=e("<div>",{"class":"favorites-field-star"}),d=e("<span>",{"class":"svg-font svg-favorite"});return l.append(c).append(h),p.append(d),f.append(l).append(p),f}},b={initialize:function(){y.init()},reflow:function(){y.reflow()}};return b}),define("modules/community/myprofile/favorites",["jquery-full","base/base","helpers/helpers","modules/community/personalization-profile","ws/ws"],function(e,t,n,r,i){"use strict";var s={init:function(){n.sliderNavs.reflow(),r.reflow(),n.bookmarks.get(),e.supportsTouch&&e(".favorites-button").addClass("no-hover")}},o={initialize:function(e){s.init()}};return o}),define("modules/community/myprofile/account-pictures",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/login","modules/community/login-facebook","modules/community/login-google","modules/community/login-vkontakte"],function(e,t,n,r,i,s,o,u,a){"use strict";var f=t.elements.getBody(),l={},c=!1,h,p,d=null,v={},m={},g={},y={},b={},w={},E=new r.loader,S=null,x={init:function(){x.initElements(),x.initEvents(),S=n.sliderNavs.get("slider-nav__account")},initElements:function(){b.pictures={},b.pictures.$description=e("#account-pictures-description"),b.pictures.$selectedPictureContainer=e("#selected-picture-container"),b.pictures.$selectedPicture=b.pictures.$selectedPictureContainer.find("img"),b.pictures.$smallPictures=e(".account-upload-link").find("img"),b.pictures.$eurosportPictures=e(".avatar-eurosport"),b.pictures.$eurosportPicture=e("#img-account-none"),b.pictures.$eurosportPictureLabel=b.pictures.$eurosportPicture.closest(".account-upload-link").find(".social-label"),b.pictures.$eurosportPictureModeration=e("#moderation-status"),b.pictures.$eurosportPictureUploadInput=e("#upload-picture-input"),b.pictures.$eurosportPictureUploadButton=e("#upload-picture-button"),b.pictures.$facebookPicturesLink=e("#picture-upload-facebook"),b.pictures.$googlePicturesLink=e("#picture-upload-google"),v=e("#account-eurosport-upload"),m=v.find(".upload-picture-container"),g=e("#account-facebook-pictures"),y=e("#account-google-pictures")},initEvents:function(){b.pictures.$smallPictures.each(function(t,n){e(n).on("click.smallPictures",function(){e(this).hasClass("selected")||x.changeSelectedPicture(e(this))})}),m.on("dragenter",function(){return e(this).addClass("focus"),!1}),m.on("dragover",function(t){return t.preventDefault(),t.stopPropagation(),e(this).addClass("focus"),!1}),m.on("dragleave",function(t){return t.preventDefault(),t.stopPropagation(),e(this).removeClass("focus"),!1}),m.on("drop",function(t){return t.originalEvent.dataTransfer?t.originalEvent.dataTransfer.files.length&&(t.preventDefault(),t.stopPropagation(),e(this).removeClass("focus"),x.uploadPictureFileApi(t.originalEvent.dataTransfer.files)):e(this).css("border","3px dashed #BBBBBB"),!1}),b.pictures.$eurosportPictureUploadButton.on("click",function(){b.pictures.$eurosportPictureUploadInput.click()}),b.pictures.$eurosportPictureUploadInput.on("change",function(e){window.File&&window.FileReader&&window.FileList&&window.Blob?c||(c=!0,x.uploadPictureFileApi(e.target.files)):console.info("The File APIs are not fully supported in this browser.")}),o.reflow(),u.reflow(),t.storage.context.get("languageid")==15&&a.reflow(),o.onGetFacebookPictures(function(e){_isPicturesFacebookContainerInitialize||(x.initPicturesFacebookElements(),_isPicturesFacebookContainerInitialize=!0),x.initPicturesFacebookDisplay(e)}),n.community.onSynchronizeSuccess(function(t){if(t!=null){var r="#img-account-"+t.social.toLowerCase();switch(t.social){case"Facebook":t.avatar=t.avatar+"?width=100&height=100";break;case"Google":t.avatar=t.avatar.replace("sz=50","sz=100")}e(r).attr("src",t.avatar),n.community.playPictureAnimation(e(r))}})},changeSelectedPicture:function(e){x.changeSelectedPictureProcess(e)},changeSelectedPictureProcess:function(e){var n={socialType:e.data("social"),dropletId:t.storage.context.get("dropletId")};E.append(b.pictures.$selectedPictureContainer,!0),x.changeSelectedPictureRequest(n,e)},changeSelectedPictureRequest:function(s,o){var u=i.community.get("UpdateSelectedAvatar"),a=new i.ajax(u,{success:function(i){E.detach(!1);if(i.Success==1)o.hasClass("progress")?b.pictures.$eurosportPictures.attr("src",t.storage.community.get("defaultAvatarUrl")):b.pictures.$eurosportPictures.attr("src",o.attr("src")),b.pictures.$smallPictures.removeClass("selected"),o.addClass("selected"),n.community.playPictureAnimation(b.pictures.$selectedPicture),n.community.playPictureAnimation(b.pictures.$eurosportPictures);else{var s=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i.Message});new r.notification({element:s,duration:5e3})}},error:function(){E.detach(!1);var n=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:n,duration:5e3})}});a.send(s)},uploadPictureFileApi:function(n){var i=new r.loader;for(var s=0,o;o=n[s];s++){if(!o.type.match("image.jpeg")&&!o.type.match("image.png")&&!o.type.match("image.gif")){var u=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("5892").replace("{0}",o.type)});new r.notification({element:u,duration:5e3}),c=!1;continue}if(o.size>1048576){var u=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("5893").replace("{0}","1")});new r.notification({element:u,duration:5e3}),c=!1;continue}var a=o;m.find(".upload-picture-text").fadeOut(function(){m.attr("draggable","false"),m.css("line-height","normal"),i.append(m,!0);var e=new FileReader;e.onload=function(e){return function(e){setTimeout(function(){x.loadExif(e),i.detach(!1),x.loadPicture(e.target.result)},1e3)}}(a),e.readAsDataURL(a)})}},loadExif:function(e){var t=function(){p.pretty(e)};p==null?require(["exif-js"],function(e){p=e,t()}):t()},loadPicture:function(e){x.loadCropping(e)},loadCropping:function(n){l=e("#upload__button");var r=function(){t.responsive.hasSize("mobile")?d=new h.Croppie(m.get(0),{viewport:{width:"140",height:"140",type:"circle"},boundary:{width:"175",height:"175"},customClass:"",showZoom:!0,mouseWheelZoom:!1,update:function(e){}}):d=new h.Croppie(m.get(0),{viewport:{width:"200",height:"200",type:"circle"},boundary:{width:"250",height:"250"},customClass:"",showZoom:!0,mouseWheelZoom:!1,update:function(e){}}),d.bind({url:n,points:[0,0,0,0]});var r=e("<div>",{id:"upload-picture-cancel",html:t.storage.labels.get("8333")});m.find(".cr-slider-wrap").after(r),r.off().on("click",function(e){e.stopPropagation(),x.destroyCrop()}),l.addClass("active"),l.off().on("click",function(){var e=d.result({type:"canvas",size:"viewport"}).then(function(e){x.uploadPictureProcess(e,100,100)})})};h==null?require(["libs/jquery-plugins/community/croppie"],function(e){h=e,r()}):r()},uploadPictureProcess:function(e,n,r){var i=e.replace(/^data:image\/(png|jpg|gif|jpeg|pjpeg|x-png);base64,/,""),s={imageB64:i,width:n,height:r,x:0,y:0,dropletId:t.storage.context.get("dropletId")};x.uploadPictureRequest(s,e)},uploadPictureRequest:function(s,o){var u=new r.loader,a=i.community.get("UploadPicture");u.append(e("#upload__button").parent(),!0);var f=new i.ajax(a,{success:function(i){if(i.Success==1)x.destroyCrop(),S&&S.slideBack(),x.updateModerateStatus(t.storage.labels.get("5889")),b.pictures.$eurosportPictures.attr("src",n.community.getAvatar()),b.pictures.$eurosportPicture.attr("src",o),b.pictures.$smallPictures.removeClass("selected"),b.pictures.$eurosportPicture.addClass("selected"),n.community.playPictureAnimation(b.pictures.$eurosportPicture,1e3),x.addModeratePictureLS(),c=!1;else{var s=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i.Message});new r.notification({element:s,duration:5e3})}u.detach(!1)},error:function(){var n=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});u.detach(!1),new r.notification({element:n,duration:5e3})}});f.send(s)},updateModerateStatus:function(e){b.pictures.$eurosportPictureModeration.html("("+e+")"),b.pictures.$eurosportPicture.addClass("progress"),b.pictures.$eurosportPictureModeration.removeClass().addClass("progress")},addModeratePictureLS:function(){var e=new Date,n={createdAt:e};n=JSON.stringify(n),t.localStorage.set("communityUserModeratePicture",n)},destroyCrop:function(){e("#upload-picture-cancel").remove(),d.destroy(),m.attr("draggable","true"),m.css("line-height","320px"),l.removeClass("active"),c=!1,m.find(".upload-picture-text").fadeIn()},initPicturesFacebookElements:function(){w.imgContainer=e("#account-facebook-pictures").find(".account-social-pictures")},initPicturesFacebookDisplay:function(t){t.length>0?(helperAccountModule.showRightRightContainer(b,g),b.links.$back.addClass("nodisplay"),b.links.$backPictures.removeClass("nodisplay"),e.each(t,function(t,n){var r="account-social-picture";t%2==1&&(r+=" last");var i=e("<span>",{"class":r,"data-src":n.source,css:{background:"url("+n.source+") no-repeat","background-size":"cover"}});w.imgContainer.append(i)}),e("#account-facebook-pictures").find(".account-social-picture").off().on("click",function(){x.loadPicture(e(this).data("src"),"Facebook"),helperAccountModule.showBackRightContainer(b),b.links.$back.removeClass("nodisplay"),b.links.$backPictures.addClass("nodisplay")})):console.info("no pictures")}},T={initialize:function(e){b=e,x.init()}};return T}),define("modules/community/myprofile/account",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/myprofile/account-pictures","enums"],function(e,t,n,r,i,s,o){"use strict";var u=t.elements.getBody(),a={},f={},l,c,h=null,p={},d={},v={},m={},g={},y={},b={},w={},E={},S=new r.loader,x=new r.loader,T=new r.loader,N=new n.form,C=new n.form,k=new n.form,L=!1,A=!1,O=!1,M=!1,_=!1,D=!1,P=null,H={onLogout:function(){},onDelete:function(){}},B={init:function(){if(!B.initElements())return;n.sliderNavs.reflow(),P=n.sliderNavs.get("slider-nav__account"),B.initEvents()},initElements:function(){return a.container={},a.container.$pseudo=e("#account-pseudo__form"),a.container.$password=e("#account-password__form"),a.container.$delete=e("#account-delete__form"),a.links={},a.links.$deleteContainer=e("#account-delete-link"),a.links.$newsletterStatus=e("#account-newsletter"),a.links.$optinPlayerStatus=e("#account-optin-player"),a.links.$optinEurosportStatus=e("#account-optin-eurosport"),a.links.$picturesContainer=e("#pictures-link"),a.links.$pseudoContainer=e("#account-pseudo").find(".account-field-edit-link"),a.links.$passwordContainer=e("#account-password").find(".account-field-edit-link"),a.links.$logout=e("#account-logout-link"),a.$valuePseudo=e("#account-pseudo").find(".account-field-value"),a.$valuePassword=e("#account-password").find(".account-field-value"),a.$updatedPseudo=e("#account-pseudo-updated"),a.$updatedPassword=e("#account-password-updated"),(a.links.$deleteContainer.length==0||a.links.$logout.length==0||a.container.$pseudo.length==0||a.container.$password==0||a.links.$pseudoContainer.length==0||a.links.$passwordContainer==0||a.links.$picturesContainer==0)&&console.error("My Profile Account : Missing element(s)"),!0},initEvents:function(){a.links.$picturesContainer.on("click",function(){L||(s.initialize(a),L=!0)}),a.links.$pseudoContainer.on("click",function(){A||(B.initPseudoFormElements(),B.initPseudoForm(),B.initPseudoFormEvents(),A=!0)}),a.links.$passwordContainer.on("click",function(){O||(B.initPasswordFormElements(),B.initPasswordForm(),B.initPasswordFormEvents(),O=!0)}),a.links.$newsletterStatus.on("click",function(){B.UpdateUserNewsletterRequest()}),a.links.$optinEurosportStatus.on("click",function(){B.UpdateUserOptinEurosportRequest()}),a.links.$optinPlayerStatus.on("click",function(){B.UpdateUserOptinPlayerRequest()}),a.links.$deleteContainer.on("click",function(){M||(B.initDeleteAccountFormElements(),B.initDeleteAccountForm(),B.initDeleteAccountFormEvents(),M=!0)}),a.links.$logout.on("click",function(){var e=n.modals.get("modal_myprofile"),t=function(){e.removeOnAfterClose(t)};H.onLogout(),e.onAfterClose(t),e.close()})},initPseudoFormElements:function(){g.pseudo=a.container.$pseudo.find(".input-pseudo"),g.submit=a.container.$pseudo.find(".submit-button"),g.submitError=g.submit.parent().find(".message-error"),g.submitErrorLabel=g.submitError.find(".message"),g.pseudoElements=e(".pseudo-eurosport")},initPseudoForm:function(){var e=[{key:"pseudo",type:"text",element:g.pseudo,checkOptions:["mandatory",["minLength",6],["maxLength",20],"pseudo","isPseudoExists"]}];N.add(e)},initPseudoFormEvents:function(){g.submit.off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),B.updatePseudoProcess()})},updatePseudoProcess:function(){N.hideSubmitError(g.submit);if(!N.isValidForSend())return!1;var e=N.getValues(),n={pseudo:e.pseudo,dropletId:t.storage.context.get("dropletId")};S.append(g.submit.parent(),!0),B.updatePseudoRequest(n)},updatePseudoRequest:function(e){var n=i.community.get("UpdatePseudo"),r=new i.ajax(n,{success:function(t){S.detach(!1),t.Success==1?(P&&P.slideBack(),B.resetFormInstances(),g.pseudoElements.html(e.pseudo),a.$updatedPseudo.show(),B.showEditedMessage(a.$updatedPseudo,400)):N.showSubmitError(g.submit,t.Message)},error:function(){S.detach(!1),N.showSubmitError(g.submit,t.storage.labels.get("3414"))}});r.send(e)},initPasswordFormElements:function(){y.oldPassword=a.container.$password.find(".input-old-password"),y.password=a.container.$password.find(".input-password"),y.submit=a.container.$password.find(".submit-button"),y.submitError=y.submit.parent().find(".message-error"),y.submitErrorLabel=y.submitError.find(".message")},initPasswordForm:function(){var e=[{key:"oldPassword",type:"password",element:y.oldPassword,checkOptions:["mandatory"]},{key:"password",type:"password",element:y.password,checkOptions:["mandatory",["minLength",8],["maxLength",20],"noIllegalChars"]}];C.add(e)},initPasswordFormEvents:function(){y.submit.off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),B.updatePasswordProcess()})},updatePasswordProcess:function(){C.hideSubmitError(y.submit);if(!C.isValidForSend())return!1;var e=C.getValues(),n={oldPassword:e.oldPassword,password:e.password,dropletId:t.storage.context.get("dropletId")};x.append(y.submit.parent(),!0),B.updatePasswordRequest(n)},updatePasswordRequest:function(e){var n=i.community.get("UpdatePasswordProfile"),r=new i.ajax(n,{success:function(e){x.detach(!1),e.Success==1?(P&&P.slideBack(),B.resetFormInstances(),a.$updatedPassword.show(),B.showEditedMessage(a.$updatedPassword,400)):C.showSubmitError(y.submit,e.Message)},error:function(){x.detach(!1),C.showSubmitError(y.submit,t.storage.labels.get("3414"))}});r.send(e)},initDeleteAccountFormElements:function(){b.password=a.container.$delete.find(".input-password"),b.submit=a.container.$delete.find(".submit-button"),b.submitError=b.submit.parent().find(".message-error"),b.submitErrorLabel=b.submitError.find(".message")},initDeleteAccountForm:function(){var e=[{key:"password",type:"password",element:b.password,checkOptions:["mandatory"]}];k.add(e)},initDeleteAccountFormEvents:function(){b.submit.off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),B.deleteAccountProcess()})},UpdateUserNewsletterRequest:function(){var n=i.community.get("UpdateUserNewsletter"),s=a.links.$newsletterStatus.data("is-activated"),u=s?!1:!0,f={isActivated:u,dropletId:t.storage.context.get("dropletId"),siteId:t.storage.context.get("siteid")},l=new i.ajax(n,{success:function(n){if(n.Success==1){if(u==1){a.links.$newsletterStatus.addClass("selected");var i=t.storage.labels.get("8409");a.links.$newsletterStatus.data("is-activated",!0);var s=5e3}else{a.links.$newsletterStatus.removeClass("selected");var i=t.storage.labels.get("8410");t.storage.context.get("dropletBrandId")==o.dropletBrand.Rugbyrama&&(i=t.storage.labels.get("8807")),a.links.$newsletterStatus.data("is-activated",!1);var s=1e4}var f=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i});new r.notification({element:f,duration:s})}else{var f=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:f,duration:5e3})}},error:function(){var n=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:n,duration:5e3})}});l.send(f)},UpdateUserOptinEurosportRequest:function(){var n=i.community.get("UpdateUserOptinEurosport"),s=a.links.$optinEurosportStatus.data("is-activated"),u=s?!1:!0,f={isActivated:u,dropletId:t.storage.context.get("dropletId")},l=new i.ajax(n,{success:function(n){if(n.Success==1){if(u==1){a.links.$optinEurosportStatus.addClass("selected");var i=t.storage.labels.get("8918").replace("{0}","Eurosport");t.storage.context.get("dropletBrandId")==o.dropletBrand.Rugbyrama&&(i=t.storage.labels.get("8918").replace("{0}","Rugbyrama")),a.links.$optinEurosportStatus.data("is-activated",!0);var s=5e3}else{a.links.$optinEurosportStatus.removeClass("selected");var i=t.storage.labels.get("8919").replace("{0}","Eurosport");t.storage.context.get("dropletBrandId")==o.dropletBrand.Rugbyrama&&(i=t.storage.labels.get("8919").replace("{0}","Rugbyrama")),a.links.$optinEurosportStatus.data("is-activated",!1);var s=1e4}var f=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i});new r.notification({element:f,duration:s})}else{var f=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:f,duration:5e3})}},error:function(){var n=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:n,duration:5e3})}});l.send(f)},UpdateUserOptinPlayerRequest:function(){var n=i.community.get("UpdateUserOptinPlayer"),s=a.links.$optinPlayerStatus.data("is-activated"),o=s?!1:!0,u={isActivated:o,dropletId:t.storage.context.get("dropletId"),geoloc:"DE"},f=new i.ajax(n,{success:function(n){if(n.Success==1){if(o==1){a.links.$optinPlayerStatus.addClass("selected");var i=t.storage.labels.get("8899");a.links.$optinPlayerStatus.data("is-activated",!0);var s=5e3}else{a.links.$optinPlayerStatus.removeClass("selected");var i=t.storage.labels.get("8898");a.links.$optinPlayerStatus.data("is-activated",!1);var s=1e4}var u=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i});new r.notification({element:u,duration:s})}else{var u=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:u,duration:5e3})}},error:function(){var n=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:n,duration:5e3})}});f.send(u)},deleteAccountProcess:function(){k.hideSubmitError(b.submit);if(!k.isValidForSend())return!1;var e=k.getValues(),n={password:e.password,dropletId:t.storage.context.get("dropletId")};T.append(b.submit.parent(),!0),B.deleteAccountRequest(n)},deleteAccountRequest:function(s){var o=i.community.get("DeleteAccount"),u=new i.ajax(o,{success:function(t){T.detach(!1);if(t.Success==1){var i=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.Message}),s=n.modals.get("modal_myprofile"),o=function(){new r.notification({element:i,duration:5e3}),s.removeOnAfterClose(o)};H.onDelete(),s.onAfterClose(o()),s.close()}else k.showSubmitError(b.submit,t.Message)},error:function(){T.detach(!1),k.showSubmitError(b.submit,t.storage.labels.get("3414"))}});u.send(s)},showEditedMessage:function(e,t){typeof t=="undefined"&&(t=0),n.community.playPictureAnimation(e,t)},resetFormInstances:function(){N.reset(),C.reset(),k.reset()}},j={initialize:function(e){B.init(),H=n.mergeObject.mergeObject(H,e,!0)}};return j}),define("modules/community/myprofile/my-profile",["jquery-full","base/base","helpers/helpers","ws/ws","modules/community/login","modules/community/header"],function(e,t,n,r,i,s){"use strict";var o=t.elements.getBody(),u={},a={},f={},l={},c={},h={},p=!1,d=null,v=null,m={onLogout:function(){}},g={init:function(){if(t.storage.community.get("isCommunityActivated")=="True"){if(!g.initElements())return;n.community.isConnected()&&g.updateContentsTop(),g.initEvents()}},initElements:function(){return u=e("#modal_myprofile"),a=e("#myprofile"),f=e("#header__picture-pseudo"),c=e("#header__picture"),l=e("#header__pseudo"),h=e("#header__navigation-title"),u.length==0||a.length==0?(console.error("My Profile : Missing element(s)"),!1):!0},initEvents:function(){g.initAccountEvents(),t.storage.community.get("isPersonalizationActivated")=="True"&&g.initFavoritesEvents(),n.community.onLoginSuccess(function(){g.updateContentsTop()});var e=n.modals.get("modal_myprofile");e&&e.onAfterClose(function(){v&&v.slideToFirst(),d&&d.slideToFirst()})},initAccountEvents:function(){var t=n.navTabs,r=t.getElements("navtab_myprofile-account")[0];r.onActivate(function(){v&&v.slideToFirst()}),r.ajax.onAfterAjaxRequest(function(){require(["modules/community/myprofile/account"],function(e){e.initialize({onLogout:function(){var e=n.community.getSocialType();i.logout(e),s.showNotConnectedHeader()},onDelete:function(){var e=n.community.getSocialType();i.deleteAccount(e),s.showNotConnectedHeader()}}),d=n.sliderNavs.get("slider-nav__account"),g.initSlideEvents(d)})}),n.community.onLogoutSuccess(function(){n.navTabs.resetAjax(e("#navtab_myprofile-account"))})},initFavoritesEvents:function(){var t=n.navTabs,r=t.getElements("navtab_myprofile-favorites")[0];r.onActivate(function(){d&&d.slideToFirst()}),r.ajax.onAfterAjaxRequest(function(){require(["modules/community/myprofile/favorites"],function(t){t.initialize(),v=n.sliderNavs.get("slider-nav__favorites"),g.initSlideEvents(v);var r=e("#myprofile__body");n.lazyload.reflowIn(r),n.lazyload.addScrollItem(r.find(".slider-nav-item__wrapper"))})}),n.community.onLogoutSuccess(function(){n.navTabs.resetAjax(e("#navtab_myprofile-favorites"))})},initSlideEvents:function(e){e&&e.onSlide(function(){var t=e.getCurrentSlide();t.data("slide-title")&&t.data("slide-title")!=""?(h.html(t.data("slide-title")),f.addClass("hide"),h.removeClass("hide")):(h.addClass("hide"),f.removeClass("hide"))})},updateContentsTop:function(){l.text(n.community.getPseudo()),c.attr("src",n.community.getAvatar())}},y={initialize:function(){g.init()}};return y}),define("modules/community/header",["jquery-full","base/base","helpers/helpers"],function(e,t,n){"use strict";var r=t.elements.getDocument(),i=t.elements.getBody(),s=e(".nav--disconnect-mode"),o=e(".nav--connect-mode"),u=i.find(".open-profile"),a=o.find("img"),f=!1,l={onLogout:function(){}},c={init:function(){if(!c.initElements())return;c.initEvents()},initElements:function(){return!0},initEvents:function(){var e=n.modals.get("modal_myprofile");if(e!=null)var r=n.navTabs,i=r.getElements("navtab_myprofile-favorites"),s=r.getElements("navtab_myprofile-account");n.community.isConnected()?c.showConnectedHeader():c.showNotConnectedHeader();var o=function(e){e.initialize()},a=function(){t.storage.community.get("isPersonalizationActivated")=="True"?i[0].activate():s[0].activate(),e.removeOnAfterOpen(a)};u.on("click",function(t){t.preventDefault(),e!=null&&n.community.isConnected()?(c.showConnectedHeader(),e.onAfterOpen(a)):c.showNotConnectedHeader(),f||(require(["modules/community/myprofile/my-profile"],o),f=!0)})},updateHeader:function(){a.attr("src",n.community.getAvatar())},showConnectedHeader:function(){c.updateHeader(),s.removeClass("inlineblock"),o.addClass("inlineblock")},showNotConnectedHeader:function(){a.attr("src",""),o.removeClass("inlineblock"),s.addClass("inlineblock")}},h={initialize:function(e){l=n.mergeObject.mergeObject(l,e,!0),c.init()},showConnectedHeader:function(){c.showConnectedHeader()},showNotConnectedHeader:function(){c.showNotConnectedHeader()}};return h}),define("modules/community/subscription",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws"],function(e,t,n,r,i){"use strict";var s=t.elements.getBody(),o=s.find("#subscription__form"),u=new n.form,a=new r.loader,f,l={},c={},h={},p={},d={},v={},m={},g={},y=!1,b=!1,w={init:function(){if(!w.initElements())return;w.initForm(),w.initEvents()},initElements:function(){return h=e("#subscription-form__content"),l.pseudo=o.find(".input-pseudo"),l.email=o.find(".input-email"),l.password=o.find(".input-password"),l.submit=o.find(".submit-button"),l.submitError=l.submit.parent().find(".message-error"),l.submitErrorLabel=l.submitError.find(".message"),l.pseudo.length==0||l.email.length==0||l.password.length==0||l.submit.length==0||l.submitError.length==0||l.submitErrorLabel.length==0?(console.error("Subscription : Missing element(s) in form",l),!1):!0},initForm:function(){var e=[{key:"pseudo",type:"text",element:l.pseudo,checkOptions:["mandatory",["minLength",6],["maxLength",20],"pseudo","isPseudoExists"]},{key:"email",type:"text",element:l.email,checkOptions:["mandatory",["maxLength",300],"email","isEmailExists","noIllegalChars"]},{key:"password",type:"password",element:l.password,checkOptions:["mandatory",["minLength",8],["maxLength",20],"noIllegalChars"]}];u.add(e)},initEvents:function(){l.submit.off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),y=!1,w.subscribeProcess()})},subscribeProcess:function(){u.hideSubmitError(l.submit);if(!u.isValidForSend())return!1;var e=u.getValues();f=e.email;var n={pseudo:e.pseudo,email:e.email,password:e.password,dropletId:t.storage.context.get("dropletId")};a.append(l.submit.parent(),!0),w.subscribeRequest(n)},subscribeRequest:function(e){var r=i.community.get("CreateEurosportAccount"),s=new i.ajax(r,{success:function(t){t.Success==1?(w.addSubscriptionLS(e),n.community.subscribeSuccess(),w.initSubscriptionSuccessPopup()):(a.detach(!1),u.showSubmitError(l.submit,t.Message))},error:function(){a.detach(!1),u.showSubmitError(l.submit,t.storage.labels.get("3414"))}});s.send(e)},addSubscriptionLS:function(e){var n=new Date,r={pseudo:e.pseudo,email:e.email,createdAt:n,viewCount:0};r=JSON.stringify(r),t.localStorage.set("communityUserSubscription",r)},initSubscriptionSuccessPopup:function(){w.initSubscriptionSuccessElementsPopup(),m.text(f),w.detectEmailDomainRequest()},initSubscriptionSuccessElementsPopup:function(){c=e("#subscription-success__content"),p=e("#subscription-success__button"),d=e(".subscription-success__button-social"),v=e(".subscription-success__send-email"),m=e("#subscription-success__email")},showSubscriptionSuccessPopup:function(){var e=s.find(".community-content");c.scrollTop(0);var t=e.filter(".open");t.hasClass("community__content__bottom")&&c.hasClass("community__content__bottom")&&t.removeClass("community__content__bottom").addClass("community__content__top"),e.removeClass("open"),c.addClass("open"),b||w.initSubscriptionSuccessEventsPopup(t)},initSubscriptionSuccessEventsPopup:function(e){p.off().on("click",function(){var t=n.modals.get("modal_community"),r=function(){e.removeClass("community__content__top").addClass("community__content__bottom"),c.removeClass("open"),t.removeOnAfterClose(r)};t.onAfterClose(r),t.close()})},buildSubscriptionSuccessNotif:function(n){f=n.email,g=e("<div>");var r=e("<div>",{"class":"notification__body"}),i=e("<div>",{"class":"subscription-success__body",html:t.storage.labels.get("8345").replace("{0}",n.pseudo).replace("{1}",n.email)+"&nbsp;"}),s=e("<button>",{"class":"subscription-success__button-social button rounded nodisplay"}),o=e("<span>",{"class":"button-label",html:t.storage.labels.get("8313").replace("{0}","Outlook")}),u=e("<div>",{"class":"subscription-success__send-email"}),a=e("<div>",{"class":"subscription-success__send-email-label",text:t.storage.labels.get("6563")}),l=e("<div>",{"class":"subscription-success__send-email-error",text:""});s.append(o),u.append(a),r.append(i).append(s).append(u).append(l),g.append(r),y=!0,w.initSubscriptionSuccessElementsNotif(),w.detectEmailDomainRequest()},initSubscriptionSuccessElementsNotif:function(){d=g.find(".subscription-success__button-social"),v=g.find(".subscription-success__send-email")},showSubscriptionSuccessNotif:function(e){new r.notification({element:g,duration:2e5}),y=!1},detectEmailDomainRequest:function(){var n=t.storage.community.get("emailDetectPageLink");e.ajax({url:n,context:document.body}).done(function(n){e(n).find("emaildomain").each(function(){if(f.indexOf("@"+e(this).find("value").text())!=-1){var n=e(this).find("label").text(),r=e(this).find("color").text(),i=e(this).find("url").text();d.css({"background-color":"#FFFFFF",color:r,border:"1px solid "+r}),d.find(".button-label").text(t.storage.labels.get("8313").replace("{0}",n)),d.removeClass("nodisplay"),y||p.addClass("nodisplay"),d.on("click",function(){window.open(i)}),b=!0}}),y?(w.showSubscriptionSuccessNotif(),y=!1):(a.detach(!1),w.showSubscriptionSuccessPopup(),u.reset()),w.addSendActivationEmailEvents(v)})},addSendActivationEmailEvents:function(e){e.off().on("click",function(){if(!!f){var e={email:f,dropletId:t.storage.context.get("dropletId")};w.sendActivationEmailRequest(e)}})},sendActivationEmailRequest:function(n){var s=new r.loader,o=i.community.get("SendActivationAccountEmail"),u=e(".subscription-success__send-email"),a=e(".subscription-success__send-email-error");s.append(u,!0);var f=new i.ajax(o,{type:"get",success:function(e){s.detach(!1);var t=parseInt(e.Code);e.Success==1?(u.addClass("nodisplay"),a.text(e.Message),a.addClass("success").removeClass("nodisplay")):(a.text(e.Message),a.removeClass("nodisplay"))},error:function(){s.detach(!1),a.text(t.storage.labels.get("3414")),a.removeClass("nodisplay")}});f.send(n)}},E={initialize:function(){w.init()},addSubscriptionLS:function(e){w.addSubscriptionLS(e)},sendSubscriptionNotif:function(e){w.buildSubscriptionSuccessNotif(e)},initSubscriptionSuccessPopup:function(e){y=!1,f=e,w.initSubscriptionSuccessPopup()}};return E}),define("modules/community/forgot-password-lib",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/forgot-password-lib"],function(e,t,n,r,i,s){"use strict";var o={forgotPasswordRequest:function(e,t,n){var r=i.community.get("SendUpdatePasswordEmail"),s=new i.ajax(r,{type:"get",success:function(e){t(e)},error:function(){n(response)}});s.send(e)}},u={forgotPasswordRequest:function(e,t,n){o.forgotPasswordRequest(e,t,n)}};return u}),define("modules/community/forgot-password",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/forgot-password-lib"],function(e,t,n,r,i,s){"use strict";var o=t.elements.getBody(),u=o.find("#forgot-password__form"),a=new n.form,f=new r.loader,l={},c={init:function(){if(!c.initElements())return;c.initForm(),c.initEvents()},initElements:function(){return l.email=u.find(".input-email"),l.submit=u.find(".submit-button"),l.submitError=l.submit.parent().find(".message-error"),l.submitErrorLabel=l.submitError.find(".message"),l.email.length==0||l.submit.length==0||l.submitError.length==0||l.submitErrorLabel.length==0?(console.error("Forgot Password : Missing element(s) in form",l),!1):!0},initForm:function(){var e=[{key:"email",type:"text",element:l.email,checkOptions:["mandatory","email"]}];a.add(e)},initEvents:function(){l.submit.on("click",function(e){e.preventDefault(),e.stopPropagation(),c.forgotPasswordProcess()})},forgotPasswordProcess:function(){a.hideSubmitError(l.submit);if(!a.isValidForSend())return!1;var e=a.getValues(),n={email:e.email,dropletId:t.storage.context.get("dropletId")};f.append(l.submit.parent(),!0),c.forgotPasswordRequest(n)},forgotPasswordRequest:function(i){var o=function(i){f.detach(!1);if(i.Success==1){var s=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("8353")}),o=n.modals.get("modal_community"),u=function(){a.reset(),new r.notification({element:s,duration:5e3}),o.removeOnAfterClose(u)};o.onAfterClose(u),o.close()}else a.showSubmitError(l.submit,i.Message)},u=function(e){f.detach(!1),a.showSubmitError(l.submit,t.storage.labels.get("3414"))};s.forgotPasswordRequest(i,o,u)}},h={initialize:function(e){c.init()}};return h}),define("modules/community/ask-social-email",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws"],function(e,t,n,r,i){"use strict";var s=t.elements.getBody(),o=s.find("#ask-social-email__form"),u=new n.form,a=new r.loader,f={},l=e("#ask-social-email__content .community-subtitle"),c={},h="",p={onSocialEmailExists:function(){},onSocialEmailNotActivated:function(e){}},d={init:function(){if(!d.initElements())return;l.text(h),d.initForm(),d.initEvents()},initElements:function(){return f.email=o.find(".input-email"),f.submit=o.find(".submit-button"),f.submitError=f.submit.parent().find(".message-error"),f.submitErrorLabel=f.submitError.find(".message"),f.email.length==0||f.submit.length==0||f.submitError.length==0||f.submitErrorLabel.length==0||l.length==0?(console.error("Ask Email : Missing element(s) in form",f,l),!1):!0},initForm:function(){var e=[{key:"email",type:"text",element:f.email,checkOptions:["mandatory","email"]}];u.add(e)},initEvents:function(){f.submit.on("click",function(e){e.preventDefault(),e.stopPropagation(),d.askEmailProcess()})},askEmailProcess:function(){u.hideSubmitError(f.submit);if(!u.isValidForSend())return!1;var e=u.getValues();c.email=e.email;var n={socialType:c.socialType,email:c.email,pseudo:c.pseudo||"",lastname:c.last_name||"",firstname:c.first_name||"",birthdate:c.birthday||"",sex:c.gender=="male"?1:c.gender=="female"?2:-1,socialUserId:c.id||"",socialUserAvatar:c.avatar||"",accessToken:c.accessToken||"",dropletId:t.storage.context.get("dropletId")};a.append(f.submit.parent(),!0),d.submitSocialEmailRequest(n)},submitSocialEmailRequest:function(s){var o=i.community.get("SubmitSocialEmail"),l=new i.ajax(o,{success:function(t){var i=t.Message;a.detach(!1);if(t.Success==1){var s=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i}),o=n.modals.get("modal_community"),l=function(){u.reset(),new r.notification({element:s,duration:1e4}),o.removeOnAfterClose(l)};o.onAfterClose(l),o.close()}else switch(t.Code){case 11:p.onSocialEmailExists(c,t.Message);break;case 20:p.onSocialEmailNotActivated(c);break;default:u.showSubmitError(f.submit,t.Message)}},error:function(){a.detach(!1),u.showSubmitError(f.submit,t.storage.labels.get("3414"))}});l.send(s)}},v={initialize:function(e,t,r){p=n.mergeObject.mergeObject(p,r,!0),c=e,h=t,d.init()}};return v}),define("modules/community/ask-social-password",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/forgot-password-lib"],function(e,t,n,r,i,s){"use strict";var o=t.elements.getBody(),u=o.find("#ask-social-password__form"),a=new n.form,f=new r.loader,l={},c=e("#ask-social-password__content .community-subtitle"),h=u.find(".ask-password-link"),p={},d="",v={onLoginSuccess:function(){}},m={init:function(){if(!m.initElements())return;c.text(d),m.initForm(),m.initEvents()},initElements:function(){return l.password=u.find(".input-password"),l.submit=u.find(".submit-button"),l.submitError=l.submit.parent().find(".message-error"),l.submitErrorLabel=l.submitError.find(".message"),l.password.length==0||l.submit.length==0||l.submitError.length==0||l.submitErrorLabel.length==0||c.length==0?(console.error("Ask Password : Missing element(s) in form",l,c),!1):!0},initForm:function(){var e=[{key:"password",type:"password",element:l.password,checkOptions:["mandatory"]}];a.add(e)},initEvents:function(){l.submit.on("click",function(e){e.preventDefault(),e.stopPropagation(),m.askPasswordProcess()}),h.on("click",function(n){n.preventDefault();var r=e("#ask-social-email__email").val(),i={email:r,dropletId:t.storage.context.get("dropletId")};m.forgotPasswordRequest(i)})},askPasswordProcess:function(){a.hideSubmitError(l.submit);if(!a.isValidForSend())return!1;var e=a.getValues();p.password=e.password;var n={socialType:p.socialType,password:p.password,email:p.email,pseudo:p.pseudo||"",lastname:p.last_name||"",firstname:p.first_name||"",birthdate:p.birthday||"",sex:p.gender=="male"?1:p.gender=="female"?2:-1,socialUserId:p.id||"",socialUserAvatar:p.avatar||"",accessToken:p.accessToken||"",dropletId:t.storage.context.get("dropletId")};f.append(l.submit.parent(),!0),m.loginSocialWithEurosportPassword(n)},loginSocialWithEurosportPassword:function(s){var o=i.community.get("LoginSocialWithEurosportPassword"),u=new i.ajax(o,{success:function(t){var i=t.Message;f.detach(!1);if(t.Success==1){var s=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i}),o=n.modals.get("modal_community"),u=function(){a.reset(),v.onLoginSuccess(),new r.notification({element:s,duration:5e3}),o.removeOnAfterClose(u)};o.onAfterClose(u),o.close()}else a.showSubmitError(l.submit,i)},error:function(){f.detach(!1),a.showSubmitError(l.submit,t.storage.labels.get("3414"))}});u.send(s)},forgotPasswordRequest:function(n){var i=function(t){var n=t.Message;f.detach(!1);if(t.Success==1){var i=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:n});new r.notification({element:i,duration:5e3})}else a.showSubmitError(l.submit,n)},o=function(e){f.detach(!1),a.showSubmitError(l.submit,t.storage.labels.get("3414"))};f.append(l.submit.parent(),!0),s.forgotPasswordRequest(n,i,o)}},g={initialize:function(e,t,r){p=e,d=t,v=n.mergeObject.mergeObject(v,r,!0),m.init()}};return g}),define("modules/community/personalization-nav",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/login","enums"],function($,baseBase,helperHelper,objectObject,wsWs,loginCommunityModule,enums){"use strict";var $favoritesNavTab=null,$favoritesList=null,$favoritesNavEditButton=null,$favoritesEmpty=null,$favoritesLoader=null,$loader=new objectObject.loader,_favoritesSections={},_isMenuLoaded=!1,prv={init:function(){if(baseBase.storage.context.get("dropletBrandId")==enums.dropletBrand.Rugbyrama)return;if(!prv.initElements())return;prv.initEvents(),helperHelper.community.isConnected()&&($favoritesNavTab.removeClass("hide"),$favoritesNavTab.one("click",function(){$loader.append($favoritesLoader,!0),helperHelper.bookmarks.get()}))},initElements:function(){return $favoritesNavTab=$("#favorites-nav-tab"),$favoritesList=$("#favorites-list").find(".modalnav__rightcol-list"),$favoritesNavEditButton=$(".favorites-nav-edit-button"),$favoritesEmpty=$("#container-favorites-empty"),$favoritesLoader=$("#container-favorites-loader"),$favoritesNavTab.length==0||$favoritesList.length==0||$favoritesNavEditButton.length==0||$favoritesEmpty.length==0||$favoritesLoader.length==0?(console.info("Nav Favorites : Missing element(s)"),!1):!0},initEvents:function(){helperHelper.community.onLoginSuccess(function(){$favoritesNavTab.removeClass("hide"),prv.updateFavoritesNav()}),helperHelper.community.onLogoutSuccess(function(){$("#modal_navallsport").find("[data-tab='sports-list']").trigger("click"),$favoritesNavTab.addClass("hide"),prv.destroyFavoritesList(),_isMenuLoaded=!1}),helperHelper.bookmarks.onGetSuccess(function(){_isMenuLoaded||($favoritesLoader.removeClass("hide"),$favoritesNavTab.removeClass("hide"),prv.updateFavoritesNav(),_isMenuLoaded=!0)}),helperHelper.bookmarks.onAddSuccess(function(e){prv.updateFavoritesNav("follow",e)}),helperHelper.bookmarks.onRemoveSuccess(function(e){prv.updateFavoritesNav("unfollow",e)})},updateFavoritesNav:function(mode,entity){if(helperHelper.bookmarks.countItemsLocalStorage()==0)prv.showFavoritesEmpty(),mode=="unfollow"&&(_favoritesSections={},prv.destroyFavoritesList());else{var entities={};$favoritesEmpty.addClass("hide");switch(mode){case"follow":entities[entity.typenu]=entity.entity,_favoritesSections.hasOwnProperty(entity.typenu)||(_favoritesSections[entity.typenu]=[],prv.buildFavoritesTitle(entity.typenu)),_favoritesSections[entity.typenu].push({id:entity.entity}),prv.buildFavoritesList(entity.typenu,entity.entity,entity.name,entity.link);var sectionsLength=Object.keys(_favoritesSections).length;$favoritesList.find(".list_container-favorites").removeClass("last"),$favoritesList.find(".list_container-favorites:not(.hide):last").addClass("last"),prv.showFavoritesList(sectionsLength);break;case"unfollow":$favoritesList.find(".item_"+entity.typenu+"_"+entity.entity).remove(),_favoritesSections[entity.typenu]=_favoritesSections[entity.typenu].filter(function(e){return e.id!=entity.entity});if(_favoritesSections[entity.typenu].length==0){$favoritesList.find(".favorites_typeNu_"+entity.typenu).addClass("hide");var sectionsLength=eval(Object.keys(_favoritesSections).length-1);$favoritesList.find(".list_container-favorites").removeClass("last"),$favoritesList.find(".list_container-favorites:not(.hide):last").addClass("last"),prv.showFavoritesList(sectionsLength),delete _favoritesSections[entity.typenu]}break;default:prv.destroyFavoritesList(),_favoritesSections={},helperHelper.bookmarks.getLocalStorage()!=null&&prv.getBookmarksInfos()}}},getBookmarksInfos:function(){var e=wsWs.community.get("GetBookmarksInfos"),t={bookmarksList:JSON.stringify(helperHelper.bookmarks.getLocalStorage()),dropletId:baseBase.storage.context.get("dropletId")},n=new wsWs.ajax(e,{success:function(e){var t=JSON.parse(e.Data);$.each(t,function(e,t){_favoritesSections.hasOwnProperty(e)||(_favoritesSections[e]=[],prv.buildFavoritesTitle(e)),$.each(t,function(t,n){_favoritesSections[e].push({id:n.Id}),prv.buildFavoritesList(e,n.Id,n.Name,n.Url)})});var n=Object.keys(_favoritesSections).length;$favoritesList.find(".list_container-favorites:not(.hide):last").addClass("last"),prv.showFavoritesList(n)}});n.send(t)},buildFavoritesTitle:function(e){$favoritesList.find(".favorites_typeNu_"+e).removeClass("hide")},buildFavoritesList:function(e,t,n,r){$favoritesList.find(".favorites_typeNu_"+e+" ul").append('<li class="modalnav__rightcol-item item_'+e+"_"+t+'"><a href="'+r+'">'+n+"</a></li></ul>")},destroyFavoritesList:function(){$favoritesList.find(".list_container-favorites").removeClass("last").addClass("hide"),$favoritesList.addClass("hide"),$favoritesList.find(".list_container-favorites li").remove(),$favoritesNavEditButton.addClass("hide")},showFavoritesEmpty:function(){$favoritesLoader.addClass("hide"),$favoritesList.addClass("hide"),$favoritesNavEditButton.addClass("hide"),$favoritesEmpty.removeClass("hide")},showFavoritesList:function(e){$favoritesEmpty.addClass("hide"),$favoritesLoader.addClass("hide"),$favoritesNavEditButton.removeClass("hide"),$favoritesList.removeClass().addClass("modalnav__rightcol-list list_containers-"+e)}};baseBase.storage.community.get("isPersonalizationActivated")=="True"&&baseBase.storage.community.get("isCommunityActivated")=="True"&&prv.init()}),define("modules/community/personalization-favourites",["jquery-full","base/base","helpers/helpers"],function(e,t,n){var r={favsData:[],options:{dataAttr:"data-fav-entity",className:"star-item--favourite",zone:".results_teamsports_v8_5,                    .qualification_phase_teamsports_v8_5,                    .final_phase_teamsports_v8_5,                    .brackets_v8_5,                    .livebox_v8_5,                    .group_phase_teamsports_v8_5,                    .standing_v8_5,                    #modal_teamlist",persoStorageName:"personalization"},init:function(){if(this.options.zone===null){console.warn("data-personalization: options.zone is not defined");return}this.readPersoStorage(),this.renderAllFavourites(),this.registerCommunityCallbacks(),this.subscribeToLiveBoxUpdate(),this.subscribeToNavTabAjax(),this.subscribeToAjaxDropdown()},readPersoStorage:function(){var e=t.localStorage.get(this.options.persoStorageName);try{this.favsData=e||[]}catch(n){console.error("personalization:: unable to parse "+this.options.persoStorageName+" data")}},subscribeToLiveBoxUpdate:function(){e(".livebox_v8_5").length>0&&e.subscribe("ui_redraw.livebox",this.reflow.bind(this))},subscribeToNavTabAjax:function(){e(".group_phase_teamsports_v8_5, .standing_v8_5").length>0&&e.subscribe("navtab.onAfterAjaxRequest",this.reflow.bind(this))},subscribeToAjaxDropdown:function(){e.subscribe("dropdown-ajax.onAjaxSuccess",this.reflow.bind(this))},registerCommunityCallbacks:function(){var e=this;n.community.onLogoutSuccess(function(){e.favsData=[],e.cleanFavourites()}),n.bookmarks.onGetSuccess(function(){e.readPersoStorage(),e.reflow()}),n.bookmarks.onAddSuccess(function(t){e.updateFavsData("ADD",t),e.renderFavourite("ADD",t)}),n.bookmarks.onRemoveSuccess(function(t){e.updateFavsData("REMOVE",t),e.renderFavourite("REMOVE",t)})},updateFavsData:function(e,t){switch(e){case"ADD":this.favsData.push(t);break;case"REMOVE":this.favsData=this.favsData.filter(function(e){return e.entity!=t.entity||e.typenu!=t.typenu})}},renderAllFavourites:function(){if(this.favsData.length===0)return;var t=this.favsData.map(function(e){var t=e.entity+"_"+e.typenu;return"["+this.options.dataAttr+'="'+t+'"]'}.bind(this));e(this.options.zone).find(t.join(",")).addClass(this.options.className)},renderFavourite:function(t,n){var r=n.entity+"_"+n.typenu,i=e(this.options.zone).find("["+this.options.dataAttr+"="+r+"]");switch(t){case"ADD":i.addClass(this.options.className);break;case"REMOVE":i.removeClass(this.options.className)}},cleanFavourites:function(){e(this.options.zone).find("."+this.options.className).removeClass(this.options.className)},reflow:function(){this.renderAllFavourites()}};return{initialize:function(){r.init()},reflow:function(){r.reflow()}}}),define("modules/community/community",["jquery-full","base/base","helpers/helpers","objects/objects","modules/community/header","modules/community/login","modules/community/subscription","modules/community/forgot-password","modules/community/ask-social-email","modules/community/ask-social-password","modules/community/personalization-profile","ws/ws","modules/community/personalization-nav","modules/community/personalization-favourites","enums"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=t.elements.getWindow(),m=t.elements.getBody(),g=t.elements.getDocument(),y=m.find(".community-content"),b=e("#login__content"),w=e("#subscription__content"),E=e("#forgot-password__content"),S=e("#ask-social-email__content"),x=e("#ask-social-password__content"),T=m.find(".login-link, .community__back-to-login"),N=m.find(".subscription-link"),C=m.find(".forgot-password-link"),k=!1;_isForgotPasswordModuleInitialize=!1,_isAskSocialEmailModuleInitialize=!1,_isAskSocialPasswordModuleInitialize=!1,fnSocialEmailExists=function(e,t){_isAskSocialPasswordModuleInitialize||(f.initialize(e,t,{onLoginSuccess:function(){i.showConnectedHeader()}}),_isAskSocialPasswordModuleInitialize=!0),L.showModalContent(x)},fnSocialEmailMissing=function(e,t){_isAskSocialEmailModuleInitialize||(a.initialize(e,t,{onSocialEmailExists:fnSocialEmailExists,onSocialEmailNotActivated:function(e){o.addSubscriptionLS(e),o.initSubscriptionSuccessPopup(e.email)}}),_isAskSocialEmailModuleInitialize=!0),L.showModalContent(S)},_loginOptions={onSocialEmailMissing:fnSocialEmailMissing};var L={init:function(){t.storage.community.get("isCommunityActivated")=="True"&&(L.initEvents(),L.initParamsUrl(),i.initialize({onLogout:function(){var e=n.community.getSocialType();s.logout(e),i.showNotConnectedHeader()}}),s.initializeOnLoad(_loginOptions),n.community.onLoginSuccess(function(){i.showConnectedHeader()}),t.storage.community.get("isPersonalizationActivated")=="True"&&L.initPersonalization()),L.initShares(),L.initLocalStorages()},initEvents:function(){N.on("click",function(e){e.preventDefault(),k||(o.initialize(),k=!0),L.showModalContent(w)}),C.on("click",function(e){e.preventDefault(),_isForgotPasswordModuleInitialize||(u.initialize(),_isForgotPasswordModuleInitialize=!0),L.showModalContent(E)}),T.on("click",function(e){e.preventDefault(),L.showModalContent(b)});var r=n.modals.get("modal_community"),i=n.modals.get("modal_myprofile");r&&(r.onOpen(function(){s.initializeOnOpenPopup(_loginOptions),n.community.hideWrapperMobile()}),r.onAfterClose(function(){L.showModalContent(b),n.community.showWrapperMobile()})),i&&(i.onBeforeOpen(function(){s.initializeOnOpenPopup(_loginOptions)}),i.onOpen(function(){n.community.hideWrapperMobile()}),i.onAfterClose(function(){n.community.showWrapperMobile()})),m.hasClass("webview")||t.localStorage.get("CheckCookieNotice")||g.one("scroll",function(){var n=L.buildMentionsNotification();m.append(n),n.removeClass("fadeOutDown").addClass(" animated fadeInUp"),e("#notification__cookie-button").on("mousedown",function(e){e.stopPropagation(),n.removeClass("fadeInUp").addClass("animated fadeOutDown"),t.localStorage.set("CheckCookieNotice",!0),setTimeout(function(){n.remove()},1e3)})})},initParamsUrl:function(){var r=e.parseParams(window.location.search);if(!n.community.isCommunityPage()&&!!r.activationhash){var i=g.title,s=window.location.href.split("?")[0];history.pushState(null,i,s);var o={socialType:r.socialType||"None",activationHash:r.activationhash,dropletId:t.storage.context.get("dropletId")};t.localStorage.remove("communityUserSubscription"),L.activateAccountRequest(o)}},initLocalStorages:function(){L.checkActionLS(),L.checkSubscriptionLS(),n.community.isConnected()&&L.checkModeratePictureLS()},initPersonalization:function(){p.initialize()},initShares:function(){var e=m.find(".share-button");e.length!=0&&n.share.initialize(e)},showModalContent:function(e){e.scrollTop(0);var t=y.filter(".open");t.hasClass("community__content__bottom")&&e.hasClass("community__content__bottom")&&t.removeClass("community__content__bottom").addClass("community__content__top"),y.removeClass("open"),L.focusFirstElemForm(e),e.addClass("open")},focusFirstElemForm:function(e){},buildMentionsNotification:function(){var n=e("<div>",{id:"notification__cookie"}),r=e("<div>",{"class":"notification__content-cookie"}),i=e("<div>",{"class":"notification__text",html:t.storage.labels.get("7489")+" "}),s=e("<div>",{"class":"notification__button-container"}),o=e("<div>",{id:"notification__cookie-button","data-sln":"notification__cookie-button","class":"notification__button",html:t.storage.labels.get("8304")}),u=t.storage.community.get("cookiePolicyLink"),a=e("<a>",{html:t.storage.labels.get("7548"),href:u,target:"_blank"});return i.append(a),s.append(o),r.append(i).append(s),n.append(r),n},checkActionLS:function(){if(t.localStorage.get("action")){var n="";switch(t.localStorage.get("action")){case"deleteUser":n=t.storage.labels.get("6745");break;case"logout":n=t.storage.labels.get("6741");break;case"revoke":n=t.storage.labels.get("6839");break;case"resetPassword":n=t.storage.labels.get("7380");break;case"expiredLink":n=t.storage.labels.get("8370");break;case"unsubscribe":n=t.storage.labels.get("unsubscribe-label"),t.localStorage.remove("unsubscribe-label");break;case"unsubscribeReason":n=t.storage.labels.get("7138");break;case"contactUs":n=t.storage.labels.get("7085")}if(n!=""){var i=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:n});new r.notification({element:i,duration:2e4}),t.localStorage.remove("action")}}},checkSubscriptionLS:function(){var e=t.localStorage.get("communityUserSubscription");if(e){var n=new Date,r=e.createdAt,i=e.viewCount;if(i<7){if(r){var s=t.date.getDateDiff(new Date(r),new Date,"days");if(s>=1||i==0){var u=o.sendSubscriptionNotif(e),a={pseudo:e.pseudo,email:e.email,createdAt:n,viewCount:i+1};a=JSON.stringify(a),t.localStorage.set("communityUserSubscription",a)}}}else t.localStorage.remove("communityUserSubscription")}},checkModeratePictureLS:function(){var e=t.localStorage.get("communityUserModeratePicture");if(e){var n=e.createdAt;if(n){var r=t.date.getDateDiff(new Date(n),new Date,"hours");r>=5&&L.getAvatarStatusRequest()}else t.localStorage.remove("communityUserModeratePicture")}},forgotPasswordRequest:function(e,t){var n=c.community.get("SendUpdatePasswordEmail"),r=new c.ajax(n,{type:"get",success:function(e){var n=e.Message;t.forgotPasswordSuccess()},error:function(){t.forgotPasswordError()}});r.send(e)},activateAccountRequest:function(n){var i=c.community.get("ActivateAccount"),o=new c.ajax(i,{success:function(e){var n=parseInt(e.Code);e.Success==1&&s.loginSuccess(t.storage.labels.get("6565"))},error:function(){var n=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new r.notification({element:n,duration:5e3})}});o.send(n)},getAvatarStatusRequest:function(){var i=c.community.get("GetUserAvatarStatus"),s={dropletId:t.storage.context.get("dropletId")},o=new c.ajax(i,{success:function(i){if(i.Success==1){var s=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:i.Message});switch(i.Code){case 12:var o=new Date,u={createdAt:o};u=JSON.stringify(u),t.localStorage.set("communityUserModeratePicture",u);break;case 13:var a=e(".avatar-eurosport");a.attr("src",n.community.getAvatar()),n.community.playPictureAnimation(a),new r.notification({element:s,duration:5e3}),t.localStorage.remove("communityUserModeratePicture");break;case 14:new r.notification({element:s,duration:5e3}),t.localStorage.remove("communityUserModeratePicture");break;default:t.localStorage.remove("communityUserModeratePicture")}}}});o.send(s)}};L.init()}),define("modules/community/user-comments",["jquery-full","base/base","objects/objects","helpers/helpers","modules/community/login"],function(e,t,n,r,i){"use strict";var s=t.elements.getWindow(),o=t.elements.getBody(),u=t.elements.getHtml(),a={},f,l,c,h,p,d,v=null,m=0,g={},y=!1,b=!1,w=!1,E=!1,S={init:function(){S.reflow(!1),e.subscribe("videoPlayerPlaylist:reflow",function(){S.reflow(!0)})},reflow:function(n){if(t.storage.community.get("isCommunityActivated")=="True"&&t.storage.community.get("isUserCommentsActivated")=="True"){n&&(y=!1,b=!1,w=!1,E=!1);if(S.areDeactivatedComments())return;if(!S.initCommonElements())return;g.streamID=f.data("netsportid")+"_"+f.data("typenu"),g.collectionMeta=f.data("collectionmeta"),g.collectionChecksum=f.data("collectionchecksum"),g.lfSiteId=f.data("lfsiteid"),g.lfNetwork=f.data("lfnetwork"),g.userToken=r.community.getLivefyreToken(),m=f.data("commentdisplaymode");var i=setInterval(function(){var t=e(".livefyre-commentcount");t.length>0&&t.first().text()!="0"&&(t.addClass("show"),clearInterval(i))},400);switch(m){case 1:S.initStoryElements(),S.initStoryEvents(),S.loadLiveFyreCountJS();break;case 2:S.initLiveEvents();break;case 3:S.initStoryElements("v2"),S.initStoryEvents("v2"),S.loadLiveFyreCountJS();break;case 4:S.initLiveEvents();break;case 5:S.initLiveEvents();break;default:S.loadLiveFyreJS()}}},initCommonElements:function(){return f=o.find(".comments-activated"),c=o.find(".comments-thread-container"),h=e("#livefyre"),p=o.find(".livefyre-count-title"),d=p.find(".livefyre-commentcount"),f.length==0||c.length==0||h.length==0?!1:!0},initStoryElements:function(t){a.outerWrap=e("#outer-wrap"),a.headerCommunityConnect=o.find(".community-connect"),a.headerCommunityConnected=e(".nav--connect-mode"),a.headerCommunityDisconnected=e(".nav--disconnect-mode"),a.headerCommunityComments=e("#nav--comments-mode"),a.headerSharing=e("#header-sharing"),a.showCommentsMobile=a.headerSharing.find(".share-button-comments.mobile"),a.showCommentsTabletDesktop=a.headerSharing.find(".share-button-comments.tablet-desktop"),a.commentsThreadContainerDesktopTablet=e("#desktop-tablet-comments"),a.commentsThreadSubcontainerDesktopTablet=a.commentsThreadContainerDesktopTablet.find(".comments-thread-subcontainer"),t=="v2"?(a.storyfull=o.find(".storyfull_bis_v8_5"),a.commentsLoader=e("#loader-comments"),a.commentsDesktopTabletOpen=e("#desktop-tablet-story-comments__header"),a.commentsDesktopTabletCloseFooter=e("#footer-arrow-box"),a.mobileTabletOpen=e("#mobile-story-comments__header"),a.livefyreLabel=e("#powered_by_livefyre_new")):(a.storyfull=o.find(".storyfull_v8_5"),a.commentsLazyLoadContainer=a.commentsThreadContainerDesktopTablet.find(".lazyload-livefyre")),a.hideCommentsMobile=a.headerSharing.find(".share-button-comments-close"),a.modalComments=e("#modal_mobile-story-comments"),a.commentsThreadSubcontainerMobile=a.modalComments.find(".comments-thread-subcontainer")},initLiveEvents:function(){e(".live_match_nav_v8_5_bis").length&&require(["modules/live/components/live.subnavigationmenu.bis"],function(t){t.isCommentsTabLoaded()?(p=o.find(".livefyre-count-title"),d=p.find(".livefyre-commentcount"),S.loadLiveFyreJS()):e.subscribe("subnavigation.tabInit:UserComments",function(){p=o.find(".livefyre-count-title"),d=p.find(".livefyre-commentcount"),S.loadLiveFyreJS()})})},initStoryEvents:function(n){var r,i=!0,s=function(e){if(e.size===r&&i)return;r=e.size,e.size=="desktop"||e.size=="tablet"?(S.closeMobileStoryCommentsModal(),a.commentsThreadSubcontainerMobile.children().not(".comments-close-container").appendTo(a.commentsThreadSubcontainerDesktopTablet),S.initStoryDesktopEvents(n)):(y&&S.openMobileStoryCommentsModal("triggerJs"),a.commentsThreadSubcontainerDesktopTablet.children().appendTo(a.commentsThreadSubcontainerMobile),S.initStoryMobileEvents())};t.responsive.registerMainSizeFn(e.debounce(250,s))},initStoryDesktopEvents:function(t){E||(t=="v2"?a.commentsDesktopTabletOpen.add(a.commentsDesktopTabletCloseFooter).off().on("click",function(){a.commentsDesktopTabletOpen.hasClass("active")?S.closeStoryDesktopComments():b?S.openStoryDesktopComments():(S.loadLiveFyreJS(),v=new n.loader,v.append(f,!1))}):S.loadLiveFyreLazyLoadJS(),a.showCommentsTabletDesktop.on("click",function(t){e("body,html").animate({scrollTop:a.commentsThreadContainerDesktopTablet.offset().top-s.height()/4},500)}),E=!0)},initStoryMobileEvents:function(){w||(a.showCommentsMobile.add(a.mobileTabletOpen).on("click",function(){S.openMobileStoryCommentsModal(),b||(S.loadLiveFyreJS(),v=new n.loader,v.append(e("#livefyre"),!1)),y=!0}),a.hideCommentsMobile.on("click",function(){S.closeMobileStoryCommentsModal(),y=!1}),w=!0)},openMobileStoryCommentsModal:function(e){if(e=="triggerJs"){var t=r.modals.get("modal_mobile-story-comments");t.open()}a.headerSharing.addClass("comments--open"),a.hideCommentsMobile.addClass("show"),a.showCommentsMobile.addClass("hide")},closeMobileStoryCommentsModal:function(){var e=r.modals.get("modal_mobile-story-comments"),t=function(){a.headerSharing.removeClass("comments--open"),a.hideCommentsMobile.removeClass("show"),a.showCommentsMobile.removeClass("hide"),e.removeOnAfterClose(t)};e.onAfterClose(t),e.close()},openStoryDesktopComments:function(){a.commentsDesktopTabletOpen.addClass("active"),a.commentsThreadSubcontainerDesktopTablet.slideDown(function(){a.commentsDesktopTabletCloseFooter.removeClass("nodisplay"),a.livefyreLabel.removeClass("nodisplay")})},closeStoryDesktopComments:function(){a.commentsThreadSubcontainerDesktopTablet.slideUp(function(){a.commentsDesktopTabletOpen.removeClass("active"),a.commentsDesktopTabletCloseFooter.addClass("nodisplay"),a.livefyreLabel.addClass("nodisplay")})},areDeactivatedComments:function(){l=o.find(".comments-desactivated");if(l.length>0){var t=e("#header-sharing").find(".comments-show");return t.length>0&&(t.addClass("desactivated"),t.find(".livefyre-commentcount").remove()),!0}return!1},updateCommentsCount:function(n){p.length>0&&(d.html(n),d.text()=="0"||d.text()=="1"?(p.find(".livefyre-comment-count-label").text(t.storage.labels.get("6732")),m==3&&e("#desktop-tablet-comments__header").find(".pre-comments-story-counter").text(t.storage.labels.get("8630"))):(p.find(".livefyre-comment-count-label").text(t.storage.labels.get("6731")),m==3&&e("#desktop-tablet-comments__header").find(".pre-comments-story-counter").text(t.storage.labels.get("8631"))))},loadLiveFyreCountJS:function(){d.length!=0&&(d.attr("data-lf-site-id",g.lfSiteId),d.attr("data-lf-article-id",g.streamID),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.setAttribute("data-lf-domain",g.lfNetwork),e.src="//cdn.livefyre.com/libs/commentcount/v1.0/commentcount.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}(),typeof LF!="undefined"?LF.CommentCount({replacer:function(e,t){e.innerHTML=t}}):S.updateCommentsCount())},loadLiveFyreLazyLoadJS:function(){r.lazyload.mustBeLazyLoaded(a.commentsLazyLoadContainer)?(S.startLiveFyreComments(),r.lazyload.setLazyLoaded(a.commentsLazyLoadContainer)):a.commentsLazyLoadContainer.on("mustBeLazyLoaded",function(e,t){S.startLiveFyreComments(),setTimeout(function(){t()},500)})},loadLiveFyreJS:function(){m!=3&&m!=1&&(v=new n.loader,v.append(e("#livefyre"),!1)),b||(e.ajax({type:"GET",url:"//cdn.livefyre.com/Livefyre.js",dataType:"script",cache:!0}).done(function(){S.startLiveFyreComments()}),b=!0)},startLiveFyreComments:function(){var t=f.data("translation-url");e.get(t).done(function(e){S.buildLiveFyreComments(e)}).fail(function(){S.buildLiveFyreComments()})},buildLiveFyreComments:function(n){var i=setInterval(function(){e(".fyre-editor-editable").length>0&&(clearInterval(i),v!=null&&v.detach(),m==3&&t.responsive.getMainSize()!="mobile"&&S.openStoryDesktopComments(),e(".fyre-editor-editable").on("click",function(){e(".fyre-editor-error").is(":visible")&&e(".fyre-editor-error").css("display","none")}))},200),s={network:g.lfNetwork};n!=null&&(s.strings=n);var o={};m==1?o={siteId:g.lfSiteId,articleId:g.streamID,el:"livefyre",checksum:g.collectionChecksum,collectionMeta:g.collectionMeta,initialNumVisible:3}:o={siteId:g.lfSiteId,articleId:g.streamID,el:"livefyre",checksum:g.collectionChecksum,collectionMeta:g.collectionMeta},Livefyre.require(["fyre.conv#3","auth"],function(e,n){new e(s,[o],function(e){e.on("commentCountUpdated",function(e){S.updateCommentsCount(e)}),r.community.onLoginSuccess(function(){g.userToken=r.community.getLivefyreToken(),n.authenticate({livefyre:g.userToken})}),r.community.onLogoutSuccess(function(){fyre.conv.logout()})}),n.delegate({login:function(e){var n=r.modals.get("modal_community"),i=function(){t.responsive.getMainSize()=="mobile"&&a.headerSharing.addClass("nodisplay"),n.removeOnAfterClose(i)};n.onAfterOpen(i),n.open();var s=function(){e(new Error("user cancelled")),t.responsive.getMainSize()=="mobile"&&a.headerSharing.removeClass("nodisplay")};n.onAfterClose(s)},viewProfile:function(e){},logout:function(e){e(null)}}),r.community.isConnected()?(g.userToken=r.community.getLivefyreToken(),n.authenticate({livefyre:g.userToken})):n.logout()})}};S.init()}),define("modules/community/contact-us",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws"],function(e,t,n,r,i){"use strict";var s=t.elements.getBody(),o=s.find("#contact-us__form"),u=new n.form,a=new r.loader,f={},l=!1,c={},h={},p=t.storage.config.get("isArvatoContactFormEnabled"),d={init:function(){if(!d.initElements())return;d.initForm(),d.initEvents()},initElements:function(){f.dropdown=o.find("#contact-us__dropdown"),f.dropdownCurrent=f.dropdown.find(".dropdown__current"),f.email=o.find(".input-email"),f.firstname=o.find(".input-firstname"),f.lastname=o.find(".input-lastname"),f.message=o.find(".input-message"),f.submit=o.find(".submit-button"),f.submitError=f.submit.parent().find(".message-error"),f.submitErrorLabel=f.submitError.find(".message");if(f.dropdown.length==0||f.email.length==0||f.message.length==0||f.submit.length==0||f.submitError.length==0||f.submitErrorLabel.length==0)return console.error("Contact Us : Missing element(s) in form",f),!1;if(p==1){f.dropdownPlayer=o.find("#contact-us__dropdown-player"),f.dropdownCurrentPlayer=f.dropdownPlayer.find(".dropdown__current");if(f.dropdownPlayer.length==0)return console.error("Contact Us Arvato : Missing element(s) in form",f),!1}return!0},initForm:function(){var e=[{key:"email",type:"text",element:f.email,checkOptions:["mandatory",["maxLength",300],"email","noIllegalChars"]},{key:"firstname",type:"text",element:f.firstname,checkOptions:["mandatory",["minLength",1]]},{key:"lastname",type:"text",element:f.lastname,checkOptions:["mandatory",["minLength",1]]},{key:"message",type:"textarea",element:f.message,checkOptions:["mandatory",["minLength",6]]},{key:"reason",type:"dropdown",element:f.dropdown,checkOptions:["mandatory"]}];t.storage.context.get("languageid")=="15"&&(e=[{key:"email",type:"text",element:f.email,checkOptions:["mandatory",["maxLength",300],"email","noIllegalChars"]},{key:"message",type:"textarea",element:f.message,checkOptions:["mandatory",["minLength",6]]},{key:"reason",type:"dropdown",element:f.dropdown,checkOptions:["mandatory"]}]),u.add(e)},initEvents:function(){f.dropdown.on("change",function(t,n){c=e(this).find("li.selected");if(c.data("highlight-id")!=0){f.dropdownCurrent.hasClass("selected")||f.dropdownCurrent.addClass("selected"),l=!0;var r=c.data("highlight-id");p==1&&(r==2?(f.dropdownPlayer.find(".dropdown__current").css({color:"#3D4248"}),f.dropdownPlayer.parent().removeClass("nodisplay")):f.dropdownPlayer.parent().addClass("nodisplay"))}else l=!1}),p==1&&f.dropdownPlayer.on("change",function(t,n){h=e(this).find("li.selected"),f.dropdownCurrentPlayer.hasClass("selected")||f.dropdownCurrentPlayer.addClass("selected")}),f.submit.on("click",function(e){e.preventDefault(),e.stopPropagation(),d.contactUsProcess()})},contactUsProcess:function(){u.hideSubmitError(f.submit);if(!u.isValidForSend()||!l)return!1;var n=u.getValues();n.reasonId=c.data("highlight-id"),p==1&&n.reasonId==2&&(n.reasonPlayerId=h.data("highlight-id"));var r={reasonId:n.reasonId,reasonPlayerId:n.reasonPlayerId||-1,email:n.email,lastname:n.lastname||"",firstname:n.firstname||"",message:n.message,dropletId:t.storage.context.get("dropletId"),geoloc:e("#script-critical").data("geoloc")};a.append(f.submit.parent(),!0),d.contactUsRequest(r)},contactUsRequest:function(e){var n=i.community.get("SendContactFormEmail");p==1?n=i.community.get("SendContactForm"):o.data("is-eptica")=="True"&&o.data("is-tv-site")=="False"?n=i.community.get("SendContactFormEptica"):o.data("is-tv-site")=="True"&&(n=i.community.get("SendContactFormTVEmail"));var r=new i.ajax(n,{success:function(e){var n=e.Message;a.detach(!1),e.Success==1?(t.localStorage.set("action","contactUs"),window.location.href="/"):u.showSubmitError(f.submit,n)},error:function(){a.detach(!1),u.showSubmitError(f.submit,t.storage.labels.get("3414"))}});r.send(e)}};d.init()}),define("modules/community/apps-mobile",["jquery-full","base/base"],function(e,t){"use strict";var n={activateAccountSuccess:function(){e(".activate-account-module").show(),e("#ws-mobile-load").slideUp("slow",function(){e("#ws-mobile-success").fadeIn("slow",function(){n.redirectToApp()})})},resetPasswordRequest:function(){e("#reset-password__form").slideUp("slow",function(){e("#reset-password-mobile-module").fadeIn()})},resetPasswordSuccess:function(){setTimeout(function(){e("#ws-mobile-load").slideUp("slow",function(){e("#ws-mobile-success").fadeIn("slow",function(){n.redirectToApp()})})},2e3)},redirectToApp:function(){if(t.storage.context.get("deviceType")=="iphone"||t.storage.context.get("deviceType")=="ipad")setTimeout(function(){window.location.href="eurosport://login"},5e3);else if(t.storage.context.get("deviceType")=="android"){var e=window.location.hostname;switch(t.storage.context.get("countryCode")){case"FR":e="http://www.eurosport.fr/login.shtml";break;case"RU":e="http://www.eurosport.ru/login.shtml";break;case"SE":e="http://www.eurosport.se/login.shtml";break;case"TR":e="http://tr.eurosport.com/login.shtml";break;case"GB":e="http://m.eurosport.co.uk/login.shtml";break;case"IT":e="http://m.eurosport-it.com/login.shtml";break;case"ES":e="http://m.eurosport.es/login.shtml";break;case"PL":e="http://m.eurosport.pl/login.shtml";break;case"US":e="http://m.eurosport.com/login.shtml"}setTimeout(function(){window.location.href="/"},5e3)}else{var e=window.location.hostname;switch(t.storage.context.get("countryCode")){case"FR":e="http://eurosport.fr";break;case"RU":e="http://eurosport.ru";break;case"SE":e="http://eurosport.se";break;case"TR":e="http://tr.eurosport.com";break;case"GB":e="http://eurosport.co.uk";break;case"DE":e="http://eurosport.de";break;case"IT":e="http://it.eurosport.com";break;case"ES":t.storage.context.get("partnerCode")=="ese"?e="http://eurosport.es":e="http://espanol.eurosport.com";break;case"US":e="http://eurosport.com"}setTimeout(function(){window.location.href="/"},5e3)}}},r={activateAccountSuccess:function(){n.activateAccountSuccess()},resetPasswordRequest:function(){n.resetPasswordRequest()},resetPasswordSuccess:function(){n.resetPasswordSuccess()}};return r}),define("modules/community/reset-password",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws"],function(e,t,n,r,i){"use strict";var s=t.elements.getBody(),o=s.find("#reset-password-container"),u=s.find("#reset-password__form"),a=new n.form,f=new r.loader,l={},c={init:function(){if(o.data("expired")=="True"){setTimeout(function(){t.localStorage.set("action","expiredLink"),window.location.href="/"},1e3);return}if(!c.initElements())return;c.initForm(),c.initEvents()},initElements:function(){return l.password=u.find(".input-password"),l.submit=u.find(".submit-button"),l.submitError=l.submit.parent().find(".message-error"),l.submitErrorLabel=l.submitError.find(".message"),l.password.length==0||l.submit.length==0||l.submitError.length==0||l.submitErrorLabel.length==0?(console.error("Reset Password : Missing element(s) in form",l),!1):!0},initForm:function(){var e=[{key:"password",type:"password",element:l.password,checkOptions:["mandatory",["minLength",8],["maxLength",20],"noIllegalChars"]}];a.add(e)},initEvents:function(){l.submit.on("click",function(e){e.preventDefault(),e.stopPropagation(),c.resetPasswordProcess()})},resetPasswordProcess:function(){a.hideSubmitError(l.submit);if(!a.isValidForSend())return!1;var n=a.getValues(),r=e.parseParams(window.location.search);if(!!r.activationhash){var i={activationHash:r.activationhash,password:n.password,dropletId:t.storage.context.get("dropletId")};f.append(l.submit.parent(),!0),u.data("mobile")=="True"?require(["modules/community/apps-mobile"],function(e){e.resetPasswordRequest(),c.resetPasswordRequest(i,e)}):c.resetPasswordRequest(i)}},resetPasswordRequest:function(e,n){var r=i.community.get("UpdatePassword"),s=new i.ajax(r,{success:function(e){var r=e.Message;f.detach(!1),e.Success==1?u.data("mobile")=="True"?n.resetPasswordSuccess():(t.localStorage.set("action","resetPassword"),window.location.href="/"):a.showSubmitError(l.submit,r)},error:function(){f.detach(!1),a.showSubmitError(l.submit,t.storage.labels.get("3414"))}});s.send(e)}};c.init()}),define("modules/community/unsubscription-service",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws"],function(e,t,n,r,i){"use strict";var s=t.elements.getBody(),o=s.find(".unsubscribe-reason-container"),u=new n.form,a=new r.loader,f={},l,c="",h=!1,p={init:function(){if(!p.initElements())return;p.initForm(),p.initEvents()},initElements:function(){return f.radios=o.find(".unsubscription-container__item"),f.message=o.find(".input-message"),f.submit=o.find(".submit-button"),f.submitError=f.submit.parent().find(".message-error"),f.submitErrorLabel=f.submitError.find(".message"),f.radios.length==0||f.submit.length==0?(console.error("Unsubscribe newsletter : Missing element(s) in form",f),!1):!0},initForm:function(){var e=[];u.add(e)},initEvents:function(){f.radios.on("click",function(){f.radios.removeClass("select"),e(this).addClass("select"),o.addClass("active"),f.submit.addClass("active"),l=e(this).data("value"),l!=6&&f.message.val(""),h=!0}),f.submit.on("click",function(e){e.preventDefault(),e.stopPropagation(),p.updateUnsubscribeServiceReasonProcess()})},updateUnsubscribeServiceReasonProcess:function(){u.hideSubmitError(f.submit);if(!u.isValidForSend()||!h)return!1;c=f.message.val();var e={reasonId:l,otherReason:c,dropletId:t.storage.context.get("dropletId"),siteId:t.storage.context.get("siteid")};a.append(f.submit.parent(),!0),p.updateUnsubscribeServiceReasonRequest(e)},updateUnsubscribeServiceReasonRequest:function(e){var n=i.community.get("UpdateUnsubscribeNewsletterReason"),r=new i.ajax(n,{complete:function(){a.detach(!1),t.localStorage.set("action","unsubscribeReason"),window.location.href="/"}});r.send(e)}};p.init()}),define("modules/community/personalization-feed",["jquery-full","base/base","helpers/helpers","objects/objects","ws/ws","modules/community/login"],function(e,t,n,r,i,s){"use strict";var o={},u={},a=!1,f=new r.loader,l=null,c=!1;o.$firstElem=null;var h=6e4,p={init:function(){var e=n.navTabs,t=e.getElements("navtab_storylist_latest_personal")[0],r=e.getElements("navtab_storylist_latest_news")[0];!t||t.onActivate(function(){a||(p.initElements(),p.initUserEvents(),n.community.isConnected()?(p.reflowModalProfileEvent(),p.refreshData()):(o.$blocs.removeClass("show"),o.$blocNotConnected.addClass("show")),a=!0)}),!r||r.onActivate(function(){l!=null&&clearInterval(l),c=!1})},initElements:function(){o.$blocs=e(".latest-personal-bloc"),o.$blocListFeeds=e("#latest-personal-list"),o.$blocNotConnected=e("#latest-personal-not-connected"),o.$blocNoFavorites=e("#latest-personal-no-favorites"),o.$blocNoFeedFavorites=e("#latest-personal-no-feed-favorites")},initUserEvents:function(){n.community.onLoginSuccess(function(){p.reflowModalProfileEvent()}),n.community.onLogoutSuccess(function(){p.setBlocNotConnected()}),n.bookmarks.onGetSuccess(function(){c=!1,p.refreshFeed()}),n.adria.onAdriaSuccess(function(t){var n={};e.each(t.Names,function(t,r){e.each(r.v,function(e,t){n[r.k+"_"+t._]={name:t.n,img:t.s}})}),u=n,p.itaipuRequest()})},reflowModalProfileEvent:function(){c=!1,p.refreshFeed();var e=n.modals.get("modal_myprofile");e&&e.onAfterClose(function(){c=!1,p.refreshFeed()})},refreshFeed:function(){n.community.isConnected()?n.bookmarks.countItemsLocalStorage()>0?(o.$blocs.removeClass("show"),o.$blocListFeeds.addClass("show"),p.adriaRequest()):(o.$blocs.removeClass("show"),o.$blocNoFavorites.addClass("show")):p.setBlocNotConnected()},refreshData:function(){l=setInterval(function(){c=!0,p.refreshFeed()},h)},setBlocNotConnected:function(){o.$blocs.removeClass("show"),o.$blocNotConnected.addClass("show")},adriaRequest:function(){var t=p.parseEntity(),r="";f.append(o.$blocListFeeds,!0),e.each(t,function(e,t){r+=e+"="+t+"&"}),n.adria.adriaNamesRequest(r)},parseAdria:function(e){return!e||typeof e!="string"?null:(e[0]!="{"&&(e=p.grdec(e)),JSON.parse(e))},grdec:function(e){var t="";for(var n=0;n<e.length;n++)t+=String.fromCharCode(p.gruntaunt(e.charCodeAt(n)));return t},gruntaunt:function(e){var t,n,r;t=1,n=e;for(;;){r=n>>t,n^=r;if(r<=1||t==8)return n;t<<=1}},itaipuRequest:function(){var r=t.storage.links.get("wsItaipu");if(r==null||r=="")r="http://itaipu.eurosport.com/ItaipuWebService.svc";var i=r+"/FindStoriesByEntity",s=this.parseEntity(),u="";e.each(s,function(e,t){u+=e+":"+t+";"}),e.ajax({url:i,data:{language:t.storage.context.get("languageid"),entities:u}}).done(function(t){f.detach(!1),t!=null&&t.length>0?(t=t.reverse(),c||o.$blocListFeeds.empty(),e.each(t,function(e,t){t!=null&&p.templateHtml(t)}),p.checkNewItemDisplay(),n.unique.reflow(o.$blocListFeeds),n.lazyload.reflowIn(o.$blocListFeeds),o.$firstElem=o.$blocListFeeds.find(".storylist-container-feed").first()):(o.$blocs.removeClass("show"),o.$blocNoFeedFavorites.addClass("show"))})},checkNewItemDisplay:function(){if(c){var t=o.$blocListFeeds.find(".storylist-container-feed--onrefresh");t.length>0&&(e(t.get().reverse()).each(function(t,n){e(this).removeClass("storylist-container-feed--onrefresh").show()}),p.addNotifNewItems(t.length))}},addNotifNewItems:function(e){n.notifLatest.init(e,t.storage.labels.get("8358"),o.$firstElem)},getEntity:function(t){var n=null;return e.each(t,function(e,t){!u[t.Type+"_"+t.Id]||(n=t.Type+"_"+t.Id)}),n},parseEntity:function(){var t=n.bookmarks.getLocalStorage(),r={};return e.each(t,function(e,t){var n=t.entity,i=t.typenu;r[i]?r[i]=r[i]+","+n:r[i]=n}),r},getDate:function(e){var n=(new Date).getTime(),r=e.substring(e.lastIndexOf("(")+1,e.lastIndexOf("+")),i=n-r,s="";if(i<6e4)s=t.storage.labels.get("5000");else if(i<36e5)s=t.storage.labels.get("8379").replace("{0}",parseInt(i/6e4));else if(i<864e5)s=t.storage.labels.get("8377").replace("{0}",parseInt(i/36e5));else if(i<1728e5){var e=new Date(parseInt(r));s=t.storage.labels.get("5005").replace("{0}",("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2))}else{var e=new Date(parseInt(r));s=t.storage.labels.get("8378").replace("{0}",("0"+e.getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)).replace("{1}",("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2))}return s},templateHtml:function(t){var r=t.Id,i=t.CreationDate,s=t.Entities,a=t.Name,f=t.Image,l=t.Link,h=t.PvdId,d=t.PvdName;if(!!a){s==null&&(s="");var v=this.getEntity(s),m=e("<div>",{"class":"storylist-container-feed","data-unique":"latest-personnal-"+r}),g=e("<div>",{"class":"storylist-feed"}),y=e("<div>",{"class":"storylist-feed__content"}),b=e("<h2>",{"class":"storylist-feed__main-title"}),w=e("<a>",{target:"_blank",href:l}),E=e("<p>",{html:a});if(f){y.addClass("storylist-feed__content--picture");var S=e("<div>",{"class":"storylist-feed__picture"}),x=e("<div>",{"class":"lazyload format-16-9 wrapper-interchange","data-lazy-type":"img","data-lazy":f}).append(e("<img>"));S.append(x)}var T=e("<div>",{"class":"storylist-feed__infos"}),N=e("<div>",{"class":"storylist-feed__time-infos",html:p.getDate(i)}),C=e("<div>",{"class":"storylist-feed__category-title"}),k=e("<span>",{"class":"storylist-feed__sport",html:d});if(!!v&&!!u[v].name)var L=e("<div>",{"class":"storylist-feed__category-title"}),A=e("<span>",{"class":"storylist-feed__sport",html:u[v].name});w.append(E),b.append(w),T.append(N),C.append(k),!!v&&!!u[v].name&&L.append(A),T.append(L).append(C),y.append(b),y.append(S),y.append(T),g.append(y),m.append(g),c?n.unique.exists(m)?o.$blocListFeeds.find(".storylist-container-feed[data-unique='latest-personnal-"+r+"'] .storylist-feed__time-infos").html(p.getDate(i)):(m.addClass("storylist-container-feed--onrefresh").hide(),o.$blocListFeeds.prepend(m)):o.$blocListFeeds.prepend(m)}}};p.init()}),define("modules/community/lebuzz/login",["jquery-full","helpers/helpers"],function(e,t){"use strict";var n={init:function(){if(t.community.isConnected())e.getUrlVar("urlReferrer")==null?window.location.href="/":window.location.href=e.getUrlVar("urlReferrer");else{var n=t.modals.get("modal_community");e("#modal_community").find(".modal__close").remove(),n.open()}}};n.init()}),define("modules/community/activate-account-app",["jquery-full","base/base","objects/objects","ws/ws"],function(e,t,n,r){"use strict";var i={init:function(){var n=e.parseParams(window.location.search);if(!!n.activationhash){var r={socialType:"None",activationHash:n.activationhash,dropletId:t.storage.context.get("dropletId")};i.activateAccountRequest(r)}},activateAccountRequest:function(i){var s=r.community.get("ActivateAccount"),o=new r.ajax(s,{success:function(e){e.Success==1&&require(["modules/community/apps-mobile"],function(e){e.activateAccountSuccess()})},error:function(){var r=e("<div>",{"class":"notification__label","data-sln":"notification__label",html:t.storage.labels.get("3414")});new n.notification({element:r,duration:5e3})}});o.send(i)}};i.init()}),define("community",function(){});